import{f as M,a5 as K,a6 as w,e as I,J as S,K as u,M as o,n as c,S as Y,Q as O,a7 as ke,u as e,v as j,W as _,V as F,a2 as Fe,Z as h,F as q,$ as xe,X as U}from"./vue-RBz4_81T.js";import{v as Ve}from"./index-BU4ROwdU.js";import{o as G,at as ee,au as B,H as N,av as te,a as Q,K as le,aw as $e,ax as L,I as ae,ay as g,p as Ue,C as Le,ag as Oe,az as _e,aA as he,ah as a,aB as A,Q as Ae}from"./index-DaFpj2m-.js";import"./vuetify-CqJhlpxZ.js";function R(d,i){let s=0;for(;s<d.length;)d[s]===i?d.splice(s,1):++s;return d}const Re={key:0,class:"text-accent"},Ke={key:1,class:"text-accent"},z=M({__name:"FilterSelectMulti",props:K({title:{},items:{},filterType:{}},{include:{required:!0},includeModifiers:{},exclude:{required:!0},excludeModifiers:{}}),emits:K(["disable","toggleFilterType"],["update:include","update:exclude"]),setup(d){const i=d,s=w(d,"include"),C=w(d,"exclude"),{t:p}=G(),D=I(()=>s.value.length+C.value.length),m=ee(()=>i.items,(l,b)=>B.text.asc(l.title,b.title));function v(l){return s.value.includes(l)?g.INCLUDED:C.value.includes(l)?g.EXCLUDED:g.DISABLED}function x(l){switch(v(l)){case g.INCLUDED:return"mdi-plus-box";case g.EXCLUDED:return"mdi-minus-box";case g.DISABLED:default:return"mdi-checkbox-blank-outline"}}function y(l){switch(v(l)){case g.INCLUDED:return"text-green";case g.EXCLUDED:return"text-red";default:return}}function V(l){switch(v(l)){case g.INCLUDED:R(s.value,l),C.value.push(l);break;case g.EXCLUDED:R(C.value,l);break;case g.DISABLED:default:s.value.push(l)}}function k(l){R(s.value,l),R(C.value,l)}return(l,b)=>(u(),S(N,{class:"px-0 pb-3"},{default:o(()=>[c(te,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:o(()=>[Y(O(l.title),1)]),_:1}),c(ae,{"model-value":[...s.value,...C.value],items:e(m),placeholder:e(p)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{prepend:o(()=>[c($e,{location:"right",text:e(p)(l.filterType===e(L).CONJUNCTIVE?"constants.filter_type.conjunctive":"constants.filter_type.disjunctive")},{activator:o(({props:n})=>[c(Q,j(n,{icon:l.filterType===e(L).CONJUNCTIVE?"mdi-set-center":"mdi-set-all",onClick:b[0]||(b[0]=T=>l.$emit("toggleFilterType"))}),null,16,["icon"])]),_:1},8,["text"])]),"prepend-item":o(()=>[c(N,{title:e(p)("common.disable"),onClick:b[1]||(b[1]=n=>l.$emit("disable"))},null,8,["title"]),c(le)]),selection:o(({item:n,index:T})=>[T===0&&D.value===1?(u(),_("span",Re,O(n.title),1)):T===0?(u(),_("span",Ke,O(e(p)("navbar.side.filters.activeFilter",D.value)),1)):F("",!0)]),item:o(({item:n,props:T})=>[ke((u(),S(N,j(T,{"data-custom-context-menu":"",class:y(n.value),onClick:$=>V(n.value),onContextmenu:$=>k(n.value)}),{prepend:o(()=>[c(Q,{icon:x(n.value)},null,8,["icon"])]),_:2},1040,["class","onClick","onContextmenu"])),[[e(Ve),()=>k(n.value)]])]),_:1},8,["model-value","items","placeholder"])]),_:1}))}}),we={key:0,class:"text-accent"},Me={key:1,class:"text-accent"},Z=M({__name:"FilterSelectSingle",props:K({title:{},items:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:K(["disable"],["update:modelValue"]),setup(d){const i=d,s=w(d,"modelValue"),C=ee(()=>i.items,(D,m)=>B.text.asc(D.title,m.title)),{t:p}=G();return(D,m)=>(u(),S(N,{class:"px-0 pb-3"},{default:o(()=>[c(te,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:o(()=>[Y(O(D.title),1)]),_:1}),c(ae,{modelValue:s.value,"onUpdate:modelValue":m[1]||(m[1]=v=>s.value=v),items:e(C),placeholder:e(p)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{"prepend-item":o(()=>[c(N,{title:e(p)("common.disable"),onClick:m[0]||(m[0]=v=>D.$emit("disable"))},null,8,["title"]),Fe(D.$slots,"prepend-item"),c(le)]),selection:o(({item:v,index:x})=>[x===0&&s.value.length===1?(u(),_("span",we,O(v.title),1)):x===0?(u(),_("span",Me,O(e(p)("navbar.side.filters.activeFilter",s.value.length)),1)):F("",!0)]),_:3},8,["modelValue","items","placeholder"])]),_:3}))}}),Pe=M({__name:"Filters",setup(d){const{t:i,getTorrentStateString:s}=G(),{categories:C,torrentsByCategory:p}=h(Ue()),{tags:D,torrentsByTag:m}=h(Le()),{torrents:v,torrentsByStatus:x,statusFilter:y,categoryFilter:V,tagFilterInclude:k,tagFilterExclude:l,tagFilterType:b,torrentsByTracker:n,trackerFilterInclude:T,trackerFilterExclude:$,trackerFilterType:W}=h(Oe()),{hostnameTrackers:se}=h(_e()),{filters:ie,showFilterState:ne,showFilterCategory:re,showFilterTag:oe,showFilterTracker:ue}=h(he()),ce=I(()=>Object.values(a).filter(t=>typeof t=="number").map(t=>({title:`${s(t)} (${x.value[t]??0})`,value:t})).sort((t,r)=>B.text.asc(t.title,r.title))),de=I(()=>[{title:`${i("navbar.side.filters.category.empty")} (${p.value[""]??0})`,value:""},...C.value.map(t=>({title:`${t.name} (${p.value[t.name]??0})`,value:t.name}))]),ve=I(()=>[{title:`${i("navbar.side.filters.tag.empty")} (${m.value[""]??0})`,value:null},...D.value.map(t=>({title:`${t} (${m.value[t]??0})`,value:t}))]),pe=I(()=>[{title:`${i("navbar.side.filters.tracker.empty")} (${n.value[A.UNTRACKED]??0})`,value:A.UNTRACKED},{title:`${i("navbar.side.filters.tracker.not_working")} (${n.value[A.NOT_WORKING]??0})`,value:A.NOT_WORKING},...se.value.map(t=>({title:`${t} (${n.value[t]??0})`,value:t}))]);function J(t){switch(t.value){case L.CONJUNCTIVE:t.value=L.DISJUNCTIVE;break;case L.DISJUNCTIVE:t.value=L.CONJUNCTIVE;break}}function me(){J(b)}function fe(){J(W)}const P=[a.UPLOADING,a.CHECKING_DISK,a.UL_FORCED,a.DOWNLOADING,a.META_DOWNLOAD,a.FORCED_META_DOWNLOAD,a.CHECKING_DISK,a.DL_FORCED,a.CHECKING_RESUME_DATA,a.MOVING],H=[a.ERROR,a.MISSING_FILES,a.UNKNOWN],X=[a.ERROR,a.MISSING_FILES,a.UNKNOWN,a.MOVING,a.DL_STOPPED,a.DL_STALLED,a.UL_STOPPED,a.CHECKING_DISK,a.CHECKING_RESUME_DATA];function ge(){y.value=[]}const Ce=I(()=>v.value.filter(t=>P.includes(t.state)).length);function De(){y.value=P}const Te=I(()=>v.value.filter(t=>H.includes(t.state)).length);function ye(){y.value=H}const be=I(()=>v.value.filter(t=>X.includes(t.state)).length);function Ee(){y.value=X}function Ie(){V.value=[]}function Se(){k.value=[],l.value=[]}function Ne(){T.value=[],$.value=[]}return(t,r)=>e(ne)||e(re)||e(oe)||e(ue)?(u(),S(Ae,{key:0,class:"pb-0 inherit-fg"},{default:o(()=>[(u(!0),_(q,null,xe(e(ie),E=>(u(),_(q,{key:E.name},[E.name==="state"&&E.active?(u(),S(Z,{key:0,modelValue:e(y),"onUpdate:modelValue":r[0]||(r[0]=f=>U(y)?y.value=f:null),title:e(i)("navbar.side.filters.state.title"),items:ce.value,onDisable:ge},{"prepend-item":o(()=>[c(N,{title:`${e(i)("navbar.side.filters.state.active")} (${Ce.value})`,onClick:De},null,8,["title"]),c(N,{title:`${e(i)("navbar.side.filters.state.error")} (${Te.value})`,onClick:ye},null,8,["title"]),c(N,{title:`${e(i)("navbar.side.filters.state.offline")} (${be.value})`,onClick:Ee},null,8,["title"])]),_:1},8,["modelValue","title","items"])):F("",!0),E.name==="category"&&E.active?(u(),S(Z,{key:1,modelValue:e(V),"onUpdate:modelValue":r[1]||(r[1]=f=>U(V)?V.value=f:null),title:e(i)("navbar.side.filters.category.title"),items:de.value,onDisable:Ie},null,8,["modelValue","title","items"])):F("",!0),E.name==="tag"&&E.active?(u(),S(z,{key:2,include:e(k),"onUpdate:include":r[2]||(r[2]=f=>U(k)?k.value=f:null),exclude:e(l),"onUpdate:exclude":r[3]||(r[3]=f=>U(l)?l.value=f:null),title:e(i)("navbar.side.filters.tag.title"),items:ve.value,"filter-type":e(b),onDisable:Se,onToggleFilterType:me},null,8,["include","exclude","title","items","filter-type"])):F("",!0),E.name==="tracker"&&E.active?(u(),S(z,{key:3,include:e(T),"onUpdate:include":r[4]||(r[4]=f=>U(T)?T.value=f:null),exclude:e($),"onUpdate:exclude":r[5]||(r[5]=f=>U($)?$.value=f:null),title:e(i)("navbar.side.filters.tracker.title"),items:pe.value,"filter-type":e(W),onDisable:Ne,onToggleFilterType:fe},null,8,["include","exclude","title","items","filter-type"])):F("",!0)],64))),128))]),_:1})):F("",!0)}});export{Pe as default};
