import{p as Qe}from"./purify.es-DxJI3Wx7.js";import{n as e,v as T,b as M,t as ke,D as We,y as D,N as he,q as Z,F as P,f as E,a8 as Ye,u as R,J as h,K as d,M as l,W as U,V as N,S,Q as A,U as z,a0 as Te,e as I,X as ae,$ as ee,Y as Ne,r as fe,R as ve,T as Re,H as Ee,_ as pe,a7 as Fe}from"./vue-CiaUw_D1.js";import{B as Y,bp as Je,bm as Xe,bq as Ze,br as Ae,bs as Ce,f as et,bt as tt,bu as lt,W as at,bv as nt,a as me,bn as st,bw as Le,bx as q,H as G,b3 as ge,aE as ot,by as it,z as K,A as F,Y as rt,e as ut,bz as dt,Q as Ve,K as Q,aM as mt,aL as O,bA as ct,o as te,q as Me,r as W,s as ne,v as se,V as x,y as ye,Z as oe,bB as ft,ap as le,G as J,F as B,al as be,am as Pe,bC as vt,bD as pt,a_ as we,aN as gt}from"./index-w496w-49.js";import{v as Vt}from"./index-D6FG-dQu.js";import{V as De}from"./VPagination-BvsalVd7.js";import{V as Ie}from"./VForm-Dl6kjeEy.js";import{V as Oe}from"./VEmptyState-DVDIqys7.js";import{g as Be,p as _e,h as ce,a as xe,r as yt,N as bt,d as $t}from"./vuetify-CGpQcnle.js";import{V as kt}from"./VSheet-CLJn2d0r.js";var L=(t=>(t[t.LOADING=0]="LOADING",t[t.ERROR=1]="ERROR",t[t.UNREAD=2]="UNREAD",t[t.READ=3]="READ",t))(L||{});const ht=_e({inset:Boolean,...Je({transition:"bottom-sheet-transition"})},"VBottomSheet"),Rt=Be()({name:"VBottomSheet",props:ht(),emits:{"update:modelValue":t=>!0},setup(t,p){let{slots:f}=p;const n=ce(t,"modelValue");return xe(()=>{const a=Y.filterProps(t);return e(Y,T(a,{contentClass:["v-bottom-sheet__content",t.contentClass],modelValue:n.value,"onUpdate:modelValue":m=>n.value=m,class:["v-bottom-sheet",{"v-bottom-sheet--inset":t.inset},t.class],style:t.style}),f)}),{}}}),Ft=_e({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...lt(),...tt()},"VSwitch"),At=Be()({name:"VSwitch",inheritAttrs:!1,props:Ft(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,p){let{attrs:f,slots:n}=p;const a=ce(t,"indeterminate"),m=ce(t,"modelValue"),{loaderClasses:r}=Xe(t),{isFocused:c,focus:y,blur:u}=Ze(t),C=M(),k=M(),i=yt&&window.matchMedia("(forced-colors: active)").matches,s=ke(()=>typeof t.loading=="string"&&t.loading!==""?t.loading:t.color),o=We(),v=ke(()=>t.id||`switch-${o}`);function g(){a.value&&(a.value=!1)}function w(j){j.stopPropagation(),j.preventDefault(),C.value?.input?.click()}return xe(()=>{const[j,b]=bt(f),$=Ae.filterProps(t),V=Ce.filterProps(t);return e(Ae,T({ref:k,class:["v-switch",{"v-switch--flat":t.flat},{"v-switch--inset":t.inset},{"v-switch--indeterminate":a.value},r.value,t.class]},j,$,{modelValue:m.value,"onUpdate:modelValue":_=>m.value=_,id:v.value,focused:c.value,style:t.style}),{...n,default:_=>{let{id:ie,messagesId:qe,isDisabled:je,isReadonly:He,isValid:$e}=_;const re={model:m,isValid:$e};return e(Ce,T({ref:C},V,{modelValue:m.value,"onUpdate:modelValue":[X=>m.value=X,g],id:ie.value,"aria-describedby":qe.value,type:"checkbox","aria-checked":a.value?"mixed":void 0,disabled:je.value,readonly:He.value,onFocus:y,onBlur:u},b),{...n,default:X=>{let{backgroundColorClasses:ue,backgroundColorStyles:H}=X;return D("div",{class:Z(["v-switch__track",i?void 0:ue.value]),style:he(H.value),onClick:w},[n["track-true"]&&D("div",{key:"prepend",class:"v-switch__track-true"},[n["track-true"](re)]),n["track-false"]&&D("div",{key:"append",class:"v-switch__track-false"},[n["track-false"](re)])])},input:X=>{let{inputNode:ue,icon:H,backgroundColorClasses:Ge,backgroundColorStyles:Ke}=X;return D(P,null,[ue,D("div",{class:Z(["v-switch__thumb",{"v-switch__thumb--filled":H||t.loading},t.inset||i?void 0:Ge.value]),style:he(t.inset?void 0:Ke.value)},[n.thumb?e(at,{defaults:{VIcon:{icon:H,size:"x-small"}}},{default:()=>[n.thumb({...re,icon:H})]}):e(nt,null,{default:()=>[t.loading?e(st,{name:"v-switch",active:!0,color:$e.value===!1?void 0:s.value},{default:de=>n.loader?n.loader(de):e(Le,{active:de.isActive,color:de.color,indeterminate:!0,size:"16",width:"2"},null)}):H&&e(me,{key:String(H),icon:H,size:"x-small"},null)]})])])}})}})}),et({},k)}}),Ct={class:"d-flex"},wt={key:0},Dt={key:0},St={key:1},Ut={class:"d-flex flex-column"},Tt=E({__name:"Article",props:{value:{}},emits:["click","markAsRead","open","download"],setup(t){const p=q();return(f,n)=>Ye((d(),h(G,{"data-custom-context-menu":"",class:Z({"rss-read":t.value.isRead}),onClick:n[3]||(n[3]=a=>f.$emit("click")),onContextmenu:n[4]||(n[4]=a=>f.$emit("markAsRead"))},{default:l(()=>[D("div",Ct,[D("div",null,[e(ge,{class:"d-flex align-center ga-3 wrap-anywhere",style:{"white-space":"unset"}},{default:l(()=>[t.value.isRead?N("",!0):(d(),U("div",wt,[e(ot,{color:"accent",variant:"outlined"},{default:l(()=>[S(A(f.$t("rssArticles.feeds.item.new")),1)]),_:1})])),D("div",null,A(t.value.title),1)]),_:1}),e(it,{class:"d-block mt-3"},{default:l(()=>[D("div",null,A(t.value.parsedDate.toLocaleString()),1),D("div",null,A(f.$t("rssArticles.feeds.item.feedName",{name:R(p).getFeedNames(t.value.id).join(" | ")})),1),t.value.author?(d(),U("div",Dt,A(f.$t("rssArticles.feeds.item.author",{author:t.value.author})),1)):N("",!0),t.value.category?(d(),U("div",St,A(f.$t("rssArticles.feeds.item.category",{category:t.value.category})),1)):N("",!0)]),_:1})]),e(K),D("div",Ut,[e(F,{icon:"mdi-open-in-new",variant:"text",onClick:n[0]||(n[0]=z(a=>f.$emit("open"),["stop"]))}),e(F,{color:"accent",icon:"mdi-check",variant:"text",onClick:n[1]||(n[1]=z(a=>f.$emit("markAsRead"),["stop"]))}),e(F,{icon:"mdi-download",variant:"text",onClick:n[2]||(n[2]=z(a=>f.$emit("download"),["stop"]))})])])]),_:1},8,["class"])),[[R(Vt),()=>f.$emit("markAsRead")]])}}),Se=E({__name:"ArticleList",props:{height:{}},emits:["articleClicked"],setup(t){const p=Te(),f=rt(),n=q(),a=ut(),m=I(()=>p.params.feedId),r=I(()=>n.filteredArticles.filter(s=>!m.value||m.value===s.feedId).sort((s,o)=>Number(o.parsedDate)-Number(s.parsedDate))),{paginatedResults:c,currentPage:y,pageCount:u}=dt(r,15);function C(s){const o=a.useIdForRssLinks?s.id:s.link;mt(o)}function k(s){f.pushTorrentToQueue(s.torrentURL)}async function i(s){await n.markArticleAsRead(s.id)}return(s,o)=>(d(),h(Ve,{height:t.height},{default:l(()=>[r.value.length?(d(),h(G,{key:0},{default:l(()=>[e(De,{modelValue:R(y),"onUpdate:modelValue":o[0]||(o[0]=v=>ae(y)?y.value=v:null),length:R(u),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])]),_:1})):N("",!0),(d(!0),U(P,null,ee(R(c),(v,g)=>(d(),U(P,{key:g},[g>0?(d(),h(Q,{key:0})):N("",!0),e(Tt,{value:v,onClick:w=>s.$emit("articleClicked",v),onMarkAsRead:w=>i(v),onOpen:w=>C(v),onDownload:w=>k(v)},null,8,["value","onClick","onMarkAsRead","onOpen","onDownload"])],64))),128)),r.value.length===0?(d(),h(G,{key:1},{default:l(()=>[S(A(s.$t("common.emptyList")),1)]),_:1})):N("",!0),r.value.length?(d(),h(G,{key:2},{default:l(()=>[e(De,{modelValue:R(y),"onUpdate:modelValue":o[1]||(o[1]=v=>ae(y)?y.value=v:null),length:R(u),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])]),_:1})):N("",!0)]),_:1},8,["height"]))}}),Nt={class:"mr-2"},ze=E({__name:"FeedIcon",props:{state:{}},setup(t){return(p,f)=>(d(),U("span",Nt,[t.state===R(L).LOADING?(d(),h(Le,{key:0,size:"24",width:"3",indeterminate:""})):t.state===R(L).ERROR?(d(),h(me,{key:1,icon:"mdi-alert-circle-outline",color:"error"})):t.state===R(L).UNREAD?(d(),h(me,{key:2,icon:"mdi-email"})):N("",!0)]))}}),Et={class:"d-flex align-center"},Lt=E({__name:"Feed",props:{title:{},state:{},unreadCount:{}},emits:["readFeed","refreshFeed","editFeed","deleteFeed"],setup(t){const p=t,f=I(()=>p.state===L.LOADING);return(n,a)=>(d(),U("div",Et,[e(ze,{state:t.state},null,8,["state"]),e(ge,null,{default:l(()=>[S(A(t.title),1)]),_:1}),e(K),e(O,{text:n.$t("rssArticles.feeds.markAsRead"),location:"top"},{activator:l(({props:m})=>[t.unreadCount>0?(d(),h(F,T({key:0},m,{icon:"mdi-email-open",density:"comfortable",variant:"plain",onClick:a[0]||(a[0]=z(r=>n.$emit("readFeed"),["stop"]))}),null,16)):N("",!0)]),_:1},8,["text"]),e(O,{text:n.$t("common.refresh"),location:"top"},{activator:l(({props:m})=>[f.value?N("",!0):(d(),h(F,T({key:0},m,{icon:"mdi-sync",density:"comfortable",variant:"plain",onClick:a[1]||(a[1]=z(r=>n.$emit("refreshFeed"),["stop"]))}),null,16))]),_:1},8,["text"]),e(O,{text:n.$t("common.edit"),location:"top"},{activator:l(({props:m})=>[e(F,T(m,{icon:"mdi-pencil",density:"comfortable",variant:"plain",onClick:a[2]||(a[2]=z(r=>n.$emit("editFeed"),["stop"]))}),null,16)]),_:1},8,["text"]),e(O,{text:n.$t("common.delete"),location:"top"},{activator:l(({props:m})=>[e(F,T(m,{icon:"mdi-delete",color:"red",density:"comfortable",variant:"plain",onClick:a[3]||(a[3]=z(r=>n.$emit("deleteFeed"),["stop"]))}),null,16)]),_:1},8,["text"])]))}}),Mt={class:"d-flex align-center"},Ue=E({__name:"FeedList",props:{height:{}},emits:["update","createFeed","editFeed","deleteFeed","refreshFeed"],setup(t,{emit:p}){const f=p,n=Ne(),a=q(),m=I({get:()=>n.currentRoute.value.params.feedId,set(o){n.replace({name:"rssArticles",params:{tab:"feeds",feedId:o}}).then(()=>f("update",o))}}),r=ct(()=>a.filteredArticles.map(o=>o.feedId));function c(o){return o?(o.articles??[]).reduce((v,g)=>v+ +!g.isRead,0):a.unreadArticles.length}function y(o){m.value=m.value!==o.uid?o.uid:void 0}async function u(o){await a.markFeedAsRead(o)}async function C(){await a.refreshAllFeeds(),a.resumeFeedTimer()}function k(o){const v=c(o);return(v?`${v} | `:"")+`${o?o.name:"All"}`}const i=I(()=>a.feeds.reduce((o,v)=>Math.min(o,s(v)),L.READ));function s(o){return o.isLoading?L.LOADING:o.hasError?L.ERROR:o.articles?.some(v=>!v.isRead)?L.UNREAD:L.READ}return(o,v)=>(d(),h(Ve,{height:t.height},{default:l(()=>[e(G,{active:!m.value,color:"accent",variant:"text",onClick:v[3]||(v[3]=g=>m.value=void 0)},{default:l(()=>[D("div",Mt,[e(ze,{state:i.value},null,8,["state"]),e(ge,null,{default:l(()=>[S(A(k()),1)]),_:1}),e(K),e(O,{text:o.$t("rssArticles.feeds.markAllAsRead"),location:"top"},{activator:l(({props:g})=>[c()>0?(d(),h(F,T({key:0},g,{icon:"mdi-email-open",density:"comfortable",variant:"plain",onClick:v[0]||(v[0]=w=>R(a).markAllAsRead())}),null,16)):N("",!0)]),_:1},8,["text"]),e(O,{text:o.$t("rssArticles.feeds.refreshAllFeeds"),location:"top"},{activator:l(({props:g})=>[i.value!==R(L).LOADING?(d(),h(F,T({key:0},g,{icon:"mdi-sync",density:"comfortable",variant:"plain",onClick:v[1]||(v[1]=w=>C())}),null,16)):N("",!0)]),_:1},8,["text"]),e(O,{text:o.$t("rssArticles.feeds.empty.action"),location:"top"},{activator:l(({props:g})=>[e(F,T(g,{icon:"mdi-plus",density:"comfortable",variant:"plain",onClick:v[2]||(v[2]=w=>o.$emit("createFeed"))}),null,16)]),_:1},8,["text"])])]),_:1},8,["active"]),e(Q,{thickness:"3"}),(d(!0),U(P,null,ee(R(a).feeds,g=>(d(),U(P,null,[(!R(a).filters.unread||c(g)>0)&&(R(a).filters.title==""||!R(r).length||R(r).includes(g.uid))?(d(),h(G,{key:g.uid,active:m.value===g.uid,class:Z(c(g)>0?"text-accent":""),color:"accent",variant:"text",onClick:w=>y(g)},{default:l(()=>[e(Lt,{title:k(g),state:s(g),"unread-count":c(g),onReadFeed:w=>u(g),onRefreshFeed:w=>o.$emit("refreshFeed",g),onEditFeed:w=>o.$emit("editFeed",g),onDeleteFeed:w=>o.$emit("deleteFeed",g)},null,8,["title","state","unread-count","onReadFeed","onRefreshFeed","onEditFeed","onDeleteFeed"])]),_:2},1032,["active","class","onClick"])):N("",!0)],64))),256))]),_:1},8,["height"]))}}),Pt=E({__name:"RssFeedDialog",props:{guid:{},initialFeed:{}},setup(t){const p=t,{t:f}=te(),{isOpened:n}=Me(p.guid),a=q(),m=M(),r=M(!1),c=fe({name:"",url:""}),y=[i=>!!i||f("dialogs.rss.feed.rules.name_required")],u=[i=>!!i||f("dialogs.rss.feed.rules.url_required")];async function C(){await m.value?.validate(),r.value&&(p.initialFeed?(c.url!==p.initialFeed.url&&await a.setFeedUrl(p.initialFeed.name,c.url),c.name!==p.initialFeed.name&&await a.renameFeed(p.initialFeed.name,c.name)):await a.createFeed(c.name,c.url),await a.fetchFeeds(),k())}function k(){n.value=!1}return ve(()=>{p.initialFeed&&(c.name=p.initialFeed.name,c.url=p.initialFeed.url)}),(i,s)=>(d(),h(Y,{modelValue:R(n),"onUpdate:modelValue":s[4]||(s[4]=o=>ae(n)?n.value=o:null)},{default:l(()=>[e(W,null,{default:l(()=>[e(ne,null,{default:l(()=>[S(A(i.$t(`dialogs.rss.feed.title.${t.initialFeed?"edit":"create"}`)),1)]),_:1}),e(se,null,{default:l(()=>[e(R(Ie),{ref_key:"form",ref:m,modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=o=>r.value=o),onSubmit:s[3]||(s[3]=z(()=>{},["prevent"]))},{default:l(()=>[e(x,{modelValue:c.name,"onUpdate:modelValue":s[0]||(s[0]=o=>c.name=o),rules:y,label:i.$t("dialogs.rss.feed.name"),onKeydown:Re(C,["enter"])},null,8,["modelValue","label"]),e(x,{modelValue:c.url,"onUpdate:modelValue":s[1]||(s[1]=o=>c.url=o),rules:u,label:i.$t("dialogs.rss.feed.url"),onKeydown:Re(C,["enter"])},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(ye,null,{default:l(()=>[e(K),e(F,{color:"error",onClick:k},{default:l(()=>[S(A(i.$t("common.cancel")),1)]),_:1}),e(F,{color:"accent",disabled:!r.value,onClick:C},{default:l(()=>[S(A(i.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),It=E({__name:"Feeds",props:{height:{},mobile:{type:Boolean}},emits:["openArticle"],setup(t){const p=t,{t:f}=te(),n=oe(),a=q(),m=M(!1),r=I(()=>p.height-56-16-56-12*2),c=I({get:()=>a.filters.title,set:ft(k=>{a.filters.title=k??""},300)});function y(k){n.createDialog(Pt,{initialFeed:k},a.resumeFeedTimer)}async function u(k){await a.refreshFeed(k.name),a.resumeFeedTimer()}function C(k){n.confirmAction({title:f("dialogs.confirm.deleteFeed"),text:k.name,yesColor:"error",onConfirm:async()=>{await a.deleteFeed(k.name),a.resumeFeedTimer()}})}return Ee(()=>{a.resumeFeedTimer()}),pe(()=>{a.pauseFeedTimer()}),(k,i)=>R(a).feeds.length?(d(),h(W,{key:1,id:"rss-articles",class:"pa-3",height:t.height},{default:l(()=>[e(x,{modelValue:c.value,"onUpdate:modelValue":i[1]||(i[1]=s=>c.value=s),label:k.$t("rssArticles.feeds.filters.title"),clearable:"","hide-details":""},null,8,["modelValue","label"]),e(le,{modelValue:R(a).filters.unread,"onUpdate:modelValue":i[2]||(i[2]=s=>R(a).filters.unread=s),label:k.$t("rssArticles.feeds.filters.unread"),"hide-details":""},null,8,["modelValue","label"]),t.mobile?(d(),U(P,{key:0},[e(Se,{height:r.value,onArticleClicked:i[3]||(i[3]=s=>k.$emit("openArticle",s))},null,8,["height"]),e(Rt,{modelValue:m.value,"onUpdate:modelValue":i[9]||(i[9]=s=>m.value=s),"max-height":"550"},{activator:l(({props:s})=>[e(F,T({class:"fab"},s,{color:"accent",icon:"mdi-format-list-bulleted",size:"large"}),null,16)]),default:l(()=>[e(Ue,{onUpdate:i[4]||(i[4]=s=>m.value=!1),onCreateFeed:i[5]||(i[5]=()=>y()),onEditFeed:i[6]||(i[6]=s=>y(s)),onDeleteFeed:i[7]||(i[7]=s=>C(s)),onRefreshFeed:i[8]||(i[8]=s=>u(s))})]),_:1},8,["modelValue"])],64)):(d(),h(J,{key:1},{default:l(()=>[e(B,{cols:"4"},{default:l(()=>[e(Ue,{height:r.value,onCreateFeed:i[10]||(i[10]=()=>y()),onEditFeed:i[11]||(i[11]=s=>y(s)),onDeleteFeed:i[12]||(i[12]=s=>C(s)),onRefreshFeed:i[13]||(i[13]=s=>u(s))},null,8,["height"])]),_:1}),e(B,{cols:"8"},{default:l(()=>[e(Se,{height:r.value,onArticleClicked:i[14]||(i[14]=s=>k.$emit("openArticle",s))},null,8,["height"])]),_:1})]),_:1}))]),_:1},8,["height"])):(d(),h(W,{key:0,height:t.height},{default:l(()=>[e(Oe,{title:k.$t("rssArticles.feeds.empty.value"),icon:"mdi-rss-off"},{actions:l(()=>[e(F,{text:k.$t("rssArticles.feeds.empty.action"),color:"accent",onClick:i[0]||(i[0]=s=>y())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))}}),Ot={class:"pl-4"},Bt=E({__name:"Rule",props:{value:{}},emits:["openRule"],setup(t){const{t:p}=te(),f=oe(),n=q();async function a(r){await n.setRule(r.name,{...r,enabled:!r.enabled}),n.resumeRuleTimer()}function m(r){f.confirmAction({title:p("dialogs.confirm.deleteRule"),text:r.name,yesColor:"error",onConfirm:async()=>{await n.deleteRule(r.name),n.resumeRuleTimer()}})}return(r,c)=>(d(),h(kt,{rounded:"xl",class:"d-flex align-center"},{default:l(()=>[D("div",Ot,A(t.value.name),1),e(K),D("div",null,[e(F,{class:"my-2 mr-2",icon:t.value.enabled?"mdi-check":"mdi-cancel",color:t.value.enabled?"accent":"red",variant:"plain",density:"compact",onClick:c[0]||(c[0]=y=>a(t.value))},null,8,["icon","color"]),e(O,{text:r.$t("common.edit"),location:"top"},{activator:l(({props:y})=>[e(F,T(y,{class:"my-2 mr-2",icon:"mdi-pencil",variant:"plain",density:"compact",onClick:c[1]||(c[1]=u=>r.$emit("openRule",t.value))}),null,16)]),_:1},8,["text"]),e(O,{text:r.$t("common.delete"),location:"top"},{activator:l(({props:y})=>[e(F,T(y,{class:"my-2 mr-2",icon:"mdi-delete",color:"red",variant:"plain",density:"compact",onClick:c[2]||(c[2]=u=>m(t.value))}),null,16)]),_:1},8,["text"])])]),_:1}))}}),_t=E({__name:"AddTorrentParamsDialog",props:{modelValue:{required:!0},modelModifiers:{},isOpened:{type:Boolean},isOpenedModifiers:{}},emits:["update:modelValue","update:isOpened"],setup(t){const p=Fe(t,"modelValue"),f=Fe(t,"isOpened"),{t:n}=te(),a=M();function m(){a.value?.saveFields(),f.value=!1}return(r,c)=>(d(),h(Y,{modelValue:f.value,"onUpdate:modelValue":c[1]||(c[1]=y=>f.value=y),class:Z(r.$vuetify.display.mobile?"":"w-75"),fullscreen:r.$vuetify.display.mobile,scrollable:""},{default:l(()=>[e(W,null,{default:l(()=>[e(ne,{class:"ios-margin"},{default:l(()=>[e(be,{color:"transparent"},{default:l(()=>[e(Pe,null,{default:l(()=>[S(A(R(n)("dialogs.add.params.title")),1)]),_:1}),e(F,{icon:"mdi-close",onClick:m})]),_:1})]),_:1}),e(se,null,{default:l(()=>[e(vt,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=y=>p.value=y)},null,8,["modelValue"])]),_:1}),e(ye,{class:"mb-2"},{default:l(()=>[e(K),e(F,{text:r.$t("common.close"),color:"",variant:"flat",onClick:m},null,8,["text"])]),_:1})]),_:1})]),_:1},8,["modelValue","class","fullscreen"]))}});function xt(t){return{save_path:t?.save_path??"",skip_checking:!1,add_to_top_of_queue:t?.add_to_top_of_queue??!1,content_layout:t?.torrent_content_layout,stop_condition:t?.torrent_stop_condition,download_limit:t?.dl_limit,upload_limit:t?.up_limit,use_download_path:!!t?.temp_path,download_path:t?.temp_path?t?.temp_path:"",stopped:t?.add_stopped_enabled??t?.start_paused_enabled,use_auto_tmm:t?.auto_tmm_enabled,ratio_limit:-2,seeding_time_limit:-2,inactive_seeding_time_limit:-2}}const zt={class:"d-flex"},qt={class:"d-flex align-center"},jt={class:"v-card-title pa-0"},Ht=E({__name:"RssRuleDialog",props:{guid:{},initialRule:{}},setup(t){const p=t,f=I(()=>!!(p.initialRule&&p.initialRule.name)),{isOpened:n}=Me(p.guid),{t:a}=te(),m=pt(),r=q(),c=M(),y=M(!1),u=fe(s()),C=M(""),k=M([]),i=I(()=>{if(u.lastMatch==="")return a("dialogs.rss.rule.lastMatch.unknownValue").toString();const b=new Date().getTime()-new Date(u.lastMatch).getTime();return a("dialogs.rss.rule.lastMatch.knownValue",Math.floor(b/(1e3*60*60*24)))});function s(){return{affectedFeeds:[],enabled:!0,episodeFilter:"",ignoreDays:0,lastMatch:"",mustContain:"",mustNotContain:"",name:"",priority:0,smartFilter:!1,useRegex:!1,previouslyMatchedEpisodes:f.value?p.initialRule.previouslyMatchedEpisodes:[],torrentParams:xt(m.preferences)}}async function o(){if(C.value==="")return;const b=[],$=await r.fetchMatchingArticles(C.value);for(const V in $){const _=$[V];b.length>0&&b.push({type:"divider"}),b.push({type:"subheader",value:V}),_.forEach(ie=>b.push({type:"item",value:ie}))}k.value=b}async function v(){y.value&&((f.value||C.value!=="")&&C.value!==u.name&&await r.renameRule(C.value,u.name),await r.setRule(u.name,u),C.value=u.name,await r.fetchRules(),await o())}function g(){u.affectedFeeds=[]}function w(){u.affectedFeeds=r.feeds.map(b=>b.url)}function j(){n.value=!1}return ve(async()=>{await r.fetchFeeds(),f.value&&(C.value=p.initialRule.name,Object.assign(u,p.initialRule)),await o()}),(b,$)=>(d(),h(Y,{modelValue:R(n),"onUpdate:modelValue":$[13]||($[13]=V=>ae(n)?n.value=V:null)},{default:l(()=>[e(W,null,{default:l(()=>[e(ne,null,{default:l(()=>[e(be,{color:"transparent",title:b.$t(`dialogs.rss.rule.title.${t.initialRule?"edit":"create"}`)},{default:l(()=>[e(F,{icon:"mdi-close",onClick:j})]),_:1},8,["title"])]),_:1}),e(se,null,{default:l(()=>[e(R(Ie),{ref_key:"form",ref:c,modelValue:y.value,"onUpdate:modelValue":$[11]||($[11]=V=>y.value=V),onSubmit:$[12]||($[12]=z(()=>{},["prevent"]))},{default:l(()=>[e(J,null,{default:l(()=>[e(B,{cols:"12",sm:"6",class:"scrollable-col"},{default:l(()=>[e(x,{modelValue:u.name,"onUpdate:modelValue":$[0]||($[0]=V=>u.name=V),autofocus:"",required:"",label:b.$t("dialogs.rss.rule.name")},null,8,["modelValue","label"]),D("div",zt,[e(At,{modelValue:u.enabled,"onUpdate:modelValue":$[1]||($[1]=V=>u.enabled=V),color:"accent",inset:"","hide-details":"",label:b.$t("dialogs.rss.rule.enabled")},null,8,["modelValue","label"]),e(K),D("div",qt,[e(F,{class:"d-flex align-center justify-center",color:"accent"},{default:l(()=>[S(A(b.$t("dialogs.add.params.title"))+" ",1),e(_t,{modelValue:u.torrentParams,"onUpdate:modelValue":$[2]||($[2]=V=>u.torrentParams=V),activator:"parent"},null,8,["modelValue"])]),_:1})])]),e(Q),e(le,{modelValue:u.useRegex,"onUpdate:modelValue":$[3]||($[3]=V=>u.useRegex=V),"hide-details":"",label:b.$t("dialogs.rss.rule.useRegex")},null,8,["modelValue","label"]),e(x,{modelValue:u.mustContain,"onUpdate:modelValue":$[4]||($[4]=V=>u.mustContain=V),label:b.$t("dialogs.rss.rule.mustContain")},null,8,["modelValue","label"]),e(x,{modelValue:u.mustNotContain,"onUpdate:modelValue":$[5]||($[5]=V=>u.mustNotContain=V),label:b.$t("dialogs.rss.rule.mustNotContain")},null,8,["modelValue","label"]),e(le,{modelValue:u.smartFilter,"onUpdate:modelValue":$[6]||($[6]=V=>u.smartFilter=V),"hide-details":"",label:b.$t("dialogs.rss.rule.smartFilter")},null,8,["modelValue","label"]),e(x,{modelValue:u.episodeFilter,"onUpdate:modelValue":$[7]||($[7]=V=>u.episodeFilter=V),placeholder:b.$t("dialogs.rss.rule.episodeFilterPlaceholder"),label:b.$t("dialogs.rss.rule.episodeFilter")},null,8,["modelValue","placeholder","label"]),e(Q,{class:"mb-4"}),e(x,{modelValue:u.ignoreDays,"onUpdate:modelValue":$[8]||($[8]=V=>u.ignoreDays=V),modelModifiers:{number:!0},type:"number",hint:b.$t("dialogs.rss.rule.ignoreDaysHint"),label:b.$t("dialogs.rss.rule.ignoreDays")},null,8,["modelValue","hint","label"]),e(x,{modelValue:i.value,"onUpdate:modelValue":$[9]||($[9]=V=>i.value=V),disabled:"",label:b.$t("dialogs.rss.rule.lastMatch.label")},null,8,["modelValue","label"]),e(Q),e(we,null,{default:l(()=>[S(A(b.$t("dialogs.rss.rule.affectedFeedsSubheader")),1)]),_:1}),e(J,null,{default:l(()=>[e(B,{cols:"6",class:"d-flex align-center justify-center"},{default:l(()=>[e(F,{color:"accent",onClick:w},{default:l(()=>[S(A(b.$t("common.selectAll")),1)]),_:1})]),_:1}),e(B,{cols:"6",class:"d-flex align-center justify-center"},{default:l(()=>[e(F,{color:"primary",onClick:g},{default:l(()=>[S(A(b.$t("common.selectNone")),1)]),_:1})]),_:1})]),_:1}),(d(!0),U(P,null,ee(R(r).feeds,V=>(d(),h(le,{key:V.uid,modelValue:u.affectedFeeds,"onUpdate:modelValue":$[10]||($[10]=_=>u.affectedFeeds=_),multiple:"","hide-details":"",label:V.name,value:V.url},null,8,["modelValue","label","value"]))),128))]),_:1}),e(Q,{vertical:!b.$vuetify.display.mobile},null,8,["vertical"]),e(B,{cols:"12",sm:"6",class:"scrollable-col"},{default:l(()=>[D("div",jt,A(b.$t("dialogs.rss.rule.matchingArticles.title")),1),e(Ve,null,{default:l(()=>[(d(!0),U(P,null,ee(k.value,(V,_)=>(d(),U(P,{key:_},[V.type==="divider"?(d(),h(Q,{key:0})):V.type==="subheader"?(d(),h(we,{key:1,inset:""},{default:l(()=>[S(A(V.value),1)]),_:2},1024)):(d(),h(G,{key:2,class:"mb-3"},{default:l(()=>[S(A(V.value),1)]),_:2},1024))],64))),128)),k.value.length===0?(d(),h(G,{key:0,title:b.$t("dialogs.rss.rule.matchingArticles.noMatch")},null,8,["title"])):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ye,null,{default:l(()=>[e(K),e(F,{color:"error",onClick:j},{default:l(()=>[S(A(b.$t("common.close")),1)]),_:1}),e(F,{color:"accent",onClick:v},{default:l(()=>[S(A(b.$t("common.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Gt=gt(Ht,[["__scopeId","data-v-ea97b7bc"]]),Kt={key:1,id:"rss-rules",class:"pa-3"},Qt=E({__name:"Rules",props:{height:{}},setup(t){const p=oe(),f=q();function n(a){p.createDialog(Gt,{initialRule:a},f.resumeRuleTimer)}return ve(()=>{f.resumeRuleTimer()}),pe(()=>{f.pauseRuleTimer()}),(a,m)=>R(f).rules.length?(d(),U("div",Kt,[e(J,{class:"mt-2"},{default:l(()=>[(d(!0),U(P,null,ee(R(f).rules,r=>(d(),h(B,{key:r.name,cols:"12",sm:"6",lg:"3"},{default:l(()=>[e(Bt,{value:r,onOpenRule:n},null,8,["value"])]),_:2},1024))),128))]),_:1}),e(J,null,{default:l(()=>[e(B,{cols:"12",class:"d-flex align-center justify-center"},{default:l(()=>[e(F,{color:"accent",onClick:m[1]||(m[1]=r=>n())},{default:l(()=>[S(A(a.$t("rssArticles.rules.empty.action")),1)]),_:1})]),_:1})]),_:1})])):(d(),h(W,{key:0,height:t.height},{default:l(()=>[e(Oe,{title:a.$t("rssArticles.rules.empty.value"),icon:"mdi-rss-off"},{actions:l(()=>[e(F,{text:a.$t("rssArticles.rules.empty.action"),color:"accent",onClick:m[0]||(m[0]=r=>n())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))}}),Wt={class:"pa-3"},Yt={class:"subtitle-1 ml-2",style:{"font-size":"1.6em !important"}},Jt={class:"d-flex justify-end"},Xt=["innerHTML"],rl=E({__name:"RssArticles",setup(t){const{height:p,mobile:f}=$t({mobileBreakpoint:"md"}),n=Te(),a=Ne(),m=oe(),r=q(),c=M(!1),y=fe({title:"",content:""}),u=I(()=>n.params.tab!=="rules"),C=I(()=>p.value-64-12*2-48);function k(v){v.description&&(y.title=v.title.trim(),y.content=v.description.trim(),c.value=!0)}function i(){const v=n.params.tab==="rules"?"feeds":"rules";a.replace({name:"rssArticles",params:{tab:v}}).then(()=>r.lastView=v)}function s(){a.push({name:"dashboard"})}function o(v){if(m.hasActiveDialog||c.value)return!1;v.key==="Escape"&&s()}return Ee(()=>{document.addEventListener("keydown",o)}),pe(()=>{document.removeEventListener("keydown",o)}),(v,g)=>(d(),U(P,null,[D("div",Wt,[e(J,{align:"center",justify:"center","no-gutters":""},{default:l(()=>[e(B,null,{default:l(()=>[D("h1",Yt,A(u.value?v.$t("rssArticles.feeds.title"):v.$t("rssArticles.rules.title")),1)]),_:1}),e(B,null,{default:l(()=>[D("div",Jt,[e(O,{text:v.$t(u.value?"rssArticles.toggle.rules":"rssArticles.toggle.feeds"),location:"top"},{activator:l(({props:w})=>[e(F,T(w,{icon:"mdi-auto-download",variant:"plain",onClick:g[0]||(g[0]=j=>i())}),null,16)]),_:1},8,["text"]),e(F,{icon:"mdi-close",variant:"plain",onClick:g[1]||(g[1]=w=>s())})])]),_:1})]),_:1}),u.value?(d(),h(It,{key:0,height:C.value,mobile:R(f),onOpenArticle:k},null,8,["height","mobile"])):(d(),h(Qt,{key:1,height:C.value},null,8,["height"]))]),e(Y,{modelValue:c.value,"onUpdate:modelValue":g[3]||(g[3]=w=>c.value=w)},{default:l(()=>[e(W,null,{default:l(()=>[e(ne,null,{default:l(()=>[e(be,{color:"transparent"},{default:l(()=>[e(Pe,null,{default:l(()=>[S(A(y.title),1)]),_:1}),e(F,{icon:"mdi-close",onClick:g[2]||(g[2]=w=>c.value=!1)})]),_:1})]),_:1}),e(se,null,{default:l(()=>[D("div",{class:"description-container",innerHTML:R(Qe).sanitize(y.content)},null,8,Xt)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});export{rl as default};
