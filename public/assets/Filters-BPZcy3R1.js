import{b as oe,s as te,e as k,k as re,I as Oe,n as c,y as H,F as ae,v as L,J as Ge,q as We,R as Ne,f as we,a5 as fe,a6 as Ee,K as R,L as T,O as D,P as X,a8 as Je,u as o,V as j,U as P,a1 as He,Y as le,_ as qe,W as q}from"./vue-CaE7KI0c.js";import{v as ze}from"./index-CU4nL9Qq.js";import{aX as Xe,aO as je,aY as Ye,aR as Qe,aZ as Ze,s as Ue,x as me,ax as et,Q as Me,H as O,az as tt,K as $e,a_ as lt,a$ as at,J as nt,b0 as ut,aE as st,W as it,f as ot,aP as rt,b1 as ct,aT as vt,b2 as dt,n as Le,b3 as Ke,aM as ft,b4 as z,b5 as w,b6 as mt,aJ as de,o as pt,C as gt,ag as yt,b7 as ht,b8 as bt,ah as f,b9 as ce}from"./index-BwhHBpBg.js";import{g as Ct,p as kt,i as Vt,h as Fe,w as xt,r as St,u as Dt,s as Tt,t as It,q as Ft,v as Ae,x as Et,y as Re}from"./vuetify-CFh3BNsb.js";function ve(e,d){let n=0;for(;n<e.length;)e[n]===d?e.splice(n,1):++n;return e}const Nt=kt({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...vt({filterKeys:["title"]}),...ct(),...Ft(dt({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...rt({transition:!1})},"VAutocomplete"),Be=Ct()({name:"VAutocomplete",props:Nt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,d){let{slots:n}=d;const{t:F}=Vt(),m=oe(),p=te(!1),g=te(!0),V=te(!1),U=oe(),x=oe(),l=te(-1),{items:E,transformIn:b,transformOut:$}=Xe(e),{textColorClasses:_,textColorStyles:M}=je(()=>m.value?.color),y=Fe(e,"search",""),r=Fe(e,"modelValue",[],t=>b(t===null?[null]:xt(t)),t=>{const s=$(t);return e.multiple?s:s[0]??null}),pe=k(()=>typeof e.counterValue=="function"?e.counterValue(r.value):typeof e.counterValue=="number"?e.counterValue:r.value.length),K=Ye(e),{filteredItems:Y,getMatches:ge}=Qe(e,E,()=>g.value?"":y.value),N=k(()=>e.hideSelected?Y.value.filter(t=>!r.value.some(s=>s.value===t.value)):Y.value),B=k(()=>!!(e.chips||n.chip)),A=k(()=>B.value||!!n.selection),ye=k(()=>r.value.map(t=>t.props.value)),Q=k(()=>(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&y.value===N.value[0]?.title)&&N.value.length>0&&!g.value&&!V.value),G=k(()=>e.hideNoData&&!N.value.length||K.isReadonly.value||K.isDisabled.value),W=Fe(e,"menu"),h=k({get:()=>W.value,set:t=>{W.value&&!t&&U.value?.Î¨openChildren.size||t&&G.value||(W.value=t)}}),ne=k(()=>h.value?e.closeText:e.openText),J=oe(),ue=Ze(J,m);function se(t){e.openOnClear&&(h.value=!0),y.value=""}function he(){G.value||(h.value=!0)}function be(t){G.value||(p.value&&(t.preventDefault(),t.stopPropagation()),h.value=!h.value)}function Ce(t){(Ae(t)||t.key==="Backspace")&&m.value?.focus()}function ke(t){if(K.isReadonly.value)return;const s=m.value?.selectionStart,C=r.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(h.value=!0),["Escape"].includes(t.key)&&(h.value=!1),Q.value&&["Enter","Tab"].includes(t.key)&&!r.value.some(i=>{let{value:u}=i;return u===N.value[0].value})&&v(N.value[0]),t.key==="ArrowDown"&&Q.value&&J.value?.focus("next"),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&A.value&&r.value.length>0&&!y.value)return v(r.value[0],!1);if(~l.value){t.preventDefault();const i=l.value;v(r.value[l.value],!1),l.value=i>=C-1?C-2:i}else t.key==="Backspace"&&!y.value&&(l.value=C-1);return}if(e.multiple)if(t.key==="ArrowLeft"){if(l.value<0&&s&&s>0)return;const i=l.value>-1?l.value-1:C-1;if(r.value[i])l.value=i;else{const u=y.value?.length??null;l.value=-1,m.value?.setSelectionRange(u,u)}}else if(t.key==="ArrowRight"){if(l.value<0)return;const i=l.value+1;r.value[i]?l.value=i:(l.value=-1,m.value?.setSelectionRange(0,0))}else~l.value&&Ae(t)&&(l.value=-1)}function Ve(t){if(Re(m.value,":autofill")||Re(m.value,":-webkit-autofill")){const s=E.value.find(C=>C.title===t.target.value);s&&v(s)}}function xe(){e.eager&&x.value?.calculateVisibleItems()}function Se(){p.value&&(g.value=!0,m.value?.focus())}function De(t){p.value=!0,setTimeout(()=>{V.value=!0})}function Te(t){V.value=!1}function Ie(t){(t==null||t===""&&!e.multiple&&!A.value)&&(r.value=[])}const a=te(!1);function v(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!t||t.props.disabled))if(e.multiple){const C=r.value.findIndex(u=>(e.valueComparator||Et)(u.value,t.value)),i=s??!~C;if(~C){const u=i?[...r.value,t]:[...r.value];u.splice(C,1),r.value=u}else i&&(r.value=[...r.value,t]);e.clearOnSelect&&(y.value="")}else{const C=s!==!1;r.value=C?[t]:[],y.value=C&&!A.value?t.title:"",Oe(()=>{h.value=!1,g.value=!0})}}return re(p,(t,s)=>{t!==s&&(t?(a.value=!0,y.value=e.multiple||A.value?"":String(r.value.at(-1)?.props.title??""),g.value=!0,Oe(()=>a.value=!1)):(!e.multiple&&y.value==null&&(r.value=[]),h.value=!1,(e.multiple||A.value)&&(y.value=""),l.value=-1))}),re(y,t=>{!p.value||a.value||(t&&(h.value=!0),g.value=!t)}),re(h,()=>{if(!e.hideSelected&&h.value&&r.value.length){const t=N.value.findIndex(s=>r.value.some(C=>s.value===C.value));St&&window.requestAnimationFrame(()=>{t>=0&&x.value?.scrollToIndex(t)})}}),re(()=>e.items,(t,s)=>{h.value||p.value&&!s.length&&t.length&&(h.value=!0)}),Dt(()=>{const t=!!(!e.hideNoData||N.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),s=r.value.length>0,C=Ue.filterProps(e);return c(Ue,L({ref:m},C,{modelValue:y.value,"onUpdate:modelValue":[i=>y.value=i,Ie],focused:p.value,"onUpdate:focused":i=>p.value=i,validationValue:r.externalValue,counterValue:pe.value,dirty:s,onChange:Ve,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":h.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!A.value,"v-autocomplete--selecting-index":l.value>-1},e.class],style:e.style,readonly:K.isReadonly.value,placeholder:s?void 0:e.placeholder,"onClick:clear":se,"onMousedown:control":he,onKeydown:ke}),{...n,default:()=>H(ae,null,[c(et,L({ref:U,modelValue:h.value,"onUpdate:modelValue":i=>h.value=i,activator:"parent",contentClass:"v-autocomplete__content",disabled:G.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:xe,onAfterLeave:Se},e.menuProps),{default:()=>[t&&c(Me,L({ref:J,filterable:!0,selected:ye.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:i=>i.preventDefault(),onKeydown:Ce,onFocusin:De,onFocusout:Te,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},ue,e.listProps),{default:()=>[n["prepend-item"]?.(),!N.value.length&&!e.hideNoData&&(n["no-data"]?.()??c(O,{key:"no-data",title:F(e.noDataText)},null)),c(tt,{ref:x,renderless:!0,items:N.value,itemKey:"value"},{default:i=>{let{item:u,index:S,itemRef:ie}=i;const Z=L(u.props,{ref:ie,key:u.value,active:Q.value&&S===0?!0:void 0,onClick:()=>v(u,null)});return u.type==="divider"?n.divider?.({props:u.raw,index:S})??c($e,L(u.props,{key:`divider-${S}`}),null):u.type==="subheader"?n.subheader?.({props:u.raw,index:S})??c(lt,L(u.props,{key:`subheader-${S}`}),null):n.item?.({item:u,index:S,props:Z})??c(O,L(Z,{role:"option"}),{prepend:ee=>{let{isSelected:I}=ee;return H(ae,null,[e.multiple&&!e.hideSelected?c(nt,{key:u.value,modelValue:I,ripple:!1,tabindex:"-1"},null):void 0,u.props.prependAvatar&&c(ut,{image:u.props.prependAvatar},null),u.props.prependIcon&&c(me,{icon:u.props.prependIcon},null)])},title:()=>g.value?u.title:at("v-autocomplete",u.title,ge(u)?.title)})}}),n["append-item"]?.()]})]}),r.value.map((i,u)=>{function S(I){I.stopPropagation(),I.preventDefault(),v(i,!1)}const ie={"onClick:close":S,onKeydown(I){I.key!=="Enter"&&I.key!==" "||(I.preventDefault(),I.stopPropagation(),S(I))},onMousedown(I){I.preventDefault(),I.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},Z=B.value?!!n.chip:!!n.selection,ee=Z?It(B.value?n.chip({item:i,index:u,props:ie}):n.selection({item:i,index:u})):void 0;if(!(Z&&!ee))return H("div",{key:i.value,class:We(["v-autocomplete__selection",u===l.value&&["v-autocomplete__selection--selected",_.value]]),style:Ge(u===l.value?M.value:{})},[B.value?n.chip?c(it,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:i.title}}},{default:()=>[ee]}):c(st,L({key:"chip",closable:e.closableChips,size:"small",text:i.title,disabled:i.props.disabled},ie),null):ee??H("span",{class:"v-autocomplete__selection-text"},[i.title,e.multiple&&u<r.value.length-1&&H("span",{class:"v-autocomplete__selection-comma"},[Ne(",")])])])})]),"append-inner":function(){for(var i=arguments.length,u=new Array(i),S=0;S<i;S++)u[S]=arguments[S];return H(ae,null,[n["append-inner"]?.(...u),e.menuIcon?c(me,{class:"v-autocomplete__menu-icon",color:m.value?.fieldIconColor,icon:e.menuIcon,onMousedown:be,onClick:Tt,"aria-label":F(ne.value),title:F(ne.value),tabindex:"-1"},null):void 0])}})}),ot({isFocused:p,isPristine:g,menu:h,search:y,filteredItems:Y,select:v},m)}}),wt={key:0,class:"text-accent"},$t={key:1,class:"text-accent"},_e=we({__name:"FilterSelectMulti",props:fe({title:{},items:{},filterType:{}},{include:{required:!0},includeModifiers:{},exclude:{required:!0},excludeModifiers:{}}),emits:fe(["disable","toggleFilterType"],["update:include","update:exclude"]),setup(e){const d=Ee(e,"include"),n=Ee(e,"exclude"),{t:F}=Le(),m=k(()=>d.value.length+n.value.length);function p(l){return d.value.includes(l)?w.INCLUDED:n.value.includes(l)?w.EXCLUDED:w.DISABLED}function g(l){switch(p(l)){case w.INCLUDED:return"mdi-plus-box";case w.EXCLUDED:return"mdi-minus-box";case w.DISABLED:default:return"mdi-checkbox-blank-outline"}}function V(l){switch(p(l)){case w.INCLUDED:return"text-green";case w.EXCLUDED:return"text-red";default:return}}function U(l){switch(p(l)){case w.INCLUDED:ve(d.value,l),n.value.push(l);break;case w.EXCLUDED:ve(n.value,l);break;case w.DISABLED:default:d.value.push(l)}}function x(l){ve(d.value,l),ve(n.value,l)}return(l,E)=>(T(),R(O,{class:"px-0 pb-3"},{default:D(()=>[c(Ke,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:D(()=>[Ne(X(e.title),1)]),_:1}),c(Be,{"model-value":[...d.value,...n.value],items:e.items,placeholder:o(F)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{prepend:D(()=>[c(ft,{location:"right",text:o(F)(e.filterType===o(z).CONJUNCTIVE?"constants.filter_type.conjunctive":"constants.filter_type.disjunctive")},{activator:D(({props:b})=>[c(me,L(b,{icon:e.filterType===o(z).CONJUNCTIVE?"mdi-set-center":"mdi-set-all",onClick:E[0]||(E[0]=$=>l.$emit("toggleFilterType"))}),null,16,["icon"])]),_:1},8,["text"])]),"prepend-item":D(()=>[c(O,{title:o(F)("common.disable"),onClick:E[1]||(E[1]=b=>l.$emit("disable"))},null,8,["title"]),c($e)]),selection:D(({item:b,index:$})=>[$===0&&m.value===1?(T(),j("span",wt,X(b.title),1)):$===0?(T(),j("span",$t,X(o(F)("navbar.side.filters.activeFilter",m.value)),1)):P("",!0)]),item:D(({item:b,props:$})=>[Je((T(),R(O,L($,{"data-custom-context-menu":"",class:V(b.value),onClick:_=>U(b.value),onContextmenu:_=>x(b.value)}),{prepend:D(()=>[c(me,{icon:g(b.value)},null,8,["icon"])]),_:2},1040,["class","onClick","onContextmenu"])),[[o(ze),()=>x(b.value)]])]),_:1},8,["model-value","items","placeholder"])]),_:1}))}}),Lt={key:0,class:"text-accent"},Ot={key:1,class:"text-accent"},Pe=we({__name:"FilterSelectSingle",props:fe({title:{},items:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:fe(["disable"],["update:modelValue"]),setup(e){const d=e,n=Ee(e,"modelValue"),F=mt(()=>d.items,(p,g)=>de.text.asc(p.title,g.title)),{t:m}=Le();return(p,g)=>(T(),R(O,{class:"px-0 pb-3"},{default:D(()=>[c(Ke,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:D(()=>[Ne(X(e.title),1)]),_:1}),c(Be,{modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=V=>n.value=V),items:o(F),placeholder:o(m)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{"prepend-item":D(()=>[c(O,{title:o(m)("common.disable"),onClick:g[0]||(g[0]=V=>p.$emit("disable"))},null,8,["title"]),He(p.$slots,"prepend-item"),c($e)]),selection:D(({item:V,index:U})=>[U===0&&n.value.length===1?(T(),j("span",Lt,X(V.title),1)):U===0?(T(),j("span",Ot,X(o(m)("navbar.side.filters.activeFilter",n.value.length)),1)):P("",!0)]),_:3},8,["modelValue","items","placeholder"])]),_:3}))}}),Pt=we({__name:"Filters",setup(e){const{t:d,getTorrentStateString:n}=Le(),{categories:F,torrentsByCategory:m}=le(pt()),{tags:p,torrentsByTag:g}=le(gt()),{torrents:V,torrentsByStatus:U,statusFilter:x,categoryFilter:l,tagFilterInclude:E,tagFilterExclude:b,tagFilterType:$,torrentsByTracker:_,trackerFilterInclude:M,trackerFilterExclude:y,trackerFilterType:r}=le(yt()),{hostnameTrackers:pe}=le(ht()),{filters:K,showFilterState:Y,showFilterCategory:ge,showFilterTag:N,showFilterTracker:B}=le(bt()),A=k(()=>Object.values(f).filter(a=>typeof a=="number").map(a=>({title:`${n(a)} (${U.value[a]??0})`,value:a})).sort((a,v)=>de.text.asc(a.title,v.title))),ye=k(()=>[{title:`${d("navbar.side.filters.category.empty")} (${m.value[""]??0})`,value:""},...F.value.map(a=>({title:`${a.name} (${m.value[a.name]??0})`,value:a.name}))]),Q=k(()=>[{title:`${d("navbar.side.filters.tag.empty")} (${g.value[""]??0})`,value:null},...p.value.map(a=>({title:`${a} (${g.value[a]??0})`,value:a})).sort((a,v)=>de.text.asc(a.value,v.value))]),G=k(()=>[{title:`${d("navbar.side.filters.tracker.empty")} (${_.value[ce.UNTRACKED]??0})`,value:ce.UNTRACKED},{title:`${d("navbar.side.filters.tracker.not_working")} (${_.value[ce.NOT_WORKING]??0})`,value:ce.NOT_WORKING},...pe.value.map(a=>({title:`${a} (${_.value[a]??0})`,value:a})).sort((a,v)=>de.text.asc(a.title,v.title))]);function W(a){switch(a.value){case z.CONJUNCTIVE:a.value=z.DISJUNCTIVE;break;case z.DISJUNCTIVE:a.value=z.CONJUNCTIVE;break}}function h(){W($)}function ne(){W(r)}const J=[f.UPLOADING,f.CHECKING_DISK,f.UL_FORCED,f.DOWNLOADING,f.META_DOWNLOAD,f.FORCED_META_DOWNLOAD,f.CHECKING_DISK,f.DL_FORCED,f.CHECKING_RESUME_DATA,f.MOVING],ue=[f.ERROR,f.MISSING_FILES,f.UNKNOWN],se=[f.ERROR,f.MISSING_FILES,f.UNKNOWN,f.MOVING,f.DL_STOPPED,f.DL_STALLED,f.UL_STOPPED,f.CHECKING_DISK,f.CHECKING_RESUME_DATA];function he(){x.value=[]}const be=k(()=>V.value.filter(a=>J.includes(a.state)).length);function Ce(){x.value=J}const ke=k(()=>V.value.filter(a=>ue.includes(a.state)).length);function Ve(){x.value=ue}const xe=k(()=>V.value.filter(a=>se.includes(a.state)).length);function Se(){x.value=se}function De(){l.value=[]}function Te(){E.value=[],b.value=[]}function Ie(){M.value=[],y.value=[]}return(a,v)=>o(Y)||o(ge)||o(N)||o(B)?(T(),R(Me,{key:0,class:"pb-0 inherit-fg"},{default:D(()=>[(T(!0),j(ae,null,qe(o(K),t=>(T(),j(ae,{key:t.name},[t.name==="state"&&t.active?(T(),R(Pe,{key:0,modelValue:o(x),"onUpdate:modelValue":v[0]||(v[0]=s=>q(x)?x.value=s:null),title:o(d)("navbar.side.filters.state.title"),items:A.value,onDisable:he},{"prepend-item":D(()=>[c(O,{title:`${o(d)("navbar.side.filters.state.active")} (${be.value})`,onClick:Ce},null,8,["title"]),c(O,{title:`${o(d)("navbar.side.filters.state.error")} (${ke.value})`,onClick:Ve},null,8,["title"]),c(O,{title:`${o(d)("navbar.side.filters.state.offline")} (${xe.value})`,onClick:Se},null,8,["title"])]),_:1},8,["modelValue","title","items"])):P("",!0),t.name==="category"&&t.active?(T(),R(Pe,{key:1,modelValue:o(l),"onUpdate:modelValue":v[1]||(v[1]=s=>q(l)?l.value=s:null),title:o(d)("navbar.side.filters.category.title"),items:ye.value,onDisable:De},null,8,["modelValue","title","items"])):P("",!0),t.name==="tag"&&t.active?(T(),R(_e,{key:2,include:o(E),"onUpdate:include":v[2]||(v[2]=s=>q(E)?E.value=s:null),exclude:o(b),"onUpdate:exclude":v[3]||(v[3]=s=>q(b)?b.value=s:null),title:o(d)("navbar.side.filters.tag.title"),items:Q.value,"filter-type":o($),onDisable:Te,onToggleFilterType:h},null,8,["include","exclude","title","items","filter-type"])):P("",!0),t.name==="tracker"&&t.active?(T(),R(_e,{key:3,include:o(M),"onUpdate:include":v[4]||(v[4]=s=>q(M)?M.value=s:null),exclude:o(y),"onUpdate:exclude":v[5]||(v[5]=s=>q(y)?y.value=s:null),title:o(d)("navbar.side.filters.tracker.title"),items:G.value,"filter-type":o(r),onDisable:Ie,onToggleFilterType:ne},null,8,["include","exclude","title","items","filter-type"])):P("",!0)],64))),128))]),_:1})):P("",!0)}});export{Pt as default};
