import{f as _,X as h,$ as v,r as C,b,H as q,w as A,K as S,L as k,O as t,n as e,R as c,P as m,u as n,y as x,T as p,S as V,a0 as g}from"./vue-CGRi7QMO.js";import{A as K,_ as $}from"./PasswordField.vue_vue_type_script_setup_true_lang-CJ4qMokJ.js";import{n as B,$ as T,V as N,q as O,a0 as R,r as U,y as E,A as F}from"./index-zZBTfE4Z.js";import{V as L}from"./VContainer-BG5gguOz.js";import"./vuetify-DqaZWIb1.js";const j=_({__name:"Login",setup(M){const{t:s}=B(),f=h(),o=v(),l=T(),r=C({username:"",password:""}),y=b(!1);async function u(){if(!y.value)return;const i=await l.login(r.username,r.password);if(l.isAuthenticated)g.success(s("login.success")),w();else{let a=s("login.error");i.status!==200&&(a+=`
Error code: ${i.status} (${i.data})`),g.error(a)}}function w(){o.query.redirect?f.push(o.query.redirect):f.push({name:"dashboard"})}return q(async()=>{o.query.username&&o.query.password&&await l.login(o.query.username,o.query.password)}),A(()=>{l.isAuthenticated&&w()}),(i,a)=>(k(),S(L,{class:"fill-height"},{default:t(()=>[e(N,{class:"mx-auto",rounded:"lg","min-width":"250"},{default:t(()=>[e(O,null,{default:t(()=>[c(m(n(s)("login.title")),1)]),_:1}),e(R,null,{default:t(()=>[c(m(n(s)("login.subtitle")),1)]),_:1}),e(U,null,{default:t(()=>[x("form",{onSubmit:p(u,["prevent"])},[e(K,{id:"username",modelValue:r.username,"onUpdate:modelValue":a[0]||(a[0]=d=>r.username=d),title:n(s)("login.username"),autocomplete:"username",autofocus:"",name:"username","prepend-icon":"mdi-account",onKeydown:V(p(u,["prevent"]),["enter"])},null,8,["modelValue","title","onKeydown"]),e($,{id:"password",modelValue:r.password,"onUpdate:modelValue":a[1]||(a[1]=d=>r.password=d),title:n(s)("login.password"),autocomplete:"current-password",name:"password","prepend-icon":"mdi-lock",onKeydown:V(p(u,["prevent"]),["enter"])},null,8,["modelValue","title","onKeydown"])],32)]),_:1}),e(E,null,{default:t(()=>[e(F,{variant:"elevated",block:"",color:"accent",onClick:u},{default:t(()=>[c(m(n(s)("login.submit")),1)]),_:1})]),_:1})]),_:1})]),_:1}))}});export{j as default};
