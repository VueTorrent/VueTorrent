import{f as w,X as g,$ as _,H as b,w as h,K as y,L as C,O as t,n as e,R as c,P as m,u as n,x as S,T as q,r as x,a0 as V}from"./vue-CpUfmXXb.js";import{A as k,_ as v}from"./PasswordField.vue_vue_type_script_setup_true_lang-Ui_vGNG6.js";import{h as A,R as B,V as R,k as T,S as $,l as N,q as U,s as E}from"./index-D_LdC8fx.js";import{V as F}from"./VContainer-gxp-dDUc.js";import"./vuetify-BjHTe0sz.js";const K=w({__name:"Login",setup(L){const{t:s}=A(),p=g(),o=_(),l=B(),r=x({username:"",password:""});async function u(){const i=await l.login(r.username,r.password);if(l.isAuthenticated)V.success(s("login.success")),f();else{let a=s("login.error");i.status!==200&&(a+=`
Error code: ${i.status} (${i.data})`),V.error(a)}}function f(){o.query.redirect?p.push(o.query.redirect):p.push({name:"dashboard"})}return b(async()=>{o.query.username&&o.query.password&&await l.login(o.query.username,o.query.password)}),h(()=>{l.isAuthenticated&&f()}),(i,a)=>(C(),y(F,{class:"fill-height"},{default:t(()=>[e(R,{class:"mx-auto",rounded:"lg","min-width":"250"},{default:t(()=>[e(T,null,{default:t(()=>[c(m(n(s)("login.title")),1)]),_:1}),e($,null,{default:t(()=>[c(m(n(s)("login.subtitle")),1)]),_:1}),e(N,null,{default:t(()=>[S("form",{onSubmit:q(u,["prevent"])},[e(k,{id:"username",modelValue:r.username,"onUpdate:modelValue":a[0]||(a[0]=d=>r.username=d),title:n(s)("login.username"),autocomplete:"username",autofocus:"",name:"username","prepend-icon":"mdi-account",onSubmit:u},null,8,["modelValue","title"]),e(v,{id:"password",modelValue:r.password,"onUpdate:modelValue":a[1]||(a[1]=d=>r.password=d),title:n(s)("login.password"),autocomplete:"current-password",name:"password","prepend-icon":"mdi-lock",onSubmit:u},null,8,["modelValue","title"])],32)]),_:1}),e(U,null,{default:t(()=>[e(E,{variant:"elevated",block:"",color:"accent",onClick:u},{default:t(()=>[c(m(n(s)("login.submit")),1)]),_:1})]),_:1})]),_:1})]),_:1}))}});export{K as default};
