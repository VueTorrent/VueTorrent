import{d as v,m as h}from"./vue.7fbf5199.js";import{a9 as s,r as C,Q as c,s as b,t as x,V as R,u as $,v as y,x as i,y as w,z as k,a as l,a4 as o,A as m,_ as u,B as _,a8 as F,E as L}from"./index.b4dccd49.js";import{M as P}from"./Modal.1c0dbfc6.js";import{C as r}from"./AppPreferences.d0c504d1.js";import{_ as M}from"./VDialog.6fb17cd2.js";import{_ as p}from"./VContainer.de8292f7.js";import{_ as S}from"./VForm.508fd79c.js";import{_ as d}from"./VCheckbox.442c164a.js";import"./index.5260d34f.js";const D=v({name:"RuleForm",mixins:[P],props:["initialRule"],data:()=>({valid:!1,rule:{addPaused:null,affectedFeeds:[],assignedCategory:"",enabled:!0,episodeFilter:"",ignoreDays:0,lastMatch:"",mustContain:"",mustNotContain:"",name:"",savePath:"",smartFilter:!1,torrentContentLayout:null,useRegex:!1},addPausedOptions:[{text:s.t("useGlobalSettings"),value:null},{text:s.t("modals.newRule.def.addPaused.always"),value:!0},{text:s.t("modals.newRule.def.addPaused.never"),value:!1}],contentLayoutOptions:[{text:s.t("useGlobalSettings"),value:null},{text:s.t("enums.contentLayout.original"),value:r.ORIGINAL},{text:s.t("enums.contentLayout.subfolder"),value:r.SUBFOLDER},{text:s.t("enums.contentLayout.nosubfolder"),value:r.NO_SUBFOLDER}],mdiClose:C}),computed:{...h(["getFeeds","getCategories"]),lastMatch(){if(this.rule.lastMatch==="")return s.t("modals.newRule.def.lastMatch.unknownValue").toString();const n=new Date().getTime()-new Date(this.rule.lastMatch).getTime();return s.t("modals.newRule.def.lastMatch.knownValue").toString().replace("%1",Math.floor(n/(1e3*60*60*24)).toString())},availableFeeds(){return this.getFeeds()},availableCategories(){return this.getCategories().map(n=>n.name)},hasInitialRule(){return!!(this.initialRule&&this.initialRule.name)}},created(){this.$store.commit("FETCH_RULES"),this.hasInitialRule&&(this.rule={...this.initialRule})},methods:{async setRule(){this.hasInitialRule&&this.initialRule.name!==this.rule.name&&await c.renameRule(this.initialRule.name,this.rule.name),await c.setRule(this.rule),this.$toast.success(this.$t("toast.ruleSaved")),this.cancel()},cancel(){this.$store.commit("FETCH_RULES"),this.close()},close(){this.dialog=!1}}});var E=function(){var e=this,t=e._self._c;return e._self._setupProxy,t(M,{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[t(x,{attrs:{flat:""}},[t(p,{staticClass:"pa-0 project done"},[t(R,{staticClass:"justify-center"},[t($,{staticClass:"transparent",attrs:{flat:"",dense:""}},[t(y,{staticClass:"mx-auto"},[t("h2",[e._v(e._s(e.hasInitialRule?e.$t("modals.newRule.titleEdit"):e.$t("modals.newRule.titleCreate")))])]),t(i,{staticClass:"transparent elevation-0",attrs:{fab:"",small:""},on:{click:e.close}},[t(w,[e._v(e._s(e.mdiClose))])],1)],1)],1),t(k,{staticClass:"pb-0"},[t(S,{ref:"form",model:{value:e.valid,callback:function(a){e.valid=a},expression:"valid"}},[t(p,[t(l,{attrs:{label:e.$t("modals.newRule.name"),required:""},model:{value:e.rule.name,callback:function(a){e.$set(e.rule,"name",a)},expression:"rule.name"}}),t(o),t(d,{attrs:{"hide-details":"",label:e.$t("modals.newRule.def.useRegex")},model:{value:e.rule.useRegex,callback:function(a){e.$set(e.rule,"useRegex",a)},expression:"rule.useRegex"}}),t(l,{attrs:{"hide-details":"",label:e.$t("modals.newRule.def.mustContain")},model:{value:e.rule.mustContain,callback:function(a){e.$set(e.rule,"mustContain",a)},expression:"rule.mustContain"}}),t(l,{attrs:{"hide-details":"",label:e.$t("modals.newRule.def.mustNotContain")},model:{value:e.rule.mustNotContain,callback:function(a){e.$set(e.rule,"mustNotContain",a)},expression:"rule.mustNotContain"}}),t(d,{attrs:{"hide-details":"",label:e.$t("modals.newRule.def.smartFilter")},model:{value:e.rule.smartFilter,callback:function(a){e.$set(e.rule,"smartFilter",a)},expression:"rule.smartFilter"}}),t(l,{attrs:{label:e.$t("modals.newRule.def.episodeFilter")},model:{value:e.rule.episodeFilter,callback:function(a){e.$set(e.rule,"episodeFilter",a)},expression:"rule.episodeFilter"}}),t(o),t(m,[t("p",{staticClass:"subtitle-1 mb-1"},[e._v(e._s(e.$t("modals.newRule.def.assignedCategory")))]),t(u,{staticClass:"rounded-xl",attrs:{flat:"",solo:"",dense:"","hide-details":"","background-color":"background",items:e.availableCategories},model:{value:e.rule.assignedCategory,callback:function(a){e.$set(e.rule,"assignedCategory",a)},expression:"rule.assignedCategory"}})],1),t(l,{attrs:{"hide-details":"",label:e.$t("modals.newRule.def.savePath")},model:{value:e.rule.savePath,callback:function(a){e.$set(e.rule,"savePath",a)},expression:"rule.savePath"}}),t(l,{attrs:{"hide-details":"",label:e.$t("modals.newRule.def.ignoreDays"),required:"",type:"number",min:"0"},model:{value:e.rule.ignoreDays,callback:function(a){e.$set(e.rule,"ignoreDays",a)},expression:"rule.ignoreDays"}}),t(l,{attrs:{disabled:"",value:e.lastMatch,label:e.$t("modals.newRule.def.lastMatch.title")}}),t(o),t(m,{staticClass:"my-2 flex-gap",attrs:{"no-gutters":""}},[t(_,[t("div",{staticClass:"d-flex flex-column align-center"},[t("p",{staticClass:"subtitle-1 mb-1"},[e._v(e._s(e.$t("modals.newRule.def.addPaused.title")))]),t(u,{staticClass:"rounded-xl",attrs:{flat:"",solo:"",dense:"","hide-details":"","background-color":"background",items:e.addPausedOptions},model:{value:e.rule.addPaused,callback:function(a){e.$set(e.rule,"addPaused",a)},expression:"rule.addPaused"}})],1)]),t(_,[t("div",{staticClass:"d-flex flex-column align-center"},[t("p",{staticClass:"subtitle-1 mb-1"},[e._v(e._s(e.$t("enums.contentLayout.title")))]),t(u,{staticClass:"rounded-xl",attrs:{flat:"",solo:"",dense:"","hide-details":"","background-color":"background",items:e.contentLayoutOptions},model:{value:e.rule.torrentContentLayout,callback:function(a){e.$set(e.rule,"torrentContentLayout",a)},expression:"rule.torrentContentLayout"}})],1)])],1),t(F,{staticClass:"pa-0"},[e._v(" "+e._s(e.$t("modals.newRule.def.affectedFeeds"))+" ")]),e._l(e.availableFeeds,function(a,f){return t(d,{key:f,attrs:{"hide-details":"",label:a.name,value:a.url},model:{value:e.rule.affectedFeeds,callback:function(g){e.$set(e.rule,"affectedFeeds",g)},expression:"rule.affectedFeeds"}})})],2)],1)],1),t(o),t(L,{staticClass:"justify-end"},[e.hasInitialRule?t(i,{staticClass:"accent white--text elevation-0 px-4",attrs:{disabled:!e.valid},on:{click:e.setRule}},[e._v(" "+e._s(e.$t("edit"))+" ")]):t(i,{staticClass:"accent white--text elevation-0 px-4",attrs:{disabled:!e.valid},on:{click:e.setRule}},[e._v(" "+e._s(e.$t("create"))+" ")]),t(i,{staticClass:"error white--text elevation-0 px-4",on:{click:e.cancel}},[e._v(" "+e._s(e.$t("cancel"))+" ")])],1)],1)],1)],1)},O=[],T=b(D,E,O,!1,null,null,null,null);const z=T.exports;export{z as default};
