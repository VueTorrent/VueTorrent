import{s as Q,e as V,k as pe,I as Pe,b as ge,n as i,x as Z,F as ce,v as R,J as Ze,q as et,t as tt,R as Ae,f as Oe,a7 as be,a8 as Ue,K,L as E,O as T,P as le,a2 as lt,u,V as ae,U as q,a1 as at,Y as re,_ as nt,W as ee}from"./vue-l9nRghEe.js";import{v as ut}from"./index-CZTbTkUd.js";import{aQ as st,a5 as it,aR as ot,aS as rt,aE as ct,aT as vt,n as Ke,p as ke,at as dt,I as qe,aU as ft,y as O,av as mt,D as _e,aV as pt,aW as gt,C as yt,aX as ht,ay as Be,N as Ct,f as bt,aY as kt,aH as Vt,aZ as Dt,h as Me,a_ as ze,aJ as St,a$ as te,b0 as L,b1 as xt,aM as Ce,i as It,v as Tt,ac as Et,b2 as Ft,b3 as Nt,ad as f,b4 as ye}from"./index-BU4dL-WE.js";import{g as wt,p as $t,h as Lt,j as Re,w as Rt,r as Ut,u as At,s as Ot,t as _t,q as Mt,v as Ge,x as Pt,y as We}from"./vuetify-B7CDgVb0.js";function he(e,r){let a=0;for(;a<e.length;)e[a]===r?e.splice(a,1):++a;return e}const Kt=$t({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Vt({filterKeys:["title"]}),...kt(),...Mt(Dt({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VAutocomplete"),Xe=wt()({name:"VAutocomplete",props:Kt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,r){let{slots:a}=r;const{t:U}=Lt(),m=ge(),p=Q(!1),d=Q(!0),x=Q(!1),_=ge(),I=ge(),l=Q(-1),D=Q(null),{items:b,transformIn:A,transformOut:B}=st(e),{textColorClasses:z,textColorStyles:X}=it(()=>m.value?.color),{InputIcon:ve}=ot(e),g=Re(e,"search",""),s=Re(e,"modelValue",[],t=>A(t===null?[null]:Rt(t)),t=>{const c=B(t);return e.multiple?c:c[0]??null}),Ve=V(()=>typeof e.counterValue=="function"?e.counterValue(s.value):typeof e.counterValue=="number"?e.counterValue:s.value.length),P=rt(e),{filteredItems:ne,getMatches:De}=ct(e,b,()=>D.value??(d.value?"":g.value)),w=V(()=>e.hideSelected&&D.value===null?ne.value.filter(t=>!s.value.some(c=>c.value===t.value)):ne.value),de=tt(()=>e.closableChips&&!P.isReadonly.value&&!P.isDisabled.value),j=V(()=>!!(e.chips||a.chip)),G=V(()=>j.value||!!a.selection),fe=V(()=>s.value.map(t=>t.props.value)),W=V(()=>w.value.find(t=>t.type==="item"&&!t.props.disabled)),ue=V(()=>(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&g.value===W.value?.title)&&w.value.length>0&&!d.value&&!x.value),H=V(()=>e.hideNoData&&!w.value.length||P.isReadonly.value||P.isDisabled.value),Y=Re(e,"menu"),y=V({get:()=>Y.value,set:t=>{Y.value&&!t&&_.value?.Î¨openChildren.size||t&&H.value||(Y.value=t)}}),{menuId:Se,ariaExpanded:xe,ariaControls:Ie}=vt(e,y),se=ge(),Te=ft(se,m);function Ee(t){e.openOnClear&&(y.value=!0),g.value=""}function Fe(){H.value||(y.value=!0)}function Ne(t){H.value||(p.value&&(t.preventDefault(),t.stopPropagation()),y.value=!y.value)}function we(t){(Ge(t)||t.key==="Backspace")&&m.value?.focus()}function $e(t){if(P.isReadonly.value)return;const c=m.value?.selectionStart,k=s.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(y.value=!0),["Escape"].includes(t.key)&&(y.value=!1),ue.value&&["Enter","Tab"].includes(t.key)&&W.value&&!s.value.some(v=>{let{value:S}=v;return S===W.value.value})&&J(W.value),t.key==="ArrowDown"&&ue.value&&se.value?.focus("next"),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&G.value&&s.value.length>0&&!g.value)return J(s.value[0],!1);if(~l.value){t.preventDefault();const v=l.value;J(s.value[l.value],!1),l.value=v>=k-1?k-2:v}else t.key==="Backspace"&&!g.value&&(l.value=k-1);return}if(e.multiple)if(t.key==="ArrowLeft"){if(l.value<0&&c&&c>0)return;const v=l.value>-1?l.value-1:k-1;if(s.value[v])l.value=v;else{const S=g.value?.length??null;l.value=-1,m.value?.setSelectionRange(S,S)}}else if(t.key==="ArrowRight"){if(l.value<0)return;const v=l.value+1;s.value[v]?l.value=v:(l.value=-1,m.value?.setSelectionRange(0,0))}else~l.value&&Ge(t)&&(l.value=-1)}function n(t){if(We(m.value,":autofill")||We(m.value,":-webkit-autofill")){const c=b.value.find(k=>k.title===t.target.value);c&&J(c)}}function h(){e.eager&&I.value?.calculateVisibleItems()}function $(){p.value&&(d.value=!0,m.value?.focus()),D.value=null}function F(t){p.value=!0,setTimeout(()=>{x.value=!0})}function je(t){x.value=!1}function Ye(t){(t==null||t===""&&!e.multiple&&!G.value)&&(s.value=[])}const Le=Q(!1);function J(t){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!t||t.props.disabled))if(e.multiple){const k=s.value.findIndex(S=>(e.valueComparator||Pt)(S.value,t.value)),v=c??!~k;if(~k){const S=v?[...s.value,t]:[...s.value];S.splice(k,1),s.value=S}else v&&(s.value=[...s.value,t]);e.clearOnSelect&&(g.value="")}else{const k=c!==!1;s.value=k?[t]:[],D.value=d.value?"":g.value??"",g.value=k&&!G.value?t.title:"",Pe(()=>{y.value=!1,d.value=!0})}}return pe(p,(t,c)=>{t!==c&&(t?(Le.value=!0,g.value=e.multiple||G.value?"":String(s.value.at(-1)?.props.title??""),d.value=!0,Pe(()=>Le.value=!1)):(!e.multiple&&g.value==null&&(s.value=[]),y.value=!1,!d.value&&g.value&&(D.value=g.value),g.value="",l.value=-1))}),pe(g,t=>{!p.value||Le.value||(t&&(y.value=!0),d.value=!t)}),pe(y,t=>{if(!e.hideSelected&&t&&s.value.length&&d.value){const c=w.value.findIndex(k=>s.value.some(v=>k.value===v.value));Ut&&window.requestAnimationFrame(()=>{c>=0&&I.value?.scrollToIndex(c)})}t&&(D.value=null)}),pe(b,(t,c)=>{y.value||p.value&&!c.length&&t.length&&(y.value=!0)}),At(()=>{const t=!!(!e.hideNoData||w.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),c=s.value.length>0,k=Ke.filterProps(e);return i(Ke,R({ref:m},k,{modelValue:g.value,"onUpdate:modelValue":[v=>g.value=v,Ye],focused:p.value,"onUpdate:focused":v=>p.value=v,validationValue:s.externalValue,counterValue:Ve.value,dirty:c,onChange:n,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":y.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!G.value,"v-autocomplete--selecting-index":l.value>-1},e.class],style:e.style,readonly:P.isReadonly.value,placeholder:c?void 0:e.placeholder,"onClick:clear":Ee,"onMousedown:control":Fe,onKeydown:$e,"aria-expanded":xe.value,"aria-controls":Ie.value}),{...a,default:v=>{let{id:S}=v;return Z(ce,null,[i(dt,R({id:Se.value,ref:_,modelValue:y.value,"onUpdate:modelValue":C=>y.value=C,activator:"parent",contentClass:"v-autocomplete__content",disabled:H.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:h,onAfterLeave:$},e.menuProps),{default:()=>[t&&i(qe,R({ref:se,filterable:!0,selected:fe.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:C=>C.preventDefault(),onKeydown:we,onFocusin:F,onFocusout:je,tabindex:"-1",selectable:!!w.value.length,"aria-live":"polite","aria-labelledby":`${S.value}-label`,"aria-multiselectable":e.multiple,color:e.itemColor??e.color},Te,e.listProps),{default:()=>[a["prepend-item"]?.(),!w.value.length&&!e.hideNoData&&(a["no-data"]?.()??i(O,{key:"no-data",title:U(e.noDataText)},null)),i(mt,{ref:I,renderless:!0,items:w.value,itemKey:"value"},{default:C=>{let{item:o,index:M,itemRef:me}=C;const ie=R(o.props,{ref:me,key:o.value,active:ue.value&&o===W.value?!0:void 0,onClick:()=>J(o,null),"aria-posinset":M+1,"aria-setsize":w.value.length});return o.type==="divider"?a.divider?.({props:o.raw,index:M})??i(_e,R(o.props,{key:`divider-${M}`}),null):o.type==="subheader"?a.subheader?.({props:o.raw,index:M})??i(pt,R(o.props,{key:`subheader-${M}`}),null):a.item?.({item:o,index:M,props:ie})??i(O,R(ie,{role:"option"}),{prepend:oe=>{let{isSelected:N}=oe;return Z(ce,null,[e.multiple&&!e.hideSelected?i(yt,{key:o.value,modelValue:N,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:Qe=>Qe.preventDefault()},null):void 0,o.props.prependAvatar&&i(ht,{image:o.props.prependAvatar},null),o.props.prependIcon&&i(ke,{icon:o.props.prependIcon},null)])},title:()=>d.value?o.title:gt("v-autocomplete",o.title,De(o)?.title)})}}),a["append-item"]?.()]})]}),s.value.map((C,o)=>{function M(N){N.stopPropagation(),N.preventDefault(),J(C,!1)}const me=R(Be.filterProps(C.props),{"onClick:close":M,onKeydown(N){N.key!=="Enter"&&N.key!==" "||(N.preventDefault(),N.stopPropagation(),M(N))},onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),ie=j.value?!!a.chip:!!a.selection,oe=ie?_t(j.value?a.chip({item:C,index:o,props:me}):a.selection({item:C,index:o})):void 0;if(!(ie&&!oe))return Z("div",{key:C.value,class:et(["v-autocomplete__selection",o===l.value&&["v-autocomplete__selection--selected",z.value]]),style:Ze(o===l.value?X.value:{})},[j.value?a.chip?i(Ct,{key:"chip-defaults",defaults:{VChip:{closable:de.value,size:"small",text:C.title}}},{default:()=>[oe]}):i(Be,R({key:"chip",closable:de.value,size:"small",text:C.title,disabled:C.props.disabled},me),null):oe??Z("span",{class:"v-autocomplete__selection-text"},[C.title,e.multiple&&o<s.value.length-1&&Z("span",{class:"v-autocomplete__selection-comma"},[Ae(",")])])])})])},"append-inner":function(){for(var v=arguments.length,S=new Array(v),C=0;C<v;C++)S[C]=arguments[C];return Z(ce,null,[a["append-inner"]?.(...S),e.menuIcon?i(ke,{class:"v-autocomplete__menu-icon",color:m.value?.fieldIconColor,icon:e.menuIcon,onMousedown:Ne,onClick:Ot,"aria-hidden":!0,tabindex:"-1"},null):void 0,e.appendInnerIcon&&i(ve,{key:"append-icon",name:"appendInner",color:S[0].iconColor.value},null)])}})}),bt({isFocused:p,isPristine:d,menu:y,search:g,filteredItems:ne,select:J},m)}}),Bt={key:0,class:"text-accent"},Gt={key:1,class:"text-accent"},He=Oe({__name:"FilterSelectMulti",props:be({title:{},items:{},filterType:{}},{include:{required:!0},includeModifiers:{},exclude:{required:!0},excludeModifiers:{}}),emits:be(["disable","toggleFilterType"],["update:include","update:exclude"]),setup(e){const r=Ue(e,"include"),a=Ue(e,"exclude"),{t:U}=Me(),m=V(()=>r.value.length+a.value.length);function p(l){return r.value.includes(l)?L.INCLUDED:a.value.includes(l)?L.EXCLUDED:L.DISABLED}function d(l){switch(p(l)){case L.INCLUDED:return"mdi-plus-box";case L.EXCLUDED:return"mdi-minus-box";case L.DISABLED:default:return"mdi-checkbox-blank-outline"}}function x(l){switch(p(l)){case L.INCLUDED:return"text-green";case L.EXCLUDED:return"text-red";default:return}}function _(l){switch(p(l)){case L.INCLUDED:he(r.value,l),a.value.push(l);break;case L.EXCLUDED:he(a.value,l);break;case L.DISABLED:default:r.value.push(l)}}function I(l){he(r.value,l),he(a.value,l)}return(l,D)=>(E(),K(O,{class:"px-0 pb-3"},{default:T(()=>[i(ze,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:T(()=>[Ae(le(e.title),1)]),_:1}),i(Xe,{"model-value":[...r.value,...a.value],items:e.items,placeholder:u(U)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{prepend:T(()=>[i(St,{location:"right",text:u(U)(e.filterType===u(te).CONJUNCTIVE?"constants.filter_type.conjunctive":"constants.filter_type.disjunctive")},{activator:T(({props:b})=>[i(ke,R(b,{icon:e.filterType===u(te).CONJUNCTIVE?"mdi-set-center":"mdi-set-all",onClick:D[0]||(D[0]=A=>l.$emit("toggleFilterType"))}),null,16,["icon"])]),_:1},8,["text"])]),"prepend-item":T(()=>[i(O,{title:u(U)("common.disable"),onClick:D[1]||(D[1]=b=>l.$emit("disable"))},null,8,["title"]),i(_e)]),selection:T(({item:b,index:A})=>[A===0&&m.value===1?(E(),ae("span",Bt,le(b.title),1)):A===0?(E(),ae("span",Gt,le(u(U)("navbar.side.filters.activeFilter",m.value)),1)):q("",!0)]),item:T(({item:b,props:A})=>[lt((E(),K(O,R(A,{"data-custom-context-menu":"",class:x(b.value),onClick:B=>_(b.value),onContextmenu:B=>I(b.value)}),{prepend:T(()=>[i(ke,{icon:d(b.value)},null,8,["icon"])]),_:2},1040,["class","onClick","onContextmenu"])),[[u(ut),()=>I(b.value)]])]),_:1},8,["model-value","items","placeholder"])]),_:1}))}}),Wt={key:0,class:"text-accent"},Ht={key:1,class:"text-accent"},Je=Oe({__name:"FilterSelectSingle",props:be({title:{},items:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:be(["disable"],["update:modelValue"]),setup(e){const r=e,a=Ue(e,"modelValue"),U=xt(()=>r.items,(p,d)=>Ce.text.asc(p.title,d.title)),{t:m}=Me();return(p,d)=>(E(),K(O,{class:"px-0 pb-3"},{default:T(()=>[i(ze,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:T(()=>[Ae(le(e.title),1)]),_:1}),i(Xe,{modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=x=>a.value=x),items:u(U),placeholder:u(m)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{"prepend-item":T(()=>[i(O,{title:u(m)("common.disable"),onClick:d[0]||(d[0]=x=>p.$emit("disable"))},null,8,["title"]),at(p.$slots,"prepend-item"),i(_e)]),selection:T(({item:x,index:_})=>[_===0&&a.value.length===1?(E(),ae("span",Wt,le(x.title),1)):_===0?(E(),ae("span",Ht,le(u(m)("navbar.side.filters.activeFilter",a.value.length)),1)):q("",!0)]),_:3},8,["modelValue","items","placeholder"])]),_:3}))}}),jt=Oe({__name:"Filters",setup(e){const{t:r,getTorrentStateString:a}=Me(),{categories:U,torrentsByCategory:m}=re(It()),{tags:p,torrentsByTag:d}=re(Tt()),{torrents:x,torrentsByStatus:_,statusFilter:I,categoryFilter:l,tagFilterInclude:D,tagFilterExclude:b,tagFilterType:A,torrentsByTracker:B,trackerFilterInclude:z,trackerFilterExclude:X,trackerFilterType:ve}=re(Et()),{hostnameTrackers:g}=re(Ft()),{filters:s,showFilterState:Ve,showFilterCategory:P,showFilterTag:ne,showFilterTracker:De}=re(Nt()),w=V(()=>Object.values(f).filter(n=>typeof n=="number").map(n=>({title:`${a(n)} (${_.value[n]??0})`,value:n})).sort((n,h)=>Ce.text.asc(n.title,h.title))),de=V(()=>[{title:`${r("navbar.side.filters.category.empty")} (${m.value[""]??0})`,value:""},...U.value.map(n=>({title:`${n.name} (${m.value[n.name]??0})`,value:n.name}))]),j=V(()=>[{title:`${r("navbar.side.filters.tag.empty")} (${d.value[""]??0})`,value:null},...p.value.map(n=>({title:`${n} (${d.value[n]??0})`,value:n})).sort((n,h)=>Ce.text.asc(n.value,h.value))]),G=V(()=>[{title:`${r("navbar.side.filters.tracker.empty")} (${B.value[ye.UNTRACKED]??0})`,value:ye.UNTRACKED},{title:`${r("navbar.side.filters.tracker.not_working")} (${B.value[ye.NOT_WORKING]??0})`,value:ye.NOT_WORKING},...g.value.map(n=>({title:`${n} (${B.value[n]??0})`,value:n})).sort((n,h)=>Ce.text.asc(n.title,h.title))]);function fe(n){switch(n.value){case te.CONJUNCTIVE:n.value=te.DISJUNCTIVE;break;case te.DISJUNCTIVE:n.value=te.CONJUNCTIVE;break}}function W(){fe(A)}function ue(){fe(ve)}const H=[f.UPLOADING,f.CHECKING_DISK,f.UL_FORCED,f.DOWNLOADING,f.META_DOWNLOAD,f.FORCED_META_DOWNLOAD,f.CHECKING_DISK,f.DL_FORCED,f.CHECKING_RESUME_DATA,f.MOVING],Y=[f.ERROR,f.MISSING_FILES,f.UNKNOWN],y=[f.ERROR,f.MISSING_FILES,f.UNKNOWN,f.MOVING,f.DL_STOPPED,f.DL_STALLED,f.UL_STOPPED,f.CHECKING_DISK,f.CHECKING_RESUME_DATA];function Se(){I.value=[]}const xe=V(()=>x.value.filter(n=>H.includes(n.state)).length);function Ie(){I.value=H}const se=V(()=>x.value.filter(n=>Y.includes(n.state)).length);function Te(){I.value=Y}const Ee=V(()=>x.value.filter(n=>y.includes(n.state)).length);function Fe(){I.value=y}function Ne(){l.value=[]}function we(){D.value=[],b.value=[]}function $e(){z.value=[],X.value=[]}return(n,h)=>u(Ve)||u(P)||u(ne)||u(De)?(E(),K(qe,{key:0,class:"pb-0 inherit-fg"},{default:T(()=>[(E(!0),ae(ce,null,nt(u(s),$=>(E(),ae(ce,{key:$.name},[$.name==="state"&&$.active?(E(),K(Je,{key:0,modelValue:u(I),"onUpdate:modelValue":h[0]||(h[0]=F=>ee(I)?I.value=F:null),title:u(r)("navbar.side.filters.state.title"),items:w.value,onDisable:Se},{"prepend-item":T(()=>[i(O,{title:`${u(r)("navbar.side.filters.state.active")} (${xe.value})`,onClick:Ie},null,8,["title"]),i(O,{title:`${u(r)("navbar.side.filters.state.error")} (${se.value})`,onClick:Te},null,8,["title"]),i(O,{title:`${u(r)("navbar.side.filters.state.offline")} (${Ee.value})`,onClick:Fe},null,8,["title"])]),_:1},8,["modelValue","title","items"])):q("",!0),$.name==="category"&&$.active?(E(),K(Je,{key:1,modelValue:u(l),"onUpdate:modelValue":h[1]||(h[1]=F=>ee(l)?l.value=F:null),title:u(r)("navbar.side.filters.category.title"),items:de.value,onDisable:Ne},null,8,["modelValue","title","items"])):q("",!0),$.name==="tag"&&$.active?(E(),K(He,{key:2,include:u(D),"onUpdate:include":h[2]||(h[2]=F=>ee(D)?D.value=F:null),exclude:u(b),"onUpdate:exclude":h[3]||(h[3]=F=>ee(b)?b.value=F:null),title:u(r)("navbar.side.filters.tag.title"),items:j.value,"filter-type":u(A),onDisable:we,onToggleFilterType:W},null,8,["include","exclude","title","items","filter-type"])):q("",!0),$.name==="tracker"&&$.active?(E(),K(He,{key:3,include:u(z),"onUpdate:include":h[4]||(h[4]=F=>ee(z)?z.value=F:null),exclude:u(X),"onUpdate:exclude":h[5]||(h[5]=F=>ee(X)?X.value=F:null),title:u(r)("navbar.side.filters.tracker.title"),items:G.value,"filter-type":u(ve),onDisable:$e,onToggleFilterType:ue},null,8,["include","exclude","title","items","filter-type"])):q("",!0)],64))),128))]),_:1})):q("",!0)}});export{jt as default};
