import{f as G,a5 as w,a6 as M,e as S,J as I,K as o,M as u,n as c,S as Y,Q as $,a7 as Ne,u as t,v as j,W as U,V as k,a2 as ke,Z as O,F as q,$ as Fe,X as x}from"./vue-RBz4_81T.js";import{v as xe}from"./index-DcdVui_i.js";import{o as B,H as N,at as ee,a as Q,K as te,au as Ve,av as V,I as le,aw as f,ax as $e,ay as K,p as Ue,C as Le,ag as Oe,az as _e,aA as he,ah as a,aB as A,Q as Ae}from"./index-Cd2SPO4s.js";import"./vuetify-CqJhlpxZ.js";function R(d,s){let i=0;for(;i<d.length;)d[i]===s?d.splice(i,1):++i;return d}const Re={key:0,class:"text-accent"},Ke={key:1,class:"text-accent"},z=G({__name:"FilterSelectMulti",props:w({title:{},items:{},filterType:{}},{include:{required:!0},includeModifiers:{},exclude:{required:!0},excludeModifiers:{}}),emits:w(["disable","toggleFilterType"],["update:include","update:exclude"]),setup(d){const s=M(d,"include"),i=M(d,"exclude"),{t:b}=B(),D=S(()=>s.value.length+i.value.length);function v(l){return s.value.includes(l)?f.INCLUDED:i.value.includes(l)?f.EXCLUDED:f.DISABLED}function p(l){switch(v(l)){case f.INCLUDED:return"mdi-plus-box";case f.EXCLUDED:return"mdi-minus-box";case f.DISABLED:default:return"mdi-checkbox-blank-outline"}}function g(l){switch(v(l)){case f.INCLUDED:return"text-green";case f.EXCLUDED:return"text-red";default:return}}function F(l){switch(v(l)){case f.INCLUDED:R(s.value,l),i.value.push(l);break;case f.EXCLUDED:R(i.value,l);break;case f.DISABLED:default:s.value.push(l)}}function C(l){R(s.value,l),R(i.value,l)}return(l,T)=>(o(),I(N,{class:"px-0 pb-3"},{default:u(()=>[c(ee,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:u(()=>[Y($(l.title),1)]),_:1}),c(le,{"model-value":[...s.value,...i.value],items:l.items,placeholder:t(b)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{prepend:u(()=>[c(Ve,{location:"right",text:t(b)(l.filterType===t(V).CONJUNCTIVE?"constants.filter_type.conjunctive":"constants.filter_type.disjunctive")},{activator:u(({props:r})=>[c(Q,j(r,{icon:l.filterType===t(V).CONJUNCTIVE?"mdi-set-center":"mdi-set-all",onClick:T[0]||(T[0]=E=>l.$emit("toggleFilterType"))}),null,16,["icon"])]),_:1},8,["text"])]),"prepend-item":u(()=>[c(N,{title:t(b)("common.disable"),onClick:T[1]||(T[1]=r=>l.$emit("disable"))},null,8,["title"]),c(te)]),selection:u(({item:r,index:E})=>[E===0&&D.value===1?(o(),U("span",Re,$(r.title),1)):E===0?(o(),U("span",Ke,$(t(b)("navbar.side.filters.activeFilter",D.value)),1)):k("",!0)]),item:u(({item:r,props:E})=>[Ne((o(),I(N,j(E,{"data-custom-context-menu":"",class:g(r.value),onClick:L=>F(r.value),onContextmenu:L=>C(r.value)}),{prepend:u(()=>[c(Q,{icon:p(r.value)},null,8,["icon"])]),_:2},1040,["class","onClick","onContextmenu"])),[[t(xe),()=>C(r.value)]])]),_:1},8,["model-value","items","placeholder"])]),_:1}))}}),we={key:0,class:"text-accent"},Me={key:1,class:"text-accent"},Z=G({__name:"FilterSelectSingle",props:w({title:{},items:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:w(["disable"],["update:modelValue"]),setup(d){const s=d,i=M(d,"modelValue"),b=$e(()=>s.items,(v,p)=>K.text.asc(v.title,p.title)),{t:D}=B();return(v,p)=>(o(),I(N,{class:"px-0 pb-3"},{default:u(()=>[c(ee,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:u(()=>[Y($(v.title),1)]),_:1}),c(le,{modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=g=>i.value=g),items:t(b),placeholder:t(D)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{"prepend-item":u(()=>[c(N,{title:t(D)("common.disable"),onClick:p[0]||(p[0]=g=>v.$emit("disable"))},null,8,["title"]),ke(v.$slots,"prepend-item"),c(te)]),selection:u(({item:g,index:F})=>[F===0&&i.value.length===1?(o(),U("span",we,$(g.title),1)):F===0?(o(),U("span",Me,$(t(D)("navbar.side.filters.activeFilter",i.value.length)),1)):k("",!0)]),_:3},8,["modelValue","items","placeholder"])]),_:3}))}}),Pe=G({__name:"Filters",setup(d){const{t:s,getTorrentStateString:i}=B(),{categories:b,torrentsByCategory:D}=O(Ue()),{tags:v,torrentsByTag:p}=O(Le()),{torrents:g,torrentsByStatus:F,statusFilter:C,categoryFilter:l,tagFilterInclude:T,tagFilterExclude:r,tagFilterType:E,torrentsByTracker:L,trackerFilterInclude:_,trackerFilterExclude:h,trackerFilterType:W}=O(Oe()),{hostnameTrackers:ae}=O(_e()),{filters:se,showFilterState:ie,showFilterCategory:ne,showFilterTag:re,showFilterTracker:ue}=O(he()),oe=S(()=>Object.values(a).filter(e=>typeof e=="number").map(e=>({title:`${i(e)} (${F.value[e]??0})`,value:e})).sort((e,n)=>K.text.asc(e.title,n.title))),ce=S(()=>[{title:`${s("navbar.side.filters.category.empty")} (${D.value[""]??0})`,value:""},...b.value.map(e=>({title:`${e.name} (${D.value[e.name]??0})`,value:e.name}))]),de=S(()=>[{title:`${s("navbar.side.filters.tag.empty")} (${p.value[""]??0})`,value:null},...v.value.map(e=>({title:`${e} (${p.value[e]??0})`,value:e})).sort((e,n)=>K.text.asc(e.value,n.value))]),ve=S(()=>[{title:`${s("navbar.side.filters.tracker.empty")} (${L.value[A.UNTRACKED]??0})`,value:A.UNTRACKED},{title:`${s("navbar.side.filters.tracker.not_working")} (${L.value[A.NOT_WORKING]??0})`,value:A.NOT_WORKING},...ae.value.map(e=>({title:`${e} (${L.value[e]??0})`,value:e})).sort((e,n)=>K.text.asc(e.title,n.title))]);function J(e){switch(e.value){case V.CONJUNCTIVE:e.value=V.DISJUNCTIVE;break;case V.DISJUNCTIVE:e.value=V.CONJUNCTIVE;break}}function pe(){J(E)}function me(){J(W)}const P=[a.UPLOADING,a.CHECKING_DISK,a.UL_FORCED,a.DOWNLOADING,a.META_DOWNLOAD,a.FORCED_META_DOWNLOAD,a.CHECKING_DISK,a.DL_FORCED,a.CHECKING_RESUME_DATA,a.MOVING],H=[a.ERROR,a.MISSING_FILES,a.UNKNOWN],X=[a.ERROR,a.MISSING_FILES,a.UNKNOWN,a.MOVING,a.DL_STOPPED,a.DL_STALLED,a.UL_STOPPED,a.CHECKING_DISK,a.CHECKING_RESUME_DATA];function fe(){C.value=[]}const ge=S(()=>g.value.filter(e=>P.includes(e.state)).length);function Ce(){C.value=P}const De=S(()=>g.value.filter(e=>H.includes(e.state)).length);function Te(){C.value=H}const ye=S(()=>g.value.filter(e=>X.includes(e.state)).length);function be(){C.value=X}function Ee(){l.value=[]}function Se(){T.value=[],r.value=[]}function Ie(){_.value=[],h.value=[]}return(e,n)=>t(ie)||t(ne)||t(re)||t(ue)?(o(),I(Ae,{key:0,class:"pb-0 inherit-fg"},{default:u(()=>[(o(!0),U(q,null,Fe(t(se),y=>(o(),U(q,{key:y.name},[y.name==="state"&&y.active?(o(),I(Z,{key:0,modelValue:t(C),"onUpdate:modelValue":n[0]||(n[0]=m=>x(C)?C.value=m:null),title:t(s)("navbar.side.filters.state.title"),items:oe.value,onDisable:fe},{"prepend-item":u(()=>[c(N,{title:`${t(s)("navbar.side.filters.state.active")} (${ge.value})`,onClick:Ce},null,8,["title"]),c(N,{title:`${t(s)("navbar.side.filters.state.error")} (${De.value})`,onClick:Te},null,8,["title"]),c(N,{title:`${t(s)("navbar.side.filters.state.offline")} (${ye.value})`,onClick:be},null,8,["title"])]),_:1},8,["modelValue","title","items"])):k("",!0),y.name==="category"&&y.active?(o(),I(Z,{key:1,modelValue:t(l),"onUpdate:modelValue":n[1]||(n[1]=m=>x(l)?l.value=m:null),title:t(s)("navbar.side.filters.category.title"),items:ce.value,onDisable:Ee},null,8,["modelValue","title","items"])):k("",!0),y.name==="tag"&&y.active?(o(),I(z,{key:2,include:t(T),"onUpdate:include":n[2]||(n[2]=m=>x(T)?T.value=m:null),exclude:t(r),"onUpdate:exclude":n[3]||(n[3]=m=>x(r)?r.value=m:null),title:t(s)("navbar.side.filters.tag.title"),items:de.value,"filter-type":t(E),onDisable:Se,onToggleFilterType:pe},null,8,["include","exclude","title","items","filter-type"])):k("",!0),y.name==="tracker"&&y.active?(o(),I(z,{key:3,include:t(_),"onUpdate:include":n[4]||(n[4]=m=>x(_)?_.value=m:null),exclude:t(h),"onUpdate:exclude":n[5]||(n[5]=m=>x(h)?h.value=m:null),title:t(s)("navbar.side.filters.tracker.title"),items:ve.value,"filter-type":t(W),onDisable:Ie,onToggleFilterType:me},null,8,["include","exclude","title","items","filter-type"])):k("",!0)],64))),128))]),_:1})):k("",!0)}});export{Pe as default};
