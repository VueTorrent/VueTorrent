import{p as Je}from"./purify.es-HRjpPm7y.js";import{n as e,v as T,D as Qe,t as $e,b as O,x as w,J as be,q as Z,F as M,f as E,a2 as We,u as h,K as b,L as m,O as l,V as U,U as P,R as S,P as F,T as _,$ as Ue,e as N,W as ae,_ as Y,X as Te,Q as ce,r as fe,S as he,H as Pe,Z as ve,a8 as Re}from"./vue-CpUfmXXb.js";import{v as Q,bk as Xe,bh as Ze,bl as Ye,bm as Fe,bn as Ae,f as et,bo as tt,bp as lt,P as at,bq as nt,o as de,bi as st,br as Ee,bs as j,z as H,a_ as pe,ay as ot,bt as it,s as x,t as R,R as rt,d as ut,bu as dt,K as ge,E as K,aP as mt,aJ as I,bv as ct,h as te,j as Le,V as J,k as ne,l as se,n as B,r as Ve,S as oe,bw as ft,p as le,A as ee,B as z,aj as ke,ak as Me,bx as vt,by as pt,aV as Ce,aB as gt}from"./index-sDGVDpHX.js";import{v as Vt}from"./index-BvC1yQtk.js";import{V as we}from"./VPagination-DEjYxMqT.js";import{V as Ne}from"./VForm-C54njCzr.js";import{V as Ie}from"./VEmptyState-T_Z3kBDC.js";import{g as Oe,p as Be,j as me,u as _e,S as kt,R as yt,d as $t}from"./vuetify-BjHTe0sz.js";import{V as bt}from"./VSheet-Ua-y6HMw.js";var L=(t=>(t[t.LOADING=0]="LOADING",t[t.ERROR=1]="ERROR",t[t.UNREAD=2]="UNREAD",t[t.READ=3]="READ",t))(L||{});const ht=Be({inset:Boolean,...Xe({transition:"bottom-sheet-transition"})},"VBottomSheet"),Rt=Oe()({name:"VBottomSheet",props:ht(),emits:{"update:modelValue":t=>!0},setup(t,p){let{slots:f}=p;const n=me(t,"modelValue");return _e(()=>{const a=Q.filterProps(t);return e(Q,T(a,{contentClass:["v-bottom-sheet__content",t.contentClass],modelValue:n.value,"onUpdate:modelValue":c=>n.value=c,class:["v-bottom-sheet",{"v-bottom-sheet--inset":t.inset},t.class],style:t.style}),f)}),{}}}),Ft=Be({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...lt(),...tt()},"VSwitch"),At=Oe()({name:"VSwitch",inheritAttrs:!1,props:Ft(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,p){let{attrs:f,slots:n}=p;const a=me(t,"indeterminate"),c=me(t,"modelValue"),{loaderClasses:r}=Ze(t),{isFocused:d,focus:s,blur:A}=Ye(t),D=O(),$=O(),u=kt&&window.matchMedia("(forced-colors: active)").matches,o=$e(()=>typeof t.loading=="string"&&t.loading!==""?t.loading:t.color),i=Qe(),v=$e(()=>t.id||`switch-${i}`);function g(){a.value&&(a.value=!1)}function C(V){V.stopPropagation(),V.preventDefault(),D.value?.input?.click()}return _e(()=>{const[V,y]=yt(f),k=Fe.filterProps(t),G=Ae.filterProps(t);return e(Fe,T({ref:$,class:["v-switch",{"v-switch--flat":t.flat},{"v-switch--inset":t.inset},{"v-switch--indeterminate":a.value},r.value,t.class]},V,k,{modelValue:c.value,"onUpdate:modelValue":W=>c.value=W,id:v.value,focused:d.value,style:t.style}),{...n,default:W=>{let{id:je,messagesId:qe,isDisabled:ze,isReadonly:He,isValid:ye}=W;const ie={model:c,isValid:ye};return e(Ae,T({ref:D},G,{modelValue:c.value,"onUpdate:modelValue":[X=>c.value=X,g],id:je.value,"aria-describedby":qe.value,type:"checkbox","aria-checked":a.value?"mixed":void 0,disabled:ze.value,readonly:He.value,onFocus:s,onBlur:A},y),{...n,default:X=>{let{backgroundColorClasses:re,backgroundColorStyles:q}=X;return w("div",{class:Z(["v-switch__track",u?void 0:re.value]),style:be(q.value),onClick:C},[n["track-true"]&&w("div",{key:"prepend",class:"v-switch__track-true"},[n["track-true"](ie)]),n["track-false"]&&w("div",{key:"append",class:"v-switch__track-false"},[n["track-false"](ie)])])},input:X=>{let{inputNode:re,icon:q,backgroundColorClasses:Ge,backgroundColorStyles:Ke}=X;return w(M,null,[re,w("div",{class:Z(["v-switch__thumb",{"v-switch__thumb--filled":q||t.loading},t.inset||u?void 0:Ge.value]),style:be(t.inset?void 0:Ke.value)},[n.thumb?e(at,{defaults:{VIcon:{icon:q,size:"x-small"}}},{default:()=>[n.thumb({...ie,icon:q})]}):e(nt,null,{default:()=>[t.loading?e(st,{name:"v-switch",active:!0,color:ye.value===!1?void 0:o.value},{default:ue=>n.loader?n.loader(ue):e(Ee,{active:ue.isActive,color:ue.color,indeterminate:!0,size:"16",width:"2"},null)}):q&&e(de,{key:String(q),icon:q,size:"x-small"},null)]})])])}})}})}),et({},$)}}),Ct={class:"d-flex"},wt={key:0},Dt={key:0},St={key:1},Ut={class:"d-flex flex-column"},Tt=E({__name:"Article",props:{value:{}},emits:["click","markAsRead","open","download"],setup(t){const p=j();return(f,n)=>We((m(),b(H,{"data-custom-context-menu":"",class:Z({"rss-read":t.value.isRead}),onClick:n[3]||(n[3]=a=>f.$emit("click")),onContextmenu:n[4]||(n[4]=a=>f.$emit("markAsRead"))},{default:l(()=>[w("div",Ct,[w("div",null,[e(pe,{class:"d-flex align-center ga-3 wrap-anywhere",style:{"white-space":"unset"}},{default:l(()=>[t.value.isRead?P("",!0):(m(),U("div",wt,[e(ot,{color:"accent",variant:"outlined"},{default:l(()=>[S(F(f.$t("rssArticles.feeds.item.new")),1)]),_:1})])),w("div",null,F(t.value.title),1)]),_:1}),e(it,{class:"d-block mt-3"},{default:l(()=>[w("div",null,F(t.value.parsedDate.toLocaleString()),1),w("div",null,F(f.$t("rssArticles.feeds.item.feedName",{name:h(p).getFeedNames(t.value.id).join(" | ")})),1),t.value.author?(m(),U("div",Dt,F(f.$t("rssArticles.feeds.item.author",{author:t.value.author})),1)):P("",!0),t.value.category?(m(),U("div",St,F(f.$t("rssArticles.feeds.item.category",{category:t.value.category})),1)):P("",!0)]),_:1})]),e(x),w("div",Ut,[e(R,{icon:"mdi-open-in-new",variant:"text",onClick:n[0]||(n[0]=_(a=>f.$emit("open"),["stop"]))}),e(R,{color:"accent",icon:"mdi-check",variant:"text",onClick:n[1]||(n[1]=_(a=>f.$emit("markAsRead"),["stop"]))}),e(R,{icon:"mdi-download",variant:"text",onClick:n[2]||(n[2]=_(a=>f.$emit("download"),["stop"]))})])])]),_:1},8,["class"])),[[h(Vt),()=>f.$emit("markAsRead")]])}}),De=E({__name:"ArticleList",props:{height:{}},emits:["articleClicked"],setup(t){const p=Ue(),f=rt(),n=j(),a=ut(),c=N(()=>p.params.feedId),r=N(()=>n.filteredArticles.filter(o=>!c.value||c.value===o.feedId).sort((o,i)=>Number(i.parsedDate)-Number(o.parsedDate))),{paginatedResults:d,currentPage:s,pageCount:A}=dt(r,15);function D(o){const i=a.useIdForRssLinks?o.id:o.link;mt(i)}function $(o){f.pushTorrentToQueue(o.torrentURL)}async function u(o){await n.markArticleAsRead(o.id)}return(o,i)=>(m(),b(ge,{height:t.height},{default:l(()=>[r.value.length?(m(),b(H,{key:0},{default:l(()=>[e(we,{modelValue:h(s),"onUpdate:modelValue":i[0]||(i[0]=v=>ae(s)?s.value=v:null),length:h(A),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])]),_:1})):P("",!0),(m(!0),U(M,null,Y(h(d),(v,g)=>(m(),U(M,{key:g},[g>0?(m(),b(K,{key:0})):P("",!0),e(Tt,{value:v,onClick:C=>o.$emit("articleClicked",v),onMarkAsRead:C=>u(v),onOpen:C=>D(v),onDownload:C=>$(v)},null,8,["value","onClick","onMarkAsRead","onOpen","onDownload"])],64))),128)),r.value.length===0?(m(),b(H,{key:1},{default:l(()=>[S(F(o.$t("common.emptyList")),1)]),_:1})):P("",!0),r.value.length?(m(),b(H,{key:2},{default:l(()=>[e(we,{modelValue:h(s),"onUpdate:modelValue":i[1]||(i[1]=v=>ae(s)?s.value=v:null),length:h(A),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])]),_:1})):P("",!0)]),_:1},8,["height"]))}}),Pt={class:"mr-2"},xe=E({__name:"FeedIcon",props:{state:{}},setup(t){return(p,f)=>(m(),U("span",Pt,[t.state===h(L).LOADING?(m(),b(Ee,{key:0,size:"24",width:"3",indeterminate:""})):t.state===h(L).ERROR?(m(),b(de,{key:1,icon:"mdi-alert-circle-outline",color:"error"})):t.state===h(L).UNREAD?(m(),b(de,{key:2,icon:"mdi-email"})):P("",!0)]))}}),Et={class:"d-flex align-center"},Lt=E({__name:"Feed",props:{title:{},state:{},unreadCount:{}},emits:["readFeed","refreshFeed","editFeed","deleteFeed"],setup(t){const p=t,f=N(()=>p.state===L.LOADING);return(n,a)=>(m(),U("div",Et,[e(xe,{state:t.state},null,8,["state"]),e(pe,null,{default:l(()=>[S(F(t.title),1)]),_:1}),e(x),e(I,{text:n.$t("rssArticles.feeds.markAsRead"),location:"top"},{activator:l(({props:c})=>[t.unreadCount>0?(m(),b(R,T({key:0},c,{icon:"mdi-email-open",density:"comfortable",variant:"plain",onClick:a[0]||(a[0]=_(r=>n.$emit("readFeed"),["stop"]))}),null,16)):P("",!0)]),_:1},8,["text"]),e(I,{text:n.$t("common.refresh"),location:"top"},{activator:l(({props:c})=>[f.value?P("",!0):(m(),b(R,T({key:0},c,{icon:"mdi-sync",density:"comfortable",variant:"plain",onClick:a[1]||(a[1]=_(r=>n.$emit("refreshFeed"),["stop"]))}),null,16))]),_:1},8,["text"]),e(I,{text:n.$t("common.edit"),location:"top"},{activator:l(({props:c})=>[e(R,T(c,{icon:"mdi-pencil",density:"comfortable",variant:"plain",onClick:a[2]||(a[2]=_(r=>n.$emit("editFeed"),["stop"]))}),null,16)]),_:1},8,["text"]),e(I,{text:n.$t("common.delete"),location:"top"},{activator:l(({props:c})=>[e(R,T(c,{icon:"mdi-delete",color:"red",density:"comfortable",variant:"plain",onClick:a[3]||(a[3]=_(r=>n.$emit("deleteFeed"),["stop"]))}),null,16)]),_:1},8,["text"])]))}}),Mt={class:"d-flex align-center"},Se=E({__name:"FeedList",props:{height:{}},emits:["update","createFeed","editFeed","deleteFeed","refreshFeed"],setup(t,{emit:p}){const f=p,n=Te(),a=j(),c=N({get:()=>n.currentRoute.value.params.feedId,set(i){n.replace({name:"rssArticles",params:{tab:"feeds",feedId:i}}).then(()=>f("update",i))}}),r=ct(()=>a.filteredArticles.map(i=>i.feedId));function d(i){return i?(i.articles??[]).reduce((v,g)=>v+ +!g.isRead,0):a.unreadArticles.length}function s(i){c.value=c.value!==i.uid?i.uid:void 0}async function A(i){await a.markFeedAsRead(i)}async function D(){await a.refreshAllFeeds(),a.fetchFeedsTask.perform()}function $(i){const v=d(i);return(v?`${v} | `:"")+`${i?i.name:"All"}`}const u=N(()=>a.feeds.reduce((i,v)=>Math.min(i,o(v)),L.READ));function o(i){return i.isLoading?L.LOADING:i.hasError?L.ERROR:i.articles?.some(v=>!v.isRead)?L.UNREAD:L.READ}return(i,v)=>(m(),b(ge,{height:t.height},{default:l(()=>[e(H,{active:!c.value,color:"accent",variant:"text",onClick:v[3]||(v[3]=g=>c.value=void 0)},{default:l(()=>[w("div",Mt,[e(xe,{state:u.value},null,8,["state"]),e(pe,null,{default:l(()=>[S(F($()),1)]),_:1}),e(x),e(I,{text:i.$t("rssArticles.feeds.markAllAsRead"),location:"top"},{activator:l(({props:g})=>[d()>0?(m(),b(R,T({key:0},g,{icon:"mdi-email-open",density:"comfortable",variant:"plain",onClick:v[0]||(v[0]=C=>h(a).markAllAsRead())}),null,16)):P("",!0)]),_:1},8,["text"]),e(I,{text:i.$t("rssArticles.feeds.refreshAllFeeds"),location:"top"},{activator:l(({props:g})=>[u.value!==h(L).LOADING?(m(),b(R,T({key:0},g,{icon:"mdi-sync",density:"comfortable",variant:"plain",onClick:v[1]||(v[1]=C=>D())}),null,16)):P("",!0)]),_:1},8,["text"]),e(I,{text:i.$t("rssArticles.feeds.empty.action"),location:"top"},{activator:l(({props:g})=>[e(R,T(g,{icon:"mdi-plus",density:"comfortable",variant:"plain",onClick:v[2]||(v[2]=C=>i.$emit("createFeed"))}),null,16)]),_:1},8,["text"])])]),_:1},8,["active"]),e(K,{thickness:"3"}),(m(!0),U(M,null,Y(h(a).feeds,g=>(m(),U(M,null,[(!h(a).filters.unread||d(g)>0)&&(h(a).filters.title==""||!h(r).length||h(r).includes(g.uid))?(m(),b(H,{key:g.uid,active:c.value===g.uid,class:Z(d(g)>0?"text-accent":""),color:"accent",variant:"text",onClick:C=>s(g)},{default:l(()=>[e(Lt,{title:$(g),state:o(g),"unread-count":d(g),onReadFeed:C=>A(g),onRefreshFeed:C=>i.$emit("refreshFeed",g),onEditFeed:C=>i.$emit("editFeed",g),onDeleteFeed:C=>i.$emit("deleteFeed",g)},null,8,["title","state","unread-count","onReadFeed","onRefreshFeed","onEditFeed","onDeleteFeed"])]),_:2},1032,["active","class","onClick"])):P("",!0)],64))),256))]),_:1},8,["height"]))}}),Nt=E({__name:"RssFeedDialog",props:{guid:{},initialFeed:{}},setup(t){const p=t,{t:f}=te(),{isOpened:n}=Le(p.guid),a=j(),c=O(),r=O(!1),d=fe({name:"",url:""}),s=[u=>!!u||f("dialogs.rss.feed.rules.name_required")],A=[u=>!!u||f("dialogs.rss.feed.rules.url_required")];async function D(){await c.value?.validate(),r.value&&(p.initialFeed?(d.url!==p.initialFeed.url&&await a.setFeedUrl(p.initialFeed.name,d.url),d.name!==p.initialFeed.name&&await a.renameFeed(p.initialFeed.name,d.name)):await a.createFeed(d.name,d.url),await a.fetchFeeds(),$())}function $(){n.value=!1}return ce(()=>{p.initialFeed&&(d.name=p.initialFeed.name,d.url=p.initialFeed.url)}),(u,o)=>(m(),b(Q,{modelValue:h(n),"onUpdate:modelValue":o[4]||(o[4]=i=>ae(n)?n.value=i:null)},{default:l(()=>[e(J,null,{default:l(()=>[e(ne,null,{default:l(()=>[S(F(u.$t(`dialogs.rss.feed.title.${t.initialFeed?"edit":"create"}`)),1)]),_:1}),e(se,null,{default:l(()=>[e(h(Ne),{ref_key:"form",ref:c,modelValue:r.value,"onUpdate:modelValue":o[2]||(o[2]=i=>r.value=i),onSubmit:o[3]||(o[3]=_(()=>{},["prevent"]))},{default:l(()=>[e(B,{modelValue:d.name,"onUpdate:modelValue":o[0]||(o[0]=i=>d.name=i),rules:s,label:u.$t("dialogs.rss.feed.name"),onKeydown:he(D,["enter"])},null,8,["modelValue","label"]),e(B,{modelValue:d.url,"onUpdate:modelValue":o[1]||(o[1]=i=>d.url=i),rules:A,label:u.$t("dialogs.rss.feed.url"),onKeydown:he(D,["enter"])},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(Ve,null,{default:l(()=>[e(x),e(R,{color:"error",onClick:$},{default:l(()=>[S(F(u.$t("common.cancel")),1)]),_:1}),e(R,{color:"accent",disabled:!r.value,onClick:D},{default:l(()=>[S(F(u.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),It=E({__name:"Feeds",props:{height:{},mobile:{type:Boolean}},emits:["openArticle"],setup(t){const p=t,{t:f}=te(),n=oe(),a=j(),c=O(!1),r=N(()=>p.height-56-16-56-24),d=N({get:()=>a.filters.title,set:ft($=>{a.filters.title=$??""},300)});function s($){n.createDialog(Nt,{initialFeed:$},()=>{a.fetchFeedsTask.perform()})}async function A($){await a.refreshFeed($.name),a.fetchFeedsTask.perform()}function D($){n.confirmAction({title:f("dialogs.confirm.deleteFeed"),text:$.name,yesColor:"error",onConfirm:async()=>{await a.deleteFeed($.name),await a.fetchFeedsTask.perform()}})}return Pe(()=>{a.resumeFeedTimer()}),ve(()=>{a.pauseFeedTimer()}),($,u)=>h(a).feeds.length?(m(),b(J,{key:1,id:"rss-articles",class:"pa-3",height:t.height},{default:l(()=>[e(B,{modelValue:d.value,"onUpdate:modelValue":u[1]||(u[1]=o=>d.value=o),label:$.$t("rssArticles.feeds.filters.title"),clearable:"","hide-details":""},null,8,["modelValue","label"]),e(le,{modelValue:h(a).filters.unread,"onUpdate:modelValue":u[2]||(u[2]=o=>h(a).filters.unread=o),label:$.$t("rssArticles.feeds.filters.unread"),"hide-details":""},null,8,["modelValue","label"]),t.mobile?(m(),U(M,{key:0},[e(De,{height:r.value,onArticleClicked:u[3]||(u[3]=o=>$.$emit("openArticle",o))},null,8,["height"]),e(Rt,{modelValue:c.value,"onUpdate:modelValue":u[9]||(u[9]=o=>c.value=o),"max-height":"550"},{activator:l(({props:o})=>[e(R,T({class:"fab"},o,{color:"accent",icon:"mdi-format-list-bulleted",size:"large"}),null,16)]),default:l(()=>[e(Se,{onUpdate:u[4]||(u[4]=o=>c.value=!1),onCreateFeed:u[5]||(u[5]=()=>s()),onEditFeed:u[6]||(u[6]=o=>s(o)),onDeleteFeed:u[7]||(u[7]=o=>D(o)),onRefreshFeed:u[8]||(u[8]=o=>A(o))})]),_:1},8,["modelValue"])],64)):(m(),b(ee,{key:1},{default:l(()=>[e(z,{cols:"4"},{default:l(()=>[e(Se,{height:r.value,onCreateFeed:u[10]||(u[10]=()=>s()),onEditFeed:u[11]||(u[11]=o=>s(o)),onDeleteFeed:u[12]||(u[12]=o=>D(o)),onRefreshFeed:u[13]||(u[13]=o=>A(o))},null,8,["height"])]),_:1}),e(z,{cols:"8"},{default:l(()=>[e(De,{height:r.value,onArticleClicked:u[14]||(u[14]=o=>$.$emit("openArticle",o))},null,8,["height"])]),_:1})]),_:1}))]),_:1},8,["height"])):(m(),b(J,{key:0,height:t.height},{default:l(()=>[e(Ie,{title:$.$t("rssArticles.feeds.empty.value"),icon:"mdi-rss-off"},{actions:l(()=>[e(R,{text:$.$t("rssArticles.feeds.empty.action"),color:"accent",onClick:u[0]||(u[0]=o=>s())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))}}),Ot={class:"pl-4"},Bt=E({__name:"Rule",props:{value:{}},emits:["openRule"],setup(t){const{t:p}=te(),f=oe(),n=j();async function a(r){await n.setRule(r.name,{...r,enabled:!r.enabled}),n.fetchRulesTask.perform()}function c(r){f.confirmAction({title:p("dialogs.confirm.deleteRule"),text:r.name,yesColor:"error",onConfirm:async()=>{await n.deleteRule(r.name),await n.fetchRulesTask.perform()}})}return(r,d)=>(m(),b(bt,{rounded:"xl",class:"d-flex align-center"},{default:l(()=>[w("div",Ot,F(t.value.name),1),e(x),w("div",null,[e(R,{class:"my-2 mr-2",icon:t.value.enabled?"mdi-check":"mdi-cancel",color:t.value.enabled?"accent":"red",variant:"plain",density:"compact",onClick:d[0]||(d[0]=s=>a(t.value))},null,8,["icon","color"]),e(I,{text:r.$t("common.edit"),location:"top"},{activator:l(({props:s})=>[e(R,T(s,{class:"my-2 mr-2",icon:"mdi-pencil",variant:"plain",density:"compact",onClick:d[1]||(d[1]=A=>r.$emit("openRule",t.value))}),null,16)]),_:1},8,["text"]),e(I,{text:r.$t("common.delete"),location:"top"},{activator:l(({props:s})=>[e(R,T(s,{class:"my-2 mr-2",icon:"mdi-delete",color:"red",variant:"plain",density:"compact",onClick:d[2]||(d[2]=A=>c(t.value))}),null,16)]),_:1},8,["text"])])]),_:1}))}}),_t=E({__name:"AddTorrentParamsDialog",props:{modelValue:{required:!0},modelModifiers:{},isOpened:{type:Boolean},isOpenedModifiers:{}},emits:["update:modelValue","update:isOpened"],setup(t){const p=Re(t,"modelValue"),f=Re(t,"isOpened"),{t:n}=te(),a=O();function c(){a.value?.saveFields(),f.value=!1}return(r,d)=>(m(),b(Q,{modelValue:f.value,"onUpdate:modelValue":d[1]||(d[1]=s=>f.value=s),class:Z(r.$vuetify.display.mobile?"":"w-75"),fullscreen:r.$vuetify.display.mobile,scrollable:""},{default:l(()=>[e(J,null,{default:l(()=>[e(ne,{class:"ios-margin"},{default:l(()=>[e(ke,{color:"transparent"},{default:l(()=>[e(Me,null,{default:l(()=>[S(F(h(n)("dialogs.add.params.title")),1)]),_:1}),e(R,{icon:"mdi-close",onClick:c})]),_:1})]),_:1}),e(se,null,{default:l(()=>[e(vt,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=s=>p.value=s)},null,8,["modelValue"])]),_:1}),e(Ve,{class:"mb-2"},{default:l(()=>[e(x),e(R,{text:r.$t("common.close"),color:"",variant:"flat",onClick:c},null,8,["text"])]),_:1})]),_:1})]),_:1},8,["modelValue","class","fullscreen"]))}});function xt(t){return{save_path:t?.save_path??"",skip_checking:!1,add_to_top_of_queue:t?.add_to_top_of_queue??!1,content_layout:t?.torrent_content_layout,stop_condition:t?.torrent_stop_condition,download_limit:t?.dl_limit,upload_limit:t?.up_limit,use_download_path:!!t?.temp_path,download_path:t?.temp_path?t?.temp_path:"",stopped:t?.add_stopped_enabled??t?.start_paused_enabled,use_auto_tmm:t?.auto_tmm_enabled,ratio_limit:-2,seeding_time_limit:-2,inactive_seeding_time_limit:-2}}const jt={class:"d-flex"},qt={class:"d-flex align-center"},zt={class:"v-card-title pa-0"},Ht=E({__name:"RssRuleDialog",props:{guid:{},initialRule:{}},setup(t){const p=t,f=N(()=>!!(p.initialRule&&p.initialRule.name)),{isOpened:n}=Le(p.guid),{t:a}=te(),c=pt(),r=j(),d=O(!1),s=fe(u()),A=O(""),D=O([]),$=N(()=>{if(s.lastMatch==="")return a("dialogs.rss.rule.lastMatch.unknownValue").toString();const V=new Date().getTime()-new Date(s.lastMatch).getTime();return a("dialogs.rss.rule.lastMatch.knownValue",Math.floor(V/(1e3*60*60*24)))});function u(){return{affectedFeeds:[],enabled:!0,episodeFilter:"",ignoreDays:0,lastMatch:"",mustContain:"",mustNotContain:"",name:"",priority:0,smartFilter:!1,useRegex:!1,previouslyMatchedEpisodes:f.value?p.initialRule.previouslyMatchedEpisodes:[],torrentParams:xt(c.preferences)}}async function o(){if(A.value==="")return;const V=[],y=await r.fetchMatchingArticles(A.value);for(const k in y){const G=y[k];V.length>0&&V.push({type:"divider"}),V.push({type:"subheader",value:k}),G.forEach(W=>V.push({type:"item",value:W}))}D.value=V}async function i(){d.value&&((f.value||A.value!=="")&&A.value!==s.name&&await r.renameRule(A.value,s.name),await r.setRule(s.name,s),A.value=s.name,await r.fetchRules(),await o())}function v(){s.affectedFeeds=[]}function g(){s.affectedFeeds=r.feeds.map(V=>V.url)}function C(){n.value=!1}return ce(async()=>{await r.fetchFeeds(),f.value&&(A.value=p.initialRule.name,Object.assign(s,p.initialRule)),await o()}),(V,y)=>(m(),b(Q,{modelValue:h(n),"onUpdate:modelValue":y[13]||(y[13]=k=>ae(n)?n.value=k:null)},{default:l(()=>[e(J,null,{default:l(()=>[e(ne,null,{default:l(()=>[e(ke,{color:"transparent",title:V.$t(`dialogs.rss.rule.title.${t.initialRule?"edit":"create"}`)},{default:l(()=>[e(R,{icon:"mdi-close",onClick:C})]),_:1},8,["title"])]),_:1}),e(se,null,{default:l(()=>[e(h(Ne),{ref:"form",modelValue:d.value,"onUpdate:modelValue":y[11]||(y[11]=k=>d.value=k),onSubmit:y[12]||(y[12]=_(()=>{},["prevent"]))},{default:l(()=>[e(ee,null,{default:l(()=>[e(z,{cols:"12",sm:"6",class:"scrollable-col"},{default:l(()=>[e(B,{modelValue:s.name,"onUpdate:modelValue":y[0]||(y[0]=k=>s.name=k),autofocus:"",required:"",label:V.$t("dialogs.rss.rule.name")},null,8,["modelValue","label"]),w("div",jt,[e(At,{modelValue:s.enabled,"onUpdate:modelValue":y[1]||(y[1]=k=>s.enabled=k),color:"accent",inset:"","hide-details":"",label:V.$t("dialogs.rss.rule.enabled")},null,8,["modelValue","label"]),e(x),w("div",qt,[e(R,{class:"d-flex align-center justify-center",color:"accent"},{default:l(()=>[S(F(V.$t("dialogs.add.params.title"))+" ",1),e(_t,{modelValue:s.torrentParams,"onUpdate:modelValue":y[2]||(y[2]=k=>s.torrentParams=k),activator:"parent"},null,8,["modelValue"])]),_:1})])]),e(K),e(le,{modelValue:s.useRegex,"onUpdate:modelValue":y[3]||(y[3]=k=>s.useRegex=k),"hide-details":"",label:V.$t("dialogs.rss.rule.useRegex")},null,8,["modelValue","label"]),e(B,{modelValue:s.mustContain,"onUpdate:modelValue":y[4]||(y[4]=k=>s.mustContain=k),label:V.$t("dialogs.rss.rule.mustContain")},null,8,["modelValue","label"]),e(B,{modelValue:s.mustNotContain,"onUpdate:modelValue":y[5]||(y[5]=k=>s.mustNotContain=k),label:V.$t("dialogs.rss.rule.mustNotContain")},null,8,["modelValue","label"]),e(le,{modelValue:s.smartFilter,"onUpdate:modelValue":y[6]||(y[6]=k=>s.smartFilter=k),"hide-details":"",label:V.$t("dialogs.rss.rule.smartFilter")},null,8,["modelValue","label"]),e(B,{modelValue:s.episodeFilter,"onUpdate:modelValue":y[7]||(y[7]=k=>s.episodeFilter=k),placeholder:V.$t("dialogs.rss.rule.episodeFilterPlaceholder"),label:V.$t("dialogs.rss.rule.episodeFilter")},null,8,["modelValue","placeholder","label"]),e(K,{class:"mb-4"}),e(B,{modelValue:s.ignoreDays,"onUpdate:modelValue":y[8]||(y[8]=k=>s.ignoreDays=k),modelModifiers:{number:!0},type:"number",hint:V.$t("dialogs.rss.rule.ignoreDaysHint"),label:V.$t("dialogs.rss.rule.ignoreDays")},null,8,["modelValue","hint","label"]),e(B,{modelValue:$.value,"onUpdate:modelValue":y[9]||(y[9]=k=>$.value=k),disabled:"",label:V.$t("dialogs.rss.rule.lastMatch.label")},null,8,["modelValue","label"]),e(K),e(Ce,null,{default:l(()=>[S(F(V.$t("dialogs.rss.rule.affectedFeedsSubheader")),1)]),_:1}),e(ee,null,{default:l(()=>[e(z,{cols:"6",class:"d-flex align-center justify-center"},{default:l(()=>[e(R,{color:"accent",onClick:g},{default:l(()=>[S(F(V.$t("common.selectAll")),1)]),_:1})]),_:1}),e(z,{cols:"6",class:"d-flex align-center justify-center"},{default:l(()=>[e(R,{color:"primary",onClick:v},{default:l(()=>[S(F(V.$t("common.selectNone")),1)]),_:1})]),_:1})]),_:1}),(m(!0),U(M,null,Y(h(r).feeds,k=>(m(),b(le,{key:k.uid,modelValue:s.affectedFeeds,"onUpdate:modelValue":y[10]||(y[10]=G=>s.affectedFeeds=G),multiple:"","hide-details":"",label:k.name,value:k.url},null,8,["modelValue","label","value"]))),128))]),_:1}),e(K,{vertical:!V.$vuetify.display.mobile},null,8,["vertical"]),e(z,{cols:"12",sm:"6",class:"scrollable-col"},{default:l(()=>[w("div",zt,F(V.$t("dialogs.rss.rule.matchingArticles.title")),1),e(ge,null,{default:l(()=>[(m(!0),U(M,null,Y(D.value,(k,G)=>(m(),U(M,{key:G},[k.type==="divider"?(m(),b(K,{key:0})):k.type==="subheader"?(m(),b(Ce,{key:1,inset:""},{default:l(()=>[S(F(k.value),1)]),_:2},1024)):(m(),b(H,{key:2,class:"mb-3"},{default:l(()=>[S(F(k.value),1)]),_:2},1024))],64))),128)),D.value.length===0?(m(),b(H,{key:0,title:V.$t("dialogs.rss.rule.matchingArticles.noMatch")},null,8,["title"])):P("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Ve,null,{default:l(()=>[e(x),e(R,{color:"error",onClick:C},{default:l(()=>[S(F(V.$t("common.close")),1)]),_:1}),e(R,{color:"accent",onClick:i},{default:l(()=>[S(F(V.$t("common.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Gt=gt(Ht,[["__scopeId","data-v-afe1e764"]]),Kt={key:1,id:"rss-rules",class:"pa-3"},Jt=E({__name:"Rules",props:{height:{}},setup(t){const p=oe(),f=j();function n(a){p.createDialog(Gt,{initialRule:a},()=>{f.fetchRulesTask.perform()})}return ce(()=>{f.resumeRuleTimer()}),ve(()=>{f.pauseRuleTimer()}),(a,c)=>h(f).rules.length?(m(),U("div",Kt,[e(ee,{class:"mt-2"},{default:l(()=>[(m(!0),U(M,null,Y(h(f).rules,r=>(m(),b(z,{key:r.name,cols:"12",sm:"6",lg:"3"},{default:l(()=>[e(Bt,{value:r,onOpenRule:n},null,8,["value"])]),_:2},1024))),128))]),_:1}),e(ee,null,{default:l(()=>[e(z,{cols:"12",class:"d-flex align-center justify-center"},{default:l(()=>[e(R,{color:"accent",onClick:c[1]||(c[1]=r=>n())},{default:l(()=>[S(F(a.$t("rssArticles.rules.empty.action")),1)]),_:1})]),_:1})]),_:1})])):(m(),b(J,{key:0,height:t.height},{default:l(()=>[e(Ie,{title:a.$t("rssArticles.rules.empty.value"),icon:"mdi-rss-off"},{actions:l(()=>[e(R,{text:a.$t("rssArticles.rules.empty.action"),color:"accent",onClick:c[0]||(c[0]=r=>n())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))}}),Qt={class:"pa-3"},Wt={class:"d-flex align-center"},Xt={class:"text-h5 ml-2"},Zt={class:"d-flex justify-end"},Yt=["innerHTML"],ul=E({__name:"RssArticles",setup(t){const{height:p,mobile:f}=$t({mobileBreakpoint:"md"}),n=Ue(),a=Te(),c=oe(),r=j(),d=O(!1),s=fe({title:"",content:""}),A=N(()=>n.params.tab!=="rules"),D=N(()=>p.value-64-24-48);function $(v){v.description&&(s.title=v.title.trim(),s.content=v.description.trim(),d.value=!0)}function u(){const v=n.params.tab==="rules"?"feeds":"rules";a.replace({name:"rssArticles",params:{tab:v}}).then(()=>r.lastView=v)}function o(){a.push({name:"dashboard"})}function i(v){if(c.hasActiveDialog||d.value)return!1;v.key==="Escape"&&o()}return Pe(()=>{document.addEventListener("keydown",i)}),ve(()=>{document.removeEventListener("keydown",i)}),(v,g)=>(m(),U(M,null,[w("div",Qt,[w("div",Wt,[w("div",Xt,F(A.value?v.$t("rssArticles.feeds.title"):v.$t("rssArticles.rules.title")),1),e(x),w("div",Zt,[e(I,{text:v.$t(A.value?"rssArticles.toggle.rules":"rssArticles.toggle.feeds"),location:"top"},{activator:l(({props:C})=>[e(R,T({icon:"mdi-auto-download"},C,{variant:"plain",onClick:g[0]||(g[0]=V=>u())}),null,16)]),_:1},8,["text"]),e(R,{icon:"mdi-close",variant:"plain",onClick:g[1]||(g[1]=C=>o())})])]),A.value?(m(),b(It,{key:0,height:D.value,mobile:h(f),onOpenArticle:$},null,8,["height","mobile"])):(m(),b(Jt,{key:1,height:D.value},null,8,["height"]))]),e(Q,{modelValue:d.value,"onUpdate:modelValue":g[3]||(g[3]=C=>d.value=C)},{default:l(()=>[e(J,null,{default:l(()=>[e(ne,null,{default:l(()=>[e(ke,{color:"transparent"},{default:l(()=>[e(Me,null,{default:l(()=>[S(F(s.title),1)]),_:1}),e(R,{icon:"mdi-close",onClick:g[2]||(g[2]=C=>d.value=!1)})]),_:1})]),_:1}),e(se,null,{default:l(()=>[w("div",{class:"description-container",innerHTML:h(Je).sanitize(s.content)},null,8,Yt)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});export{ul as default};
