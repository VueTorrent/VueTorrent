import{a3 as ie,b as F,f as E,e as _,r as L,M as P,$ as J,I,J as $,L as a,m as e,N as M,O as b,u as r,Q as B,T as K,R as se,_ as re,U as ue,V as de,y as ce,S as me,x as N}from"./vue-DYe3GjIu.js";import{ah as pe,a2 as R,c as z,u as H,d as q,e as Q,J as W,K as G,k as x,f as X,g as fe,r as A,q as w,V as T,ao as Z,i as ee,l as te,t as ke,ag as ge,F as ve,o as Ve,aj as De,s as Y,j as xe,w as Ce,a3 as ye,a8 as we,C as be}from"./index-BQJBRxbR.js";import{a as he}from"./vuetify-tIkuDxYg.js";class U{domain;path;name;value;expirationDate;constructor(u){this.domain=u.domain,this.path=u.path,this.name=u.name,this.value=u.value,this.expirationDate=u.expirationDate}equals(u){return this.name===u?.name&&this.domain===u.domain&&this.path===u.path}}const O=ie("cookies",()=>{const V=F([]),u=pe(function*(){yield D()}).drop();async function D(){V.value=(await R.getCookies()).map(t=>new U(t))}async function o(){await R.setCookies(V.value),u.perform()}async function m(t,g=!1){V.value.push(t),g&&await o()}async function C(t,g=!1){V.value=V.value.filter(v=>!v.equals(t)),g&&await o()}async function f(t=!1){V.value=[],t&&await o()}async function k(t,g=!1){t.forEach(v=>{C(v),m(v)}),g&&await o()}return{cookies:V,cookiesFetchTask:u,addCookie:m,removeCookie:C,clearCookies:f,importCookies:k}}),_e=E({__name:"CookieFormDialog",props:{guid:{},initialCookie:{}},setup(V){const u=V,{isOpened:D}=z(u.guid),{t:o}=H(),m=O(),C=_(()=>!!u.initialCookie),f=[()=>{const d=m.cookies.filter(i=>i.equals(t));return!C.value&&d.length!==0||C.value&&d.length>0&&!u.initialCookie.equals(t)?o("dialogs.cookiesManager.rules.duplicate"):!0}],k=F(!1),t=L(new U({name:"",value:"",domain:"",path:"",expirationDate:0})),g=_({get:()=>new Date(t.expirationDate*1e3).toDateString(),set:d=>{const i=new Date(t.expirationDate*1e3),y=new Date(d);i.setFullYear(y.getFullYear()),i.setMonth(y.getMonth()),i.setDate(y.getDate()),t.expirationDate=i.getTime()/1e3}}),v=_({get:()=>{const d=new Date(t.expirationDate*1e3);return`${d.getHours()}:${d.getMinutes()}:${d.getSeconds()}`},set:d=>{const i=new Date(t.expirationDate*1e3),[y,s,n]=d.split(":");i.setHours(+y),i.setMinutes(+s),i.setSeconds(+n),t.expirationDate=i.getTime()/1e3}});async function S(){k.value&&(C.value&&await m.removeCookie(u.initialCookie),await m.addCookie(t,!0),h())}const h=()=>{D.value=!1};return P(()=>{if(C.value)Object.assign(t,u.initialCookie);else{const d=new Date;d.setMilliseconds(0),d.setFullYear(new Date().getFullYear()+1),t.expirationDate=d.getTime()/1e3}}),(d,i)=>{const y=J("v-time-picker");return $(),I(te,{modelValue:r(D),"onUpdate:modelValue":i[8]||(i[8]=s=>K(D)?D.value=s:null),"max-width":"1250"},{default:a(()=>[e(q,null,{default:a(()=>[e(Q,{class:"ios-margin"},{default:a(()=>[e(W,{color:"transparent"},{default:a(()=>[e(G,null,{default:a(()=>[M(b(r(o)("dialogs.cookiesManager.title")),1)]),_:1}),e(x,{icon:"mdi-close",onClick:h})]),_:1})]),_:1}),e(X,null,{default:a(()=>[e(fe,{modelValue:k.value,"onUpdate:modelValue":i[6]||(i[6]=s=>k.value=s),onSubmit:i[7]||(i[7]=B(()=>{},["prevent"]))},{default:a(()=>[e(A,null,{default:a(()=>[e(w,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:t.domain,"onUpdate:modelValue":i[0]||(i[0]=s=>t.domain=s),label:r(o)("dialogs.cookiesManager.domain")},null,8,["modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:t.path,"onUpdate:modelValue":i[1]||(i[1]=s=>t.path=s),label:r(o)("dialogs.cookiesManager.path")},null,8,["modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:t.name,"onUpdate:modelValue":i[2]||(i[2]=s=>t.name=s),label:r(o)("dialogs.cookiesManager.name"),rules:f},null,8,["modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:t.value,"onUpdate:modelValue":i[3]||(i[3]=s=>t.value=s),label:r(o)("dialogs.cookiesManager.value")},null,8,["modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:a(()=>[e(Z,{modelValue:g.value,"onUpdate:modelValue":i[4]||(i[4]=s=>g.value=s),min:new Date},null,8,["modelValue","min"])]),_:1}),e(w,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:a(()=>[e(y,{modelValue:v.value,"onUpdate:modelValue":i[5]||(i[5]=s=>v.value=s),format:"24hr","use-seconds":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ee,null,{default:a(()=>[e(x,{disabled:!k.value,color:"accent",onClick:S},{default:a(()=>[M(b(r(o)("common.submit")),1)]),_:1},8,["disabled"]),e(x,{color:"error",onClick:h},{default:a(()=>[M(b(r(o)("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Me=E({__name:"CookieImportDialog",props:{guid:{}},setup(V){const u=V,{isOpened:D}=z(u.guid),{t:o}=H(),m=O(),C=[{title:o("dialogs.cookiesImport.type.netscape"),value:0,props:{prependIcon:"mdi-table"}},{title:o("dialogs.cookiesImport.type.json"),value:1,props:{prependIcon:"mdi-code-json"}},{title:o("dialogs.cookiesImport.type.header"),value:2,props:{prependIcon:"mdi-text-long"}}],f=F(0),k=F(""),t=L({domain:"",path:"",expirationDate:0}),g=F(!1),v=_({get:()=>new Date(t.expirationDate*1e3).toDateString(),set:n=>{const l=new Date(t.expirationDate*1e3),p=new Date(n);l.setFullYear(p.getFullYear()),l.setMonth(p.getMonth()),l.setDate(p.getDate()),t.expirationDate=l.getTime()/1e3}}),S=_({get:()=>{const n=new Date(t.expirationDate*1e3);return`${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`},set:n=>{const l=new Date(t.expirationDate*1e3),[p,c,j]=n.split(":");l.setHours(+p),l.setMinutes(+c),l.setSeconds(+j),t.expirationDate=l.getTime()/1e3}});function h(){const n=JSON.parse(k.value);return Array.isArray(n)?n.map(l=>new U(l)):[new U(n)]}function d(){const n=[],l=k.value.split(`
`);for(const p of l){if(!p||p.startsWith("#"))continue;const c=p.split("	");if(c.length!==7)continue;const[j,,ae,,oe,le,ne]=c;n.push(new U({domain:j.trim(),path:ae.trim(),name:le.trim(),value:decodeURIComponent(ne.trim()),expirationDate:parseInt(oe.trim(),10)}))}return n}function i(){return k.value.split(";").map(n=>{const[l,p]=n.split("=");return new U({domain:t.domain,path:t.path,name:l.trim(),value:p.trim(),expirationDate:t.expirationDate})})}async function y(){g.value=!0;try{let n;switch(f.value){case 1:n=h();break;case 0:n=d();break;case 2:n=i();break}await m.importCookies(n,!0)}catch(n){re.error(n),g.value=!1}g.value&&s()}const s=()=>{D.value=!1};return(n,l)=>{const p=J("v-time-picker");return $(),I(te,{modelValue:r(D),"onUpdate:modelValue":l[6]||(l[6]=c=>K(D)?D.value=c:null),"max-width":"1250"},{default:a(()=>[e(q,null,{default:a(()=>[e(Q,{class:"ios-margin"},{default:a(()=>[e(W,{color:"transparent"},{default:a(()=>[e(G,null,{default:a(()=>[M(b(r(o)("dialogs.cookiesImport.title")),1)]),_:1}),e(x,{icon:"mdi-close",onClick:s})]),_:1})]),_:1}),e(X,null,{default:a(()=>[e(ke,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=c=>f.value=c),items:C,label:r(o)("dialogs.cookiesImport.type.label")},null,8,["modelValue","label"]),e(ge,{modelValue:k.value,"onUpdate:modelValue":l[1]||(l[1]=c=>k.value=c),label:r(o)("dialogs.cookiesImport.input")},null,8,["modelValue","label"]),f.value===2?($(),I(A,{key:0},{default:a(()=>[e(w,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:t.domain,"onUpdate:modelValue":l[2]||(l[2]=c=>t.domain=c),label:r(o)("dialogs.cookiesManager.domain")},null,8,["modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:t.path,"onUpdate:modelValue":l[3]||(l[3]=c=>t.path=c),label:r(o)("dialogs.cookiesManager.path")},null,8,["modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:a(()=>[e(Z,{modelValue:v.value,"onUpdate:modelValue":l[4]||(l[4]=c=>v.value=c),min:new Date},null,8,["modelValue","min"])]),_:1}),e(w,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:a(()=>[e(p,{modelValue:S.value,"onUpdate:modelValue":l[5]||(l[5]=c=>S.value=c),format:"24hr","use-seconds":""},null,8,["modelValue"])]),_:1})]),_:1})):se("",!0)]),_:1}),e(ee,null,{default:a(()=>[e(x,{color:"accent",onClick:y},{default:a(()=>[M(b(r(o)("common.submit")),1)]),_:1}),e(x,{color:"error",onClick:s},{default:a(()=>[M(b(r(o)("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Se={class:"pa-3"},Te={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"},Ue={class:"d-flex justify-end"},$e={class:"d-flex align-center flex-gap"},Ne=E({__name:"CookiesManager",setup(V){const{height:u}=he(),D=ue(),{t:o}=H(),m=O(),{cookies:C}=de(m),f=ve(),k=Ve(),t=_(()=>u.value-64-12*2-48),g=_(()=>[{title:o("cookiesManager.table.domain"),key:"domain"},{title:o("cookiesManager.table.path"),key:"path"},{title:o("cookiesManager.table.name"),key:"name"},{title:o("cookiesManager.table.value"),key:"value",cellProps:{class:"wrap-anywhere"}},{title:o("cookiesManager.table.expiration_date"),key:"expirationDate"},{key:"actions",sortable:!1,nowrap:!0}]);function v(s){f.createDialog(_e,{initialCookie:s},m.cookiesFetchTask.perform)}function S(){f.createDialog(Me,{},m.cookiesFetchTask.perform)}function h(s){f.confirmAction({title:o("dialogs.confirm.deleteCookie"),text:`Domain: ${s.domain}
Path: ${s.path}
Name: ${s.name}`,yesColor:"error",onConfirm:async()=>{await m.removeCookie(s,!0)}})}function d(){f.confirmAction({title:o("dialogs.confirm.clearCookies"),yesColor:"error",onConfirm:async()=>{await m.clearCookies(!0)}})}const i=()=>{D.push({name:"dashboard"})};function y(s){if(f.hasActiveDialog)return!1;s.key==="Escape"&&(s.preventDefault(),i())}return P(async()=>{document.addEventListener("keydown",y),m.cookiesFetchTask.perform()}),ce(()=>{document.removeEventListener("keydown",y)}),(s,n)=>($(),me("div",Se,[e(A,{"no-gutters":"",align:"center",justify:"center"},{default:a(()=>[e(w,null,{default:a(()=>[N("h1",Te,b(r(o)("cookiesManager.title")),1)]),_:1}),e(w,null,{default:a(()=>[N("div",Ue,[e(x,{icon:"mdi-close",variant:"plain",onClick:i})])]),_:1})]),_:1}),r(C).length?($(),I(be,{key:1},{default:a(()=>[e(Y,null,{default:a(()=>[N("div",$e,[e(xe),e(x,{color:"accent","prepend-icon":"mdi-plus",text:r(o)("cookiesManager.create"),onClick:n[1]||(n[1]=l=>v())},null,8,["text"]),e(x,{color:"accent","prepend-icon":"mdi-import",text:r(o)("cookiesManager.import"),onClick:n[2]||(n[2]=l=>S())},null,8,["text"]),e(x,{color:"error","prepend-icon":"mdi-delete",text:r(o)("cookiesManager.clear"),onClick:n[3]||(n[3]=l=>d())},null,8,["text"])])]),_:1}),e(Ce,{class:"my-3"}),e(Y,{class:"text-select"},{default:a(()=>[e(ye,{"header-props":{class:"text-no-wrap"},mobile:null,headers:g.value,items:r(C),"multi-sort":"","footer-props":{itemsPerPageOptions:[10,25,50,100,-1]}},{"item.expirationDate":a(({value:l})=>[M(b(r(we)(l,r(k).dateFormat)),1)]),"item.actions":a(({item:l})=>[e(x,{icon:"mdi-pencil",variant:"text",density:"compact",onClick:B(p=>v(l),["stop"])},null,8,["onClick"]),e(x,{color:"red",icon:"mdi-delete",variant:"text",density:"compact",onClick:B(p=>h(l),["stop"])},null,8,["onClick"])]),_:2},1032,["headers","items"])]),_:1})]),_:1})):($(),I(q,{key:0,height:t.value},{default:a(()=>[e(De,{title:r(o)("cookiesManager.empty.value"),color:"accent",icon:"mdi-cookie-off"},{actions:a(()=>[e(x,{text:r(o)("cookiesManager.empty.action"),color:"accent",onClick:n[0]||(n[0]=l=>v())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))]))}});export{Ne as default};
