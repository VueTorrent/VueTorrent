import{b as oe,s as te,e as k,k as re,I as Ae,n as c,y as H,F as ae,v as U,N as Ge,q as We,S as Ne,f as we,a5 as fe,a6 as Ee,J as R,K as T,M as x,Q as X,a8 as qe,u as o,W as j,V as M,a2 as He,Z as le,$ as Je,X as J}from"./vue-BP8Ys_mB.js";import{v as ze}from"./index-B0yD57ya.js";import{aY as Xe,aP as je,aZ as Qe,aS as Ze,a_ as Ye,V as Le,a as me,ai as et,Q as Pe,H as A,ak as tt,K as $e,a$ as lt,b0 as at,J as nt,b1 as ut,aq as st,W as it,f as ot,aQ as rt,b2 as ct,aU as vt,b3 as dt,o as Ue,b4 as Ke,az as ft,b5 as z,b6 as w,b7 as mt,av as de,p as pt,C as gt,ag as yt,b8 as ht,b9 as bt,ah as f,ba as ce}from"./index-BLBNWONw.js";import{g as Ct,p as kt,i as Vt,h as Fe,w as St,r as Dt,a as xt,s as Tt,t as It,q as Ft,v as Oe,x as Et,y as Re}from"./vuetify-B343E58S.js";function ve(e,d){let n=0;for(;n<e.length;)e[n]===d?e.splice(n,1):++n;return e}const Nt=kt({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...vt({filterKeys:["title"]}),...ct(),...Ft(dt({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...rt({transition:!1})},"VAutocomplete"),Be=Ct()({name:"VAutocomplete",props:Nt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,d){let{slots:n}=d;const{t:F}=Vt(),m=oe(),p=te(!1),g=te(!0),V=te(!1),L=oe(),S=oe(),l=te(-1),{items:E,transformIn:b,transformOut:$}=Xe(e),{textColorClasses:_,textColorStyles:P}=je(()=>m.value?.color),y=Fe(e,"search",""),r=Fe(e,"modelValue",[],t=>b(t===null?[null]:St(t)),t=>{const s=$(t);return e.multiple?s:s[0]??null}),pe=k(()=>typeof e.counterValue=="function"?e.counterValue(r.value):typeof e.counterValue=="number"?e.counterValue:r.value.length),K=Qe(e),{filteredItems:Q,getMatches:ge}=Ze(e,E,()=>g.value?"":y.value),N=k(()=>e.hideSelected?Q.value.filter(t=>!r.value.some(s=>s.value===t.value)):Q.value),B=k(()=>!!(e.chips||n.chip)),O=k(()=>B.value||!!n.selection),ye=k(()=>r.value.map(t=>t.props.value)),Z=k(()=>(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&y.value===N.value[0]?.title)&&N.value.length>0&&!g.value&&!V.value),G=k(()=>e.hideNoData&&!N.value.length||K.isReadonly.value||K.isDisabled.value),W=Fe(e,"menu"),h=k({get:()=>W.value,set:t=>{W.value&&!t&&L.value?.Î¨openChildren.size||t&&G.value||(W.value=t)}}),ne=k(()=>h.value?e.closeText:e.openText),q=oe(),ue=Ye(q,m);function se(t){e.openOnClear&&(h.value=!0),y.value=""}function he(){G.value||(h.value=!0)}function be(t){G.value||(p.value&&(t.preventDefault(),t.stopPropagation()),h.value=!h.value)}function Ce(t){(Oe(t)||t.key==="Backspace")&&m.value?.focus()}function ke(t){if(K.isReadonly.value)return;const s=m.value?.selectionStart,C=r.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(h.value=!0),["Escape"].includes(t.key)&&(h.value=!1),Z.value&&["Enter","Tab"].includes(t.key)&&!r.value.some(i=>{let{value:u}=i;return u===N.value[0].value})&&v(N.value[0]),t.key==="ArrowDown"&&Z.value&&q.value?.focus("next"),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&O.value&&r.value.length>0&&!y.value)return v(r.value[0],!1);if(~l.value){t.preventDefault();const i=l.value;v(r.value[l.value],!1),l.value=i>=C-1?C-2:i}else t.key==="Backspace"&&!y.value&&(l.value=C-1);return}if(e.multiple)if(t.key==="ArrowLeft"){if(l.value<0&&s&&s>0)return;const i=l.value>-1?l.value-1:C-1;if(r.value[i])l.value=i;else{const u=y.value?.length??null;l.value=-1,m.value?.setSelectionRange(u,u)}}else if(t.key==="ArrowRight"){if(l.value<0)return;const i=l.value+1;r.value[i]?l.value=i:(l.value=-1,m.value?.setSelectionRange(0,0))}else~l.value&&Oe(t)&&(l.value=-1)}function Ve(t){if(Re(m.value,":autofill")||Re(m.value,":-webkit-autofill")){const s=E.value.find(C=>C.title===t.target.value);s&&v(s)}}function Se(){e.eager&&S.value?.calculateVisibleItems()}function De(){p.value&&(g.value=!0,m.value?.focus())}function xe(t){p.value=!0,setTimeout(()=>{V.value=!0})}function Te(t){V.value=!1}function Ie(t){(t==null||t===""&&!e.multiple&&!O.value)&&(r.value=[])}const a=te(!1);function v(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!t||t.props.disabled))if(e.multiple){const C=r.value.findIndex(u=>(e.valueComparator||Et)(u.value,t.value)),i=s??!~C;if(~C){const u=i?[...r.value,t]:[...r.value];u.splice(C,1),r.value=u}else i&&(r.value=[...r.value,t]);e.clearOnSelect&&(y.value="")}else{const C=s!==!1;r.value=C?[t]:[],y.value=C&&!O.value?t.title:"",Ae(()=>{h.value=!1,g.value=!0})}}return re(p,(t,s)=>{t!==s&&(t?(a.value=!0,y.value=e.multiple||O.value?"":String(r.value.at(-1)?.props.title??""),g.value=!0,Ae(()=>a.value=!1)):(!e.multiple&&y.value==null&&(r.value=[]),h.value=!1,(e.multiple||O.value)&&(y.value=""),l.value=-1))}),re(y,t=>{!p.value||a.value||(t&&(h.value=!0),g.value=!t)}),re(h,()=>{if(!e.hideSelected&&h.value&&r.value.length){const t=N.value.findIndex(s=>r.value.some(C=>s.value===C.value));Dt&&window.requestAnimationFrame(()=>{t>=0&&S.value?.scrollToIndex(t)})}}),re(()=>e.items,(t,s)=>{h.value||p.value&&!s.length&&t.length&&(h.value=!0)}),xt(()=>{const t=!!(!e.hideNoData||N.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),s=r.value.length>0,C=Le.filterProps(e);return c(Le,U({ref:m},C,{modelValue:y.value,"onUpdate:modelValue":[i=>y.value=i,Ie],focused:p.value,"onUpdate:focused":i=>p.value=i,validationValue:r.externalValue,counterValue:pe.value,dirty:s,onChange:Ve,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":h.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!O.value,"v-autocomplete--selecting-index":l.value>-1},e.class],style:e.style,readonly:K.isReadonly.value,placeholder:s?void 0:e.placeholder,"onClick:clear":se,"onMousedown:control":he,onKeydown:ke}),{...n,default:()=>H(ae,null,[c(et,U({ref:L,modelValue:h.value,"onUpdate:modelValue":i=>h.value=i,activator:"parent",contentClass:"v-autocomplete__content",disabled:G.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Se,onAfterLeave:De},e.menuProps),{default:()=>[t&&c(Pe,U({ref:q,filterable:!0,selected:ye.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:i=>i.preventDefault(),onKeydown:Ce,onFocusin:xe,onFocusout:Te,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},ue,e.listProps),{default:()=>[n["prepend-item"]?.(),!N.value.length&&!e.hideNoData&&(n["no-data"]?.()??c(A,{key:"no-data",title:F(e.noDataText)},null)),c(tt,{ref:S,renderless:!0,items:N.value,itemKey:"value"},{default:i=>{let{item:u,index:D,itemRef:ie}=i;const Y=U(u.props,{ref:ie,key:u.value,active:Z.value&&D===0?!0:void 0,onClick:()=>v(u,null)});return u.type==="divider"?n.divider?.({props:u.raw,index:D})??c($e,U(u.props,{key:`divider-${D}`}),null):u.type==="subheader"?n.subheader?.({props:u.raw,index:D})??c(lt,U(u.props,{key:`subheader-${D}`}),null):n.item?.({item:u,index:D,props:Y})??c(A,U(Y,{role:"option"}),{prepend:ee=>{let{isSelected:I}=ee;return H(ae,null,[e.multiple&&!e.hideSelected?c(nt,{key:u.value,modelValue:I,ripple:!1,tabindex:"-1"},null):void 0,u.props.prependAvatar&&c(ut,{image:u.props.prependAvatar},null),u.props.prependIcon&&c(me,{icon:u.props.prependIcon},null)])},title:()=>g.value?u.title:at("v-autocomplete",u.title,ge(u)?.title)})}}),n["append-item"]?.()]})]}),r.value.map((i,u)=>{function D(I){I.stopPropagation(),I.preventDefault(),v(i,!1)}const ie={"onClick:close":D,onKeydown(I){I.key!=="Enter"&&I.key!==" "||(I.preventDefault(),I.stopPropagation(),D(I))},onMousedown(I){I.preventDefault(),I.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},Y=B.value?!!n.chip:!!n.selection,ee=Y?It(B.value?n.chip({item:i,index:u,props:ie}):n.selection({item:i,index:u})):void 0;if(!(Y&&!ee))return H("div",{key:i.value,class:We(["v-autocomplete__selection",u===l.value&&["v-autocomplete__selection--selected",_.value]]),style:Ge(u===l.value?P.value:{})},[B.value?n.chip?c(it,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:i.title}}},{default:()=>[ee]}):c(st,U({key:"chip",closable:e.closableChips,size:"small",text:i.title,disabled:i.props.disabled},ie),null):ee??H("span",{class:"v-autocomplete__selection-text"},[i.title,e.multiple&&u<r.value.length-1&&H("span",{class:"v-autocomplete__selection-comma"},[Ne(",")])])])})]),"append-inner":function(){for(var i=arguments.length,u=new Array(i),D=0;D<i;D++)u[D]=arguments[D];return H(ae,null,[n["append-inner"]?.(...u),e.menuIcon?c(me,{class:"v-autocomplete__menu-icon",color:m.value?.fieldIconColor,icon:e.menuIcon,onMousedown:be,onClick:Tt,"aria-label":F(ne.value),title:F(ne.value),tabindex:"-1"},null):void 0])}})}),ot({isFocused:p,isPristine:g,menu:h,search:y,filteredItems:Q,select:v},m)}}),wt={key:0,class:"text-accent"},$t={key:1,class:"text-accent"},_e=we({__name:"FilterSelectMulti",props:fe({title:{},items:{},filterType:{}},{include:{required:!0},includeModifiers:{},exclude:{required:!0},excludeModifiers:{}}),emits:fe(["disable","toggleFilterType"],["update:include","update:exclude"]),setup(e){const d=Ee(e,"include"),n=Ee(e,"exclude"),{t:F}=Ue(),m=k(()=>d.value.length+n.value.length);function p(l){return d.value.includes(l)?w.INCLUDED:n.value.includes(l)?w.EXCLUDED:w.DISABLED}function g(l){switch(p(l)){case w.INCLUDED:return"mdi-plus-box";case w.EXCLUDED:return"mdi-minus-box";case w.DISABLED:default:return"mdi-checkbox-blank-outline"}}function V(l){switch(p(l)){case w.INCLUDED:return"text-green";case w.EXCLUDED:return"text-red";default:return}}function L(l){switch(p(l)){case w.INCLUDED:ve(d.value,l),n.value.push(l);break;case w.EXCLUDED:ve(n.value,l);break;case w.DISABLED:default:d.value.push(l)}}function S(l){ve(d.value,l),ve(n.value,l)}return(l,E)=>(T(),R(A,{class:"px-0 pb-3"},{default:x(()=>[c(Ke,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:x(()=>[Ne(X(e.title),1)]),_:1}),c(Be,{"model-value":[...d.value,...n.value],items:e.items,placeholder:o(F)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{prepend:x(()=>[c(ft,{location:"right",text:o(F)(e.filterType===o(z).CONJUNCTIVE?"constants.filter_type.conjunctive":"constants.filter_type.disjunctive")},{activator:x(({props:b})=>[c(me,U(b,{icon:e.filterType===o(z).CONJUNCTIVE?"mdi-set-center":"mdi-set-all",onClick:E[0]||(E[0]=$=>l.$emit("toggleFilterType"))}),null,16,["icon"])]),_:1},8,["text"])]),"prepend-item":x(()=>[c(A,{title:o(F)("common.disable"),onClick:E[1]||(E[1]=b=>l.$emit("disable"))},null,8,["title"]),c($e)]),selection:x(({item:b,index:$})=>[$===0&&m.value===1?(T(),j("span",wt,X(b.title),1)):$===0?(T(),j("span",$t,X(o(F)("navbar.side.filters.activeFilter",m.value)),1)):M("",!0)]),item:x(({item:b,props:$})=>[qe((T(),R(A,U($,{"data-custom-context-menu":"",class:V(b.value),onClick:_=>L(b.value),onContextmenu:_=>S(b.value)}),{prepend:x(()=>[c(me,{icon:g(b.value)},null,8,["icon"])]),_:2},1040,["class","onClick","onContextmenu"])),[[o(ze),()=>S(b.value)]])]),_:1},8,["model-value","items","placeholder"])]),_:1}))}}),Ut={key:0,class:"text-accent"},At={key:1,class:"text-accent"},Me=we({__name:"FilterSelectSingle",props:fe({title:{},items:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:fe(["disable"],["update:modelValue"]),setup(e){const d=e,n=Ee(e,"modelValue"),F=mt(()=>d.items,(p,g)=>de.text.asc(p.title,g.title)),{t:m}=Ue();return(p,g)=>(T(),R(A,{class:"px-0 pb-3"},{default:x(()=>[c(Ke,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:x(()=>[Ne(X(e.title),1)]),_:1}),c(Be,{modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=V=>n.value=V),items:o(F),placeholder:o(m)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{"prepend-item":x(()=>[c(A,{title:o(m)("common.disable"),onClick:g[0]||(g[0]=V=>p.$emit("disable"))},null,8,["title"]),He(p.$slots,"prepend-item"),c($e)]),selection:x(({item:V,index:L})=>[L===0&&n.value.length===1?(T(),j("span",Ut,X(V.title),1)):L===0?(T(),j("span",At,X(o(m)("navbar.side.filters.activeFilter",n.value.length)),1)):M("",!0)]),_:3},8,["modelValue","items","placeholder"])]),_:3}))}}),Mt=we({__name:"Filters",setup(e){const{t:d,getTorrentStateString:n}=Ue(),{categories:F,torrentsByCategory:m}=le(pt()),{tags:p,torrentsByTag:g}=le(gt()),{torrents:V,torrentsByStatus:L,statusFilter:S,categoryFilter:l,tagFilterInclude:E,tagFilterExclude:b,tagFilterType:$,torrentsByTracker:_,trackerFilterInclude:P,trackerFilterExclude:y,trackerFilterType:r}=le(yt()),{hostnameTrackers:pe}=le(ht()),{filters:K,showFilterState:Q,showFilterCategory:ge,showFilterTag:N,showFilterTracker:B}=le(bt()),O=k(()=>Object.values(f).filter(a=>typeof a=="number").map(a=>({title:`${n(a)} (${L.value[a]??0})`,value:a})).sort((a,v)=>de.text.asc(a.title,v.title))),ye=k(()=>[{title:`${d("navbar.side.filters.category.empty")} (${m.value[""]??0})`,value:""},...F.value.map(a=>({title:`${a.name} (${m.value[a.name]??0})`,value:a.name}))]),Z=k(()=>[{title:`${d("navbar.side.filters.tag.empty")} (${g.value[""]??0})`,value:null},...p.value.map(a=>({title:`${a} (${g.value[a]??0})`,value:a})).sort((a,v)=>de.text.asc(a.value,v.value))]),G=k(()=>[{title:`${d("navbar.side.filters.tracker.empty")} (${_.value[ce.UNTRACKED]??0})`,value:ce.UNTRACKED},{title:`${d("navbar.side.filters.tracker.not_working")} (${_.value[ce.NOT_WORKING]??0})`,value:ce.NOT_WORKING},...pe.value.map(a=>({title:`${a} (${_.value[a]??0})`,value:a})).sort((a,v)=>de.text.asc(a.title,v.title))]);function W(a){switch(a.value){case z.CONJUNCTIVE:a.value=z.DISJUNCTIVE;break;case z.DISJUNCTIVE:a.value=z.CONJUNCTIVE;break}}function h(){W($)}function ne(){W(r)}const q=[f.UPLOADING,f.CHECKING_DISK,f.UL_FORCED,f.DOWNLOADING,f.META_DOWNLOAD,f.FORCED_META_DOWNLOAD,f.CHECKING_DISK,f.DL_FORCED,f.CHECKING_RESUME_DATA,f.MOVING],ue=[f.ERROR,f.MISSING_FILES,f.UNKNOWN],se=[f.ERROR,f.MISSING_FILES,f.UNKNOWN,f.MOVING,f.DL_STOPPED,f.DL_STALLED,f.UL_STOPPED,f.CHECKING_DISK,f.CHECKING_RESUME_DATA];function he(){S.value=[]}const be=k(()=>V.value.filter(a=>q.includes(a.state)).length);function Ce(){S.value=q}const ke=k(()=>V.value.filter(a=>ue.includes(a.state)).length);function Ve(){S.value=ue}const Se=k(()=>V.value.filter(a=>se.includes(a.state)).length);function De(){S.value=se}function xe(){l.value=[]}function Te(){E.value=[],b.value=[]}function Ie(){P.value=[],y.value=[]}return(a,v)=>o(Q)||o(ge)||o(N)||o(B)?(T(),R(Pe,{key:0,class:"pb-0 inherit-fg"},{default:x(()=>[(T(!0),j(ae,null,Je(o(K),t=>(T(),j(ae,{key:t.name},[t.name==="state"&&t.active?(T(),R(Me,{key:0,modelValue:o(S),"onUpdate:modelValue":v[0]||(v[0]=s=>J(S)?S.value=s:null),title:o(d)("navbar.side.filters.state.title"),items:O.value,onDisable:he},{"prepend-item":x(()=>[c(A,{title:`${o(d)("navbar.side.filters.state.active")} (${be.value})`,onClick:Ce},null,8,["title"]),c(A,{title:`${o(d)("navbar.side.filters.state.error")} (${ke.value})`,onClick:Ve},null,8,["title"]),c(A,{title:`${o(d)("navbar.side.filters.state.offline")} (${Se.value})`,onClick:De},null,8,["title"])]),_:1},8,["modelValue","title","items"])):M("",!0),t.name==="category"&&t.active?(T(),R(Me,{key:1,modelValue:o(l),"onUpdate:modelValue":v[1]||(v[1]=s=>J(l)?l.value=s:null),title:o(d)("navbar.side.filters.category.title"),items:ye.value,onDisable:xe},null,8,["modelValue","title","items"])):M("",!0),t.name==="tag"&&t.active?(T(),R(_e,{key:2,include:o(E),"onUpdate:include":v[2]||(v[2]=s=>J(E)?E.value=s:null),exclude:o(b),"onUpdate:exclude":v[3]||(v[3]=s=>J(b)?b.value=s:null),title:o(d)("navbar.side.filters.tag.title"),items:Z.value,"filter-type":o($),onDisable:Te,onToggleFilterType:h},null,8,["include","exclude","title","items","filter-type"])):M("",!0),t.name==="tracker"&&t.active?(T(),R(_e,{key:3,include:o(P),"onUpdate:include":v[4]||(v[4]=s=>J(P)?P.value=s:null),exclude:o(y),"onUpdate:exclude":v[5]||(v[5]=s=>J(y)?y.value=s:null),title:o(d)("navbar.side.filters.tracker.title"),items:G.value,"filter-type":o(r),onDisable:Ie,onToggleFilterType:ne},null,8,["include","exclude","title","items","filter-type"])):M("",!0)],64))),128))]),_:1})):M("",!0)}});export{Mt as default};
