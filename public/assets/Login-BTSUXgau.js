import{f as v,Y as b,a0 as C,r as q,b as h,H as x,w as S,J as k,K,M as o,n as e,S as c,Q as p,u,U as f,T as _,a1 as y}from"./vue-xUNsYc5W.js";import{_ as A}from"./PasswordField.vue_vue_type_script_setup_true_lang-BN64C8Mq.js";import{o as T,$ as U,r as $,s as B,a0 as F,v as M,V as E,a as I,y as N,A as O}from"./index-BxmFWlei.js";import{V as R}from"./VForm-BhyYzBhE.js";import{V as D}from"./VContainer-K5QbQfY6.js";import"./vuetify-BvNoaQql.js";const G=v({__name:"Login",setup(H){const{t:a}=T(),w=b(),t=C(),i=U(),n=q({username:"",password:""}),m=h(!1),V={username:[r=>!!r||a("login.rules.username_required")],password:[r=>!!r||a("login.rules.password_required")]};async function d(){if(!m.value)return;const r=await i.login(n.username,n.password);if(i.isAuthenticated)y.success(a("login.success")),g();else{let s=a("login.error");r.status!==200&&(s+=`
Error code: ${r.status} (${r.data})`),y.error(s)}}function g(){t.query.redirect?w.push(t.query.redirect):w.push({name:"dashboard"})}return x(async()=>{t.query.username&&t.query.password&&await i.login(t.query.username,t.query.password)}),S(()=>{i.isAuthenticated&&g()}),(r,s)=>(K(),k(D,{class:"fill-height"},{default:o(()=>[e($,{class:"mx-auto",rounded:"lg","min-width":"250"},{default:o(()=>[e(B,null,{default:o(()=>[c(p(u(a)("login.title")),1)]),_:1}),e(F,null,{default:o(()=>[c(p(u(a)("login.subtitle")),1)]),_:1}),e(M,null,{default:o(()=>[e(R,{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=l=>m.value=l),onSubmit:f(d,["prevent"])},{default:o(()=>[e(E,{id:"username",modelValue:n.username,"onUpdate:modelValue":s[0]||(s[0]=l=>n.username=l),name:"username",autocomplete:"username","aria-autocomplete":"username",label:u(a)("login.username"),autofocus:"",rules:V.username,variant:"outlined",onKeydown:_(f(d,["prevent"]),["enter"])},{prepend:o(()=>[e(I,{color:"accent",icon:"mdi-account"})]),_:1},8,["modelValue","label","rules","onKeydown"]),e(A,{id:"password",modelValue:n.password,"onUpdate:modelValue":s[1]||(s[1]=l=>n.password=l),autocomplete:"current-password","aria-autocomplete":"current-password",label:u(a)("login.password"),rules:V.password,"prepend-icon":"mdi-lock",variant:"outlined",onKeydown:_(f(d,["prevent"]),["enter"])},null,8,["modelValue","label","rules","onKeydown"])]),_:1},8,["modelValue"])]),_:1}),e(N,null,{default:o(()=>[e(O,{variant:"elevated",block:"",color:"accent",onClick:d},{default:o(()=>[c(p(u(a)("login.submit")),1)]),_:1})]),_:1})]),_:1})]),_:1}))}});export{G as default};
