import{p as We}from"./purify.es-CGs5VtEq.js";import{n as e,v as U,b as L,t as ke,D as Ye,y as D,N as he,q as x,F as M,f as N,a8 as Je,u as F,J as h,K as m,M as t,W as _,V as T,S,Q as A,U as q,a0 as Ue,e as P,X as ae,$ as ee,Y as Te,r as fe,R as ve,T as Fe,H as Ne,_ as pe,a6 as Re}from"./vue-DNsif0qT.js";import{B as J,bq as Xe,bn as Ze,br as xe,bs as Ae,bt as Ce,f as et,bu as tt,bv as lt,W as at,bw as nt,a as me,bo as st,bx as Ee,by as H,H as K,b4 as ge,aq as ot,bz as it,z as Q,A as R,Y as rt,e as ut,bA as dt,Q as Ve,K as W,aA as mt,az as I,bB as ct,o as te,q as Le,r as Y,s as ne,v as se,V as z,y as ye,Z as oe,bC as ft,aH as le,G as X,F as O,aF as be,aG as Me,bD as vt,bE as pt,a$ as we,aB as gt}from"./index-1r4wT7cG.js";import{v as Vt}from"./index-CKfUFoas.js";import{V as De}from"./VPagination-D3S1jHyu.js";import{V as Pe}from"./VForm-Dxt2IIbr.js";import{V as Ie}from"./VEmptyState-Bs2XaMCG.js";import{g as Oe,p as Be,h as ce,a as ze,r as yt,N as bt,d as $t}from"./vuetify-RZUogo8k.js";import{V as kt}from"./VSheet-i1zqmzeI.js";var E=(l=>(l[l.LOADING=0]="LOADING",l[l.ERROR=1]="ERROR",l[l.UNREAD=2]="UNREAD",l[l.READ=3]="READ",l))(E||{});const ht=Be({inset:Boolean,...Xe({transition:"bottom-sheet-transition"})},"VBottomSheet"),Ft=Oe()({name:"VBottomSheet",props:ht(),emits:{"update:modelValue":l=>!0},setup(l,p){let{slots:u}=p;const a=ce(l,"modelValue");return ze(()=>{const n=J.filterProps(l);return e(J,U(n,{contentClass:["v-bottom-sheet__content",l.contentClass],modelValue:a.value,"onUpdate:modelValue":c=>a.value=c,class:["v-bottom-sheet",{"v-bottom-sheet--inset":l.inset},l.class],style:l.style}),u)}),{}}}),Rt=Be({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...lt(),...tt()},"VSwitch"),At=Oe()({name:"VSwitch",inheritAttrs:!1,props:Rt(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:indeterminate":l=>!0},setup(l,p){let{attrs:u,slots:a}=p;const n=ce(l,"indeterminate"),c=ce(l,"modelValue"),{loaderClasses:o}=Ze(l),{isFocused:f,focus:y,blur:d}=xe(l),C=L(),b=L(),r=yt&&window.matchMedia("(forced-colors: active)").matches,s=ke(()=>typeof l.loading=="string"&&l.loading!==""?l.loading:l.color),i=Ye(),v=ke(()=>l.id||`switch-${i}`);function g(){n.value&&(n.value=!1)}function w(j){j.stopPropagation(),j.preventDefault(),C.value?.input?.click()}return ze(()=>{const[j,$]=bt(u),k=Ae.filterProps(l),V=Ce.filterProps(l);return e(Ae,U({ref:b,class:["v-switch",{"v-switch--flat":l.flat},{"v-switch--inset":l.inset},{"v-switch--indeterminate":n.value},o.value,l.class]},j,k,{modelValue:c.value,"onUpdate:modelValue":B=>c.value=B,id:v.value,focused:f.value,style:l.style}),{...a,default:B=>{let{id:ie,messagesId:He,isDisabled:je,isReadonly:Ge,isValid:$e}=B;const re={model:c,isValid:$e};return e(Ce,U({ref:C},V,{modelValue:c.value,"onUpdate:modelValue":[Z=>c.value=Z,g],id:ie.value,"aria-describedby":He.value,type:"checkbox","aria-checked":n.value?"mixed":void 0,disabled:je.value,readonly:Ge.value,onFocus:y,onBlur:d},$),{...a,default:Z=>{let{backgroundColorClasses:ue,backgroundColorStyles:G}=Z;return D("div",{class:x(["v-switch__track",r?void 0:ue.value]),style:he(G.value),onClick:w},[a["track-true"]&&D("div",{key:"prepend",class:"v-switch__track-true"},[a["track-true"](re)]),a["track-false"]&&D("div",{key:"append",class:"v-switch__track-false"},[a["track-false"](re)])])},input:Z=>{let{inputNode:ue,icon:G,backgroundColorClasses:Ke,backgroundColorStyles:Qe}=Z;return D(M,null,[ue,D("div",{class:x(["v-switch__thumb",{"v-switch__thumb--filled":G||l.loading},l.inset||r?void 0:Ke.value]),style:he(l.inset?void 0:Qe.value)},[a.thumb?e(at,{defaults:{VIcon:{icon:G,size:"x-small"}}},{default:()=>[a.thumb({...re,icon:G})]}):e(nt,null,{default:()=>[l.loading?e(st,{name:"v-switch",active:!0,color:$e.value===!1?void 0:s.value},{default:de=>a.loader?a.loader(de):e(Ee,{active:de.isActive,color:de.color,indeterminate:!0,size:"16",width:"2"},null)}):G&&e(me,{key:String(G),icon:G,size:"x-small"},null)]})])])}})}})}),et({},b)}}),Ct={class:"d-flex"},wt={key:0},Dt={key:0},St={key:1},_t={class:"d-flex flex-column"},Ut=N({__name:"Article",props:{value:{}},emits:["click","markAsRead","open","download"],setup(l){const p=H();return(u,a)=>Je((m(),h(K,{"data-custom-context-menu":"",class:x({"rss-read":u.value.isRead}),onClick:a[3]||(a[3]=n=>u.$emit("click")),onContextmenu:a[4]||(a[4]=n=>u.$emit("markAsRead"))},{default:t(()=>[D("div",Ct,[D("div",null,[e(ge,{class:"d-flex align-center ga-3 wrap-anywhere",style:{"white-space":"unset"}},{default:t(()=>[u.value.isRead?T("",!0):(m(),_("div",wt,[e(ot,{color:"accent",variant:"outlined"},{default:t(()=>[S(A(u.$t("rssArticles.feeds.item.new")),1)]),_:1})])),D("div",null,A(u.value.title),1)]),_:1}),e(it,{class:"d-block mt-3"},{default:t(()=>[D("div",null,A(u.value.parsedDate.toLocaleString()),1),D("div",null,A(u.$t("rssArticles.feeds.item.feedName",{name:F(p).getFeedNames(u.value.id).join(" | ")})),1),u.value.author?(m(),_("div",Dt,A(u.$t("rssArticles.feeds.item.author",{author:u.value.author})),1)):T("",!0),u.value.category?(m(),_("div",St,A(u.$t("rssArticles.feeds.item.category",{category:u.value.category})),1)):T("",!0)]),_:1})]),e(Q),D("div",_t,[e(R,{icon:"mdi-open-in-new",variant:"text",onClick:a[0]||(a[0]=q(n=>u.$emit("open"),["stop"]))}),e(R,{color:"accent",icon:"mdi-check",variant:"text",onClick:a[1]||(a[1]=q(n=>u.$emit("markAsRead"),["stop"]))}),e(R,{icon:"mdi-download",variant:"text",onClick:a[2]||(a[2]=q(n=>u.$emit("download"),["stop"]))})])])]),_:1},8,["class"])),[[F(Vt),()=>u.$emit("markAsRead")]])}}),Se=N({__name:"ArticleList",props:{height:{}},emits:["articleClicked"],setup(l){const p=Ue(),u=rt(),a=H(),n=ut(),c=P(()=>p.params.feedId),o=P(()=>a.filteredArticles.filter(s=>!c.value||c.value===s.feedId).sort((s,i)=>Number(i.parsedDate)-Number(s.parsedDate))),{paginatedResults:f,currentPage:y,pageCount:d}=dt(o,15);function C(s){const i=n.useIdForRssLinks?s.id:s.link;mt(i)}function b(s){u.pushTorrentToQueue(s.torrentURL)}async function r(s){await a.markArticleAsRead(s.id)}return(s,i)=>(m(),h(Ve,{height:s.height},{default:t(()=>[o.value.length?(m(),h(K,{key:0},{default:t(()=>[e(De,{modelValue:F(y),"onUpdate:modelValue":i[0]||(i[0]=v=>ae(y)?y.value=v:null),length:F(d),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])]),_:1})):T("",!0),(m(!0),_(M,null,ee(F(f),(v,g)=>(m(),_(M,{key:g},[g>0?(m(),h(W,{key:0})):T("",!0),e(Ut,{value:v,onClick:w=>s.$emit("articleClicked",v),onMarkAsRead:w=>r(v),onOpen:w=>C(v),onDownload:w=>b(v)},null,8,["value","onClick","onMarkAsRead","onOpen","onDownload"])],64))),128)),o.value.length===0?(m(),h(K,{key:1},{default:t(()=>[S(A(s.$t("common.emptyList")),1)]),_:1})):T("",!0),o.value.length?(m(),h(K,{key:2},{default:t(()=>[e(De,{modelValue:F(y),"onUpdate:modelValue":i[1]||(i[1]=v=>ae(y)?y.value=v:null),length:F(d),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])]),_:1})):T("",!0)]),_:1},8,["height"]))}}),Tt={class:"mr-2"},qe=N({__name:"FeedIcon",props:{state:{}},setup(l){return(p,u)=>(m(),_("span",Tt,[p.state===F(E).LOADING?(m(),h(Ee,{key:0,size:"24",width:"3",indeterminate:""})):p.state===F(E).ERROR?(m(),h(me,{key:1,icon:"mdi-alert-circle-outline",color:"error"})):p.state===F(E).UNREAD?(m(),h(me,{key:2,icon:"mdi-email"})):T("",!0)]))}}),Nt={class:"d-flex align-center"},Et=N({__name:"Feed",props:{title:{},state:{},unreadCount:{}},emits:["readFeed","refreshFeed","editFeed","deleteFeed"],setup(l){const p=l,u=P(()=>p.state===E.LOADING);return(a,n)=>(m(),_("div",Nt,[e(qe,{state:a.state},null,8,["state"]),e(ge,null,{default:t(()=>[S(A(a.title),1)]),_:1}),e(Q),e(I,{text:a.$t("rssArticles.feeds.markAsRead"),location:"top"},{activator:t(({props:c})=>[a.unreadCount>0?(m(),h(R,U({key:0},c,{icon:"mdi-email-open",density:"comfortable",variant:"plain",onClick:n[0]||(n[0]=q(o=>a.$emit("readFeed"),["stop"]))}),null,16)):T("",!0)]),_:1},8,["text"]),e(I,{text:a.$t("common.refresh"),location:"top"},{activator:t(({props:c})=>[u.value?T("",!0):(m(),h(R,U({key:0},c,{icon:"mdi-sync",density:"comfortable",variant:"plain",onClick:n[1]||(n[1]=q(o=>a.$emit("refreshFeed"),["stop"]))}),null,16))]),_:1},8,["text"]),e(I,{text:a.$t("common.edit"),location:"top"},{activator:t(({props:c})=>[e(R,U(c,{icon:"mdi-pencil",density:"comfortable",variant:"plain",onClick:n[2]||(n[2]=q(o=>a.$emit("editFeed"),["stop"]))}),null,16)]),_:1},8,["text"]),e(I,{text:a.$t("common.delete"),location:"top"},{activator:t(({props:c})=>[e(R,U(c,{icon:"mdi-delete",color:"red",density:"comfortable",variant:"plain",onClick:n[3]||(n[3]=q(o=>a.$emit("deleteFeed"),["stop"]))}),null,16)]),_:1},8,["text"])]))}}),Lt={class:"d-flex align-center"},_e=N({__name:"FeedList",props:{height:{}},emits:["update","createFeed","editFeed","deleteFeed","refreshFeed"],setup(l,{emit:p}){const u=p,a=Te(),n=H(),c=P({get:()=>a.currentRoute.value.params.feedId,set(i){a.replace({name:"rssArticles",params:{tab:"feeds",feedId:i}}).then(()=>u("update",i))}}),o=ct(()=>n.filteredArticles.map(i=>i.feedId));function f(i){return i?(i.articles??[]).reduce((v,g)=>v+ +!g.isRead,0):n.unreadArticles.length}function y(i){c.value=c.value!==i.uid?i.uid:void 0}async function d(i){await n.markFeedAsRead(i)}async function C(){await n.refreshAllFeeds(),n.resumeFeedTimer()}function b(i){const v=f(i);return(v?`${v} | `:"")+`${i?i.name:"All"}`}const r=P(()=>n.feeds.reduce((i,v)=>Math.min(i,s(v)),E.READ));function s(i){return i.isLoading?E.LOADING:i.hasError?E.ERROR:i.articles?.some(v=>!v.isRead)?E.UNREAD:E.READ}return(i,v)=>(m(),h(Ve,{height:i.height},{default:t(()=>[e(K,{active:!c.value,color:"accent",variant:"text",onClick:v[3]||(v[3]=g=>c.value=void 0)},{default:t(()=>[D("div",Lt,[e(qe,{state:r.value},null,8,["state"]),e(ge,null,{default:t(()=>[S(A(b()),1)]),_:1}),e(Q),e(I,{text:i.$t("rssArticles.feeds.markAllAsRead"),location:"top"},{activator:t(({props:g})=>[f()>0?(m(),h(R,U({key:0},g,{icon:"mdi-email-open",density:"comfortable",variant:"plain",onClick:v[0]||(v[0]=w=>F(n).markAllAsRead())}),null,16)):T("",!0)]),_:1},8,["text"]),e(I,{text:i.$t("rssArticles.feeds.refreshAllFeeds"),location:"top"},{activator:t(({props:g})=>[r.value!==F(E).LOADING?(m(),h(R,U({key:0},g,{icon:"mdi-sync",density:"comfortable",variant:"plain",onClick:v[1]||(v[1]=w=>C())}),null,16)):T("",!0)]),_:1},8,["text"]),e(I,{text:i.$t("rssArticles.feeds.empty.action"),location:"top"},{activator:t(({props:g})=>[e(R,U(g,{icon:"mdi-plus",density:"comfortable",variant:"plain",onClick:v[2]||(v[2]=w=>i.$emit("createFeed"))}),null,16)]),_:1},8,["text"])])]),_:1},8,["active"]),e(W,{thickness:"3"}),(m(!0),_(M,null,ee(F(n).feeds,g=>(m(),_(M,null,[(!F(n).filters.unread||f(g)>0)&&(F(n).filters.title==""||!F(o).length||F(o).includes(g.uid))?(m(),h(K,{key:g.uid,active:c.value===g.uid,class:x(f(g)>0?"text-accent":""),color:"accent",variant:"text",onClick:w=>y(g)},{default:t(()=>[e(Et,{title:b(g),state:s(g),"unread-count":f(g),onReadFeed:w=>d(g),onRefreshFeed:w=>i.$emit("refreshFeed",g),onEditFeed:w=>i.$emit("editFeed",g),onDeleteFeed:w=>i.$emit("deleteFeed",g)},null,8,["title","state","unread-count","onReadFeed","onRefreshFeed","onEditFeed","onDeleteFeed"])]),_:2},1032,["active","class","onClick"])):T("",!0)],64))),256))]),_:1},8,["height"]))}}),Mt=N({__name:"RssFeedDialog",props:{guid:{},initialFeed:{}},setup(l){const p=l,{t:u}=te(),{isOpened:a}=Le(p.guid),n=H(),c=L(),o=L(!1),f=fe({name:"",url:""}),y=[r=>!!r||u("dialogs.rss.feed.rules.name_required")],d=[r=>!!r||u("dialogs.rss.feed.rules.url_required")];async function C(){await c.value?.validate(),o.value&&(p.initialFeed?(f.url!==p.initialFeed.url&&await n.setFeedUrl(p.initialFeed.name,f.url),f.name!==p.initialFeed.name&&await n.renameFeed(p.initialFeed.name,f.name)):await n.createFeed(f.name,f.url),await n.fetchFeeds(),b())}function b(){a.value=!1}return ve(()=>{p.initialFeed&&(f.name=p.initialFeed.name,f.url=p.initialFeed.url)}),(r,s)=>(m(),h(J,{modelValue:F(a),"onUpdate:modelValue":s[4]||(s[4]=i=>ae(a)?a.value=i:null)},{default:t(()=>[e(Y,null,{default:t(()=>[e(ne,null,{default:t(()=>[S(A(r.$t(`dialogs.rss.feed.title.${r.initialFeed?"edit":"create"}`)),1)]),_:1}),e(se,null,{default:t(()=>[e(F(Pe),{ref_key:"form",ref:c,modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=i=>o.value=i),onSubmit:s[3]||(s[3]=q(()=>{},["prevent"]))},{default:t(()=>[e(z,{modelValue:f.name,"onUpdate:modelValue":s[0]||(s[0]=i=>f.name=i),rules:y,label:r.$t("dialogs.rss.feed.name"),onKeydown:Fe(C,["enter"])},null,8,["modelValue","label"]),e(z,{modelValue:f.url,"onUpdate:modelValue":s[1]||(s[1]=i=>f.url=i),rules:d,label:r.$t("dialogs.rss.feed.url"),onKeydown:Fe(C,["enter"])},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(ye,null,{default:t(()=>[e(Q),e(R,{color:"error",onClick:b},{default:t(()=>[S(A(r.$t("common.cancel")),1)]),_:1}),e(R,{color:"accent",disabled:!o.value,onClick:C},{default:t(()=>[S(A(r.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Pt=N({__name:"Feeds",props:{height:{},mobile:{type:Boolean}},emits:["openArticle"],setup(l){const p=l,{t:u}=te(),a=oe(),n=H(),c=L(!1),o=P(()=>p.height-56-16-56-12*2),f=P({get:()=>n.filters.title,set:ft(b=>{n.filters.title=b??""},300)});function y(b){a.createDialog(Mt,{initialFeed:b},n.resumeFeedTimer)}async function d(b){await n.refreshFeed(b.name),n.resumeFeedTimer()}function C(b){a.confirmAction({title:u("dialogs.confirm.deleteFeed"),text:b.name,yesColor:"error",onConfirm:async()=>{await n.deleteFeed(b.name),n.resumeFeedTimer()}})}return Ne(()=>{n.resumeFeedTimer()}),pe(()=>{n.pauseFeedTimer()}),(b,r)=>F(n).feeds.length?(m(),h(Y,{key:1,id:"rss-articles",class:"pa-3",height:b.height},{default:t(()=>[e(z,{modelValue:f.value,"onUpdate:modelValue":r[1]||(r[1]=s=>f.value=s),label:b.$t("rssArticles.feeds.filters.title"),clearable:"","hide-details":""},null,8,["modelValue","label"]),e(le,{modelValue:F(n).filters.unread,"onUpdate:modelValue":r[2]||(r[2]=s=>F(n).filters.unread=s),label:b.$t("rssArticles.feeds.filters.unread"),"hide-details":""},null,8,["modelValue","label"]),b.mobile?(m(),_(M,{key:0},[e(Se,{height:o.value,onArticleClicked:r[3]||(r[3]=s=>b.$emit("openArticle",s))},null,8,["height"]),e(Ft,{modelValue:c.value,"onUpdate:modelValue":r[9]||(r[9]=s=>c.value=s),"max-height":"550"},{activator:t(({props:s})=>[e(R,U({class:"fab"},s,{color:"accent",icon:"mdi-format-list-bulleted",size:"large"}),null,16)]),default:t(()=>[e(_e,{onUpdate:r[4]||(r[4]=s=>c.value=!1),onCreateFeed:r[5]||(r[5]=()=>y()),onEditFeed:r[6]||(r[6]=s=>y(s)),onDeleteFeed:r[7]||(r[7]=s=>C(s)),onRefreshFeed:r[8]||(r[8]=s=>d(s))})]),_:1},8,["modelValue"])],64)):(m(),h(X,{key:1},{default:t(()=>[e(O,{cols:"4"},{default:t(()=>[e(_e,{height:o.value,onCreateFeed:r[10]||(r[10]=()=>y()),onEditFeed:r[11]||(r[11]=s=>y(s)),onDeleteFeed:r[12]||(r[12]=s=>C(s)),onRefreshFeed:r[13]||(r[13]=s=>d(s))},null,8,["height"])]),_:1}),e(O,{cols:"8"},{default:t(()=>[e(Se,{height:o.value,onArticleClicked:r[14]||(r[14]=s=>b.$emit("openArticle",s))},null,8,["height"])]),_:1})]),_:1}))]),_:1},8,["height"])):(m(),h(Y,{key:0,height:b.height},{default:t(()=>[e(Ie,{title:b.$t("rssArticles.feeds.empty.value"),icon:"mdi-rss-off"},{actions:t(()=>[e(R,{text:b.$t("rssArticles.feeds.empty.action"),color:"accent",onClick:r[0]||(r[0]=s=>y())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))}}),It={class:"pl-4"},Ot=N({__name:"Rule",props:{value:{}},emits:["openRule"],setup(l){const{t:p}=te(),u=oe(),a=H();async function n(o){await a.setRule(o.name,{...o,enabled:!o.enabled}),a.resumeRuleTimer()}function c(o){u.confirmAction({title:p("dialogs.confirm.deleteRule"),text:o.name,yesColor:"error",onConfirm:async()=>{await a.deleteRule(o.name),a.resumeRuleTimer()}})}return(o,f)=>(m(),h(kt,{rounded:"xl",class:"d-flex align-center"},{default:t(()=>[D("div",It,A(o.value.name),1),e(Q),D("div",null,[e(R,{class:"my-2 mr-2",icon:o.value.enabled?"mdi-check":"mdi-cancel",color:o.value.enabled?"accent":"red",variant:"plain",density:"compact",onClick:f[0]||(f[0]=y=>n(o.value))},null,8,["icon","color"]),e(I,{text:o.$t("common.edit"),location:"top"},{activator:t(({props:y})=>[e(R,U(y,{class:"my-2 mr-2",icon:"mdi-pencil",variant:"plain",density:"compact",onClick:f[1]||(f[1]=d=>o.$emit("openRule",o.value))}),null,16)]),_:1},8,["text"]),e(I,{text:o.$t("common.delete"),location:"top"},{activator:t(({props:y})=>[e(R,U(y,{class:"my-2 mr-2",icon:"mdi-delete",color:"red",variant:"plain",density:"compact",onClick:f[2]||(f[2]=d=>c(o.value))}),null,16)]),_:1},8,["text"])])]),_:1}))}}),Bt=N({__name:"AddTorrentParamsDialog",props:{modelValue:{required:!0},modelModifiers:{},isOpened:{type:Boolean},isOpenedModifiers:{}},emits:["update:modelValue","update:isOpened"],setup(l){const p=Re(l,"modelValue"),u=Re(l,"isOpened"),{t:a}=te(),n=L();function c(){n.value?.saveFields(),u.value=!1}return(o,f)=>(m(),h(J,{modelValue:u.value,"onUpdate:modelValue":f[1]||(f[1]=y=>u.value=y),class:x(o.$vuetify.display.mobile?"":"w-75"),fullscreen:o.$vuetify.display.mobile,scrollable:""},{default:t(()=>[e(Y,null,{default:t(()=>[e(ne,{class:"ios-margin"},{default:t(()=>[e(be,{color:"transparent"},{default:t(()=>[e(Me,null,{default:t(()=>[S(A(F(a)("dialogs.add.params.title")),1)]),_:1}),e(R,{icon:"mdi-close",onClick:c})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(vt,{modelValue:p.value,"onUpdate:modelValue":f[0]||(f[0]=y=>p.value=y)},null,8,["modelValue"])]),_:1}),e(ye,{class:"mb-2"},{default:t(()=>[e(Q),e(R,{text:o.$t("common.close"),color:"",variant:"flat",onClick:c},null,8,["text"])]),_:1})]),_:1})]),_:1},8,["modelValue","class","fullscreen"]))}});function zt(l){return{save_path:l?.save_path??"",skip_checking:!1,add_to_top_of_queue:l?.add_to_top_of_queue??!1,content_layout:l?.torrent_content_layout,stop_condition:l?.torrent_stop_condition,download_limit:l?.dl_limit,upload_limit:l?.up_limit,use_download_path:!!l?.temp_path,download_path:l?.temp_path?l?.temp_path:"",stopped:l?.add_stopped_enabled??l?.start_paused_enabled,use_auto_tmm:l?.auto_tmm_enabled,ratio_limit:-2,seeding_time_limit:-2,inactive_seeding_time_limit:-2}}const qt={class:"d-flex"},Ht={class:"d-flex align-center"},jt={class:"v-card-title pa-0"},Gt=N({__name:"RssRuleDialog",props:{guid:{},initialRule:{}},setup(l){const p=l,u=P(()=>!!(p.initialRule&&p.initialRule.name)),{isOpened:a}=Le(p.guid),{t:n}=te(),c=pt(),o=H(),f=L(),y=L(!1),d=fe(s()),C=L(""),b=L([]),r=P(()=>{if(d.lastMatch==="")return n("dialogs.rss.rule.lastMatch.unknownValue").toString();const $=new Date().getTime()-new Date(d.lastMatch).getTime();return n("dialogs.rss.rule.lastMatch.knownValue",Math.floor($/(1e3*60*60*24)))});function s(){return{affectedFeeds:[],enabled:!0,episodeFilter:"",ignoreDays:0,lastMatch:"",mustContain:"",mustNotContain:"",name:"",priority:0,smartFilter:!1,useRegex:!1,previouslyMatchedEpisodes:u.value?p.initialRule.previouslyMatchedEpisodes:[],torrentParams:zt(c.preferences)}}async function i(){if(C.value==="")return;const $=[],k=await o.fetchMatchingArticles(C.value);for(const V in k){const B=k[V];$.length>0&&$.push({type:"divider"}),$.push({type:"subheader",value:V}),B.forEach(ie=>$.push({type:"item",value:ie}))}b.value=$}async function v(){y.value&&((u.value||C.value!=="")&&C.value!==d.name&&await o.renameRule(C.value,d.name),await o.setRule(d.name,d),C.value=d.name,await o.fetchRules(),await i())}function g(){d.affectedFeeds=[]}function w(){d.affectedFeeds=o.feeds.map($=>$.url)}function j(){a.value=!1}return ve(async()=>{await o.fetchFeeds(),u.value&&(C.value=p.initialRule.name,Object.assign(d,p.initialRule)),await i()}),($,k)=>(m(),h(J,{modelValue:F(a),"onUpdate:modelValue":k[13]||(k[13]=V=>ae(a)?a.value=V:null)},{default:t(()=>[e(Y,null,{default:t(()=>[e(ne,null,{default:t(()=>[e(be,{color:"transparent",title:$.$t(`dialogs.rss.rule.title.${$.initialRule?"edit":"create"}`)},{default:t(()=>[e(R,{icon:"mdi-close",onClick:j})]),_:1},8,["title"])]),_:1}),e(se,null,{default:t(()=>[e(F(Pe),{ref_key:"form",ref:f,modelValue:y.value,"onUpdate:modelValue":k[11]||(k[11]=V=>y.value=V),onSubmit:k[12]||(k[12]=q(()=>{},["prevent"]))},{default:t(()=>[e(X,null,{default:t(()=>[e(O,{cols:"12",sm:"6",class:"scrollable-col"},{default:t(()=>[e(z,{modelValue:d.name,"onUpdate:modelValue":k[0]||(k[0]=V=>d.name=V),autofocus:"",required:"",label:$.$t("dialogs.rss.rule.name")},null,8,["modelValue","label"]),D("div",qt,[e(At,{modelValue:d.enabled,"onUpdate:modelValue":k[1]||(k[1]=V=>d.enabled=V),color:"accent",inset:"","hide-details":"",label:$.$t("dialogs.rss.rule.enabled")},null,8,["modelValue","label"]),e(Q),D("div",Ht,[e(R,{class:"d-flex align-center justify-center",color:"accent"},{default:t(()=>[S(A($.$t("dialogs.add.params.title"))+" ",1),e(Bt,{modelValue:d.torrentParams,"onUpdate:modelValue":k[2]||(k[2]=V=>d.torrentParams=V),activator:"parent"},null,8,["modelValue"])]),_:1})])]),e(W),e(le,{modelValue:d.useRegex,"onUpdate:modelValue":k[3]||(k[3]=V=>d.useRegex=V),"hide-details":"",label:$.$t("dialogs.rss.rule.useRegex")},null,8,["modelValue","label"]),e(z,{modelValue:d.mustContain,"onUpdate:modelValue":k[4]||(k[4]=V=>d.mustContain=V),label:$.$t("dialogs.rss.rule.mustContain")},null,8,["modelValue","label"]),e(z,{modelValue:d.mustNotContain,"onUpdate:modelValue":k[5]||(k[5]=V=>d.mustNotContain=V),label:$.$t("dialogs.rss.rule.mustNotContain")},null,8,["modelValue","label"]),e(le,{modelValue:d.smartFilter,"onUpdate:modelValue":k[6]||(k[6]=V=>d.smartFilter=V),"hide-details":"",label:$.$t("dialogs.rss.rule.smartFilter")},null,8,["modelValue","label"]),e(z,{modelValue:d.episodeFilter,"onUpdate:modelValue":k[7]||(k[7]=V=>d.episodeFilter=V),placeholder:$.$t("dialogs.rss.rule.episodeFilterPlaceholder"),label:$.$t("dialogs.rss.rule.episodeFilter")},null,8,["modelValue","placeholder","label"]),e(W,{class:"mb-4"}),e(z,{modelValue:d.ignoreDays,"onUpdate:modelValue":k[8]||(k[8]=V=>d.ignoreDays=V),modelModifiers:{number:!0},type:"number",hint:$.$t("dialogs.rss.rule.ignoreDaysHint"),label:$.$t("dialogs.rss.rule.ignoreDays")},null,8,["modelValue","hint","label"]),e(z,{modelValue:r.value,"onUpdate:modelValue":k[9]||(k[9]=V=>r.value=V),disabled:"",label:$.$t("dialogs.rss.rule.lastMatch.label")},null,8,["modelValue","label"]),e(W),e(we,null,{default:t(()=>[S(A($.$t("dialogs.rss.rule.affectedFeedsSubheader")),1)]),_:1}),e(X,null,{default:t(()=>[e(O,{cols:"6",class:"d-flex align-center justify-center"},{default:t(()=>[e(R,{color:"accent",onClick:w},{default:t(()=>[S(A($.$t("common.selectAll")),1)]),_:1})]),_:1}),e(O,{cols:"6",class:"d-flex align-center justify-center"},{default:t(()=>[e(R,{color:"primary",onClick:g},{default:t(()=>[S(A($.$t("common.selectNone")),1)]),_:1})]),_:1})]),_:1}),(m(!0),_(M,null,ee(F(o).feeds,V=>(m(),h(le,{key:V.uid,modelValue:d.affectedFeeds,"onUpdate:modelValue":k[10]||(k[10]=B=>d.affectedFeeds=B),multiple:"","hide-details":"",label:V.name,value:V.url},null,8,["modelValue","label","value"]))),128))]),_:1}),e(W,{vertical:!$.$vuetify.display.mobile},null,8,["vertical"]),e(O,{cols:"12",sm:"6",class:"scrollable-col"},{default:t(()=>[D("div",jt,A($.$t("dialogs.rss.rule.matchingArticles.title")),1),e(Ve,null,{default:t(()=>[(m(!0),_(M,null,ee(b.value,(V,B)=>(m(),_(M,{key:B},[V.type==="divider"?(m(),h(W,{key:0})):V.type==="subheader"?(m(),h(we,{key:1,inset:""},{default:t(()=>[S(A(V.value),1)]),_:2},1024)):(m(),h(K,{key:2,class:"mb-3"},{default:t(()=>[S(A(V.value),1)]),_:2},1024))],64))),128)),b.value.length===0?(m(),h(K,{key:0,title:$.$t("dialogs.rss.rule.matchingArticles.noMatch")},null,8,["title"])):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ye,null,{default:t(()=>[e(Q),e(R,{color:"error",onClick:j},{default:t(()=>[S(A($.$t("common.close")),1)]),_:1}),e(R,{color:"accent",onClick:v},{default:t(()=>[S(A($.$t("common.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Kt=gt(Gt,[["__scopeId","data-v-ea97b7bc"]]),Qt={key:1,id:"rss-rules",class:"pa-3"},Wt=N({__name:"Rules",props:{height:{}},setup(l){const p=oe(),u=H();function a(n){p.createDialog(Kt,{initialRule:n},u.resumeRuleTimer)}return ve(()=>{u.resumeRuleTimer()}),pe(()=>{u.pauseRuleTimer()}),(n,c)=>F(u).rules.length?(m(),_("div",Qt,[e(X,{class:"mt-2"},{default:t(()=>[(m(!0),_(M,null,ee(F(u).rules,o=>(m(),h(O,{key:o.name,cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Ot,{value:o,onOpenRule:a},null,8,["value"])]),_:2},1024))),128))]),_:1}),e(X,null,{default:t(()=>[e(O,{cols:"12",class:"d-flex align-center justify-center"},{default:t(()=>[e(R,{color:"accent",onClick:c[1]||(c[1]=o=>a())},{default:t(()=>[S(A(n.$t("rssArticles.rules.empty.action")),1)]),_:1})]),_:1})]),_:1})])):(m(),h(Y,{key:0,height:n.height},{default:t(()=>[e(Ie,{title:n.$t("rssArticles.rules.empty.value"),icon:"mdi-rss-off"},{actions:t(()=>[e(R,{text:n.$t("rssArticles.rules.empty.action"),color:"accent",onClick:c[0]||(c[0]=o=>a())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))}}),Yt={class:"pa-3"},Jt={class:"subtitle-1 ml-2",style:{"font-size":"1.6em !important"}},Xt={class:"d-flex justify-end"},Zt=["innerHTML"],rl=N({__name:"RssArticles",setup(l){const{height:p,mobile:u}=$t({mobileBreakpoint:"md"}),a=Ue(),n=Te(),c=oe(),o=H(),f=L(!1),y=fe({title:"",content:""}),d=P(()=>a.params.tab!=="rules"),C=P(()=>p.value-64-12*2-48);function b(v){v.description&&(y.title=v.title.trim(),y.content=v.description.trim(),f.value=!0)}function r(){const v=a.params.tab==="rules"?"feeds":"rules";n.replace({name:"rssArticles",params:{tab:v}}).then(()=>o.lastView=v)}function s(){n.push({name:"dashboard"})}function i(v){if(c.hasActiveDialog||f.value)return!1;v.key==="Escape"&&s()}return Ne(()=>{document.addEventListener("keydown",i)}),pe(()=>{document.removeEventListener("keydown",i)}),(v,g)=>(m(),_(M,null,[D("div",Yt,[e(X,{align:"center",justify:"center","no-gutters":""},{default:t(()=>[e(O,null,{default:t(()=>[D("h1",Jt,A(d.value?v.$t("rssArticles.feeds.title"):v.$t("rssArticles.rules.title")),1)]),_:1}),e(O,null,{default:t(()=>[D("div",Xt,[e(I,{text:v.$t(d.value?"rssArticles.toggle.rules":"rssArticles.toggle.feeds"),location:"top"},{activator:t(({props:w})=>[e(R,U(w,{icon:"mdi-auto-download",variant:"plain",onClick:g[0]||(g[0]=j=>r())}),null,16)]),_:1},8,["text"]),e(R,{icon:"mdi-close",variant:"plain",onClick:g[1]||(g[1]=w=>s())})])]),_:1})]),_:1}),d.value?(m(),h(Pt,{key:0,height:C.value,mobile:F(u),onOpenArticle:b},null,8,["height","mobile"])):(m(),h(Wt,{key:1,height:C.value},null,8,["height"]))]),e(J,{modelValue:f.value,"onUpdate:modelValue":g[3]||(g[3]=w=>f.value=w)},{default:t(()=>[e(Y,null,{default:t(()=>[e(ne,null,{default:t(()=>[e(be,{color:"transparent"},{default:t(()=>[e(Me,null,{default:t(()=>[S(A(y.title),1)]),_:1}),e(R,{icon:"mdi-close",onClick:g[2]||(g[2]=w=>f.value=!1)})]),_:1})]),_:1}),e(se,null,{default:t(()=>[D("div",{class:"description-container",innerHTML:F(We).sanitize(y.content)},null,8,Zt)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});export{rl as default};
